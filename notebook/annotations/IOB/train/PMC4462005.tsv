BitMapper	O
:	O
an	O
efficient	O
all	O
-	O
mapper	O
based	O
on	O
bit	O
-	O
vector	O
computing	O

Background	O

As	O
the	O
next	O
-	O
generation	O
sequencing	O
(	O
NGS	O
)	O
technologies	O
producing	O
hundreds	O
of	O
millions	O
of	O
reads	O
every	O
day	O
,	O
a	O
tremendous	O
computational	O
challenge	O
is	O
to	O
map	O
NGS	O
reads	O
to	O
a	O
given	O
reference	O
genome	O
efficiently	O
.	O

However	O
,	O
existing	O
methods	O
of	O
all	O
-	O
mappers	O
,	O
which	O
aim	O
at	O
finding	O
all	O
mapping	O
locations	O
of	O
each	O
read	O
,	O
are	O
very	O
time	O
consuming	O
.	O

The	O
majority	O
of	O
existing	O
all	O
-	O
mappers	O
consist	O
of	O
2	O
main	O
parts	O
,	O
filtration	O
and	O
verification	O
.	O

This	O
work	O
significantly	O
reduces	O
verification	O
time	O
,	O
which	O
is	O
the	O
dominant	O
part	O
of	O
the	O
running	O
time	O
.	O

Results	O

An	O
efficient	O
all	O
-	O
mapper	O
,	O
BitMapper	O
,	O
is	O
developed	O
based	O
on	O
a	O
new	O
vectorized	O
bit	O
-	O
vector	O
algorithm	O
,	O
which	O
simultaneously	O
calculates	O
the	O
edit	O
distance	O
of	O
one	O
read	O
to	O
multiple	O
locations	O
in	O
a	O
given	O
reference	O
genome	O
.	O

Experimental	O
results	O
on	O
both	O
simulated	O
and	O
real	O
data	O
sets	O
show	O
that	O
BitMapper	O
is	O
from	O
several	O
times	O
to	O
an	O
order	O
of	O
magnitude	O
faster	O
than	O
the	O
current	O
state	O
-	O
of	O
-	O
the	O
-	O
art	O
all	O
-	O
mappers	O
,	O
while	O
achieving	O
higher	O
sensitivity	O
,	O
i	O
.	O
e	O
.,	O
better	O
quality	O
solutions	O
.	O

Conclusions	O

We	O
present	O
BitMapper	O
,	O
which	O
is	O
designed	O
to	O
return	O
all	O
mapping	O
locations	O
of	O
raw	O
reads	O
containing	O
indels	O
as	O
well	O
as	O
mismatches	O
.	O

BitMapper	O
is	O
implemented	O
in	O
C	O
under	O
a	O
GPL	O
license	O
.	O

Binaries	O
are	O
freely	O
available	O
at	O
http	O
://	O
home	O
.	O
ustc	O
.	O
edu	O
.	O
cn	O
/%	O
7Echhy	O
.	O

Electronic	O
supplementary	O
material	O

The	O
online	O
version	O
of	O
this	O
article	O
(	O
doi	O
:	O
10	O
.	O
1186	O
/	O
s12859	O
-	O
015	O
-	O
0626	O
-	O
9	O
)	O
contains	O
supplementary	O
material	O
,	O
which	O
is	O
available	O
to	O
authorized	O
users	O
.	O

Background	O

Recently	O
,	O
DNA	O
sequencing	O
has	O
become	O
a	O
powerful	O
tool	O
for	O
researches	O
in	O
biology	O
and	O
medicine	O
.	O

The	O
decreasing	O
cost	O
and	O
improving	O
speed	O
of	O
the	O
next	O
-	O
generation	O
sequencing	O
(	O
NGS	O
)	O
technologies	O
generate	O
massive	O
reads	O
every	O
day	O
.	O

However	O
,	O
a	O
disadvantage	O
of	O
NGS	O
technologies	O
is	O
that	O
they	O
produce	O
sequenced	O
reads	O
of	O
relatively	O
short	O
length	O
.	O

For	O
instance	O
,	O
the	O
HiSeq2500	O
platform	O
of	O
Illumina	O
usually	O
produces	O
150	O
bp	O
reads	O
.	O

The	O
first	O
step	O
of	O
many	O
genomic	O
researches	O
is	O
finding	O
the	O
mapping	O
locations	O
of	O
these	O
short	O
NGS	O
reads	O
in	O
a	O
given	O
large	O
reference	O
genome	O
.	O

For	O
this	O
mapping	O
issue	O
,	O
two	O
classes	O
of	O
methods	O
have	O
been	O
developed	O
.	O

One	O
class	O
,	O
including	O
Bowtie	O
[	O
1	O
],	O
Bowtie2	O
[	O
2	O
],	O
BWA	O
[	O
3	O
],	O
GEM	O
[	O
4	O
],	O
etc	O
.,	O
is	O
referred	O
to	O
as	O
best	O
-	O
mappers	O
for	O
trying	O
to	O
identify	O
one	O
or	O
a	O
few	O
best	O
mapping	O
locations	O
for	O
each	O
read	O
.	O

The	O
other	O
class	O
,	O
including	O
RazerS	O
3	O
[	O
5	O
],	O
Hobbes2	O
[	O
6	O
],	O
and	O
mrFAST	O
[	O
7	O
,	O
8	O
],	O
is	O
referred	O
to	O
as	O
all	O
-	O
mappers	O
for	O
finding	O
all	O
mapping	O
locations	O
.	O

Generally	O
,	O
the	O
selection	O
of	O
different	O
mappers	O
depends	O
on	O
the	O
needs	O
of	O
down	O
-	O
stream	O
applications	O
.	O

Finding	O
one	O
or	O
a	O
few	O
best	O
mapping	O
locations	O
for	O
each	O
read	O
using	O
best	O
-	O
mappers	O
is	O
enough	O
in	O
most	O
cases	O
(	O
e	O
.	O
g	O
.,	O
mapping	O
DNA	O
-	O
protein	O
interactions	O
,	O
whole	O
-	O
transcriptome	O
sequencing	O
and	O
whole	O
genome	O
expression	O
profiling	O
).	O

However	O
,	O
for	O
some	O
specific	O
applications	O
,	O
such	O
as	O
ChIP	O
-	O
seq	O
experiments	O
,	O
CNVs	O
(	O
copy	O
number	O
variation	O
)	O
calling	O
and	O
detecting	O
structural	O
variants	O
,	O
it	O
is	O
necessary	O
to	O
identify	O
all	O
mapping	O
locations	O
using	O
all	O
-	O
mappers	O
.	O

Due	O
to	O
the	O
different	O
purposes	O
,	O
identifying	O
all	O
mapping	O
locations	O
using	O
all	O
-	O
mappers	O
is	O
usually	O
much	O
slower	O
than	O
finding	O
one	O
or	O
a	O
few	O
best	O
locations	O
using	O
best	O
-	O
mappers	O
.	O

An	O
important	O
reason	O
is	O
that	O
all	O
-	O
mappers	O
have	O
to	O
enumerate	O
all	O
possible	O
locations	O
,	O
while	O
best	O
-	O
mappers	O
can	O
use	O
some	O
heuristic	O
methods	O
to	O
select	O
the	O
most	O
likely	O
one	O
.	O

There	O
are	O
a	O
lot	O
of	O
matches	O
for	O
some	O
reads	O
due	O
to	O
huge	O
numbers	O
of	O
segmental	O
duplications	O
and	O
common	O
repeats	O
in	O
reference	O
genomes	O
.	O

Thus	O
,	O
finding	O
all	O
mapping	O
locations	O
is	O
still	O
a	O
computationally	O
very	O
expensive	O
problem	O
.	O

To	O
solve	O
this	O
problem	O
,	O
many	O
all	O
-	O
mappers	O
have	O
been	O
developed	O
.	O

Most	O
of	O
them	O
consist	O
of	O
two	O
parts	O
,	O
filtration	O
and	O
verification	O
.	O

Filtration	O
reduces	O
the	O
number	O
of	O
the	O
locations	O
that	O
need	O
to	O
be	O
verified	O
(	O
called	O
candidates	O
),	O
especially	O
when	O
a	O
reference	O
genome	O
is	O
extremely	O
large	O
.	O

For	O
example	O
,	O
Hobbes	O
[	O
9	O
]	O
uses	O
a	O
dynamic	O
programming	O
algorithm	O
to	O
select	O
several	O
q	O
-	O
grams	O
with	O
the	O
lowest	O
frequency	O
,	O
where	O
q	O
-	O
grams	O
are	O
the	O
subsequences	O
with	O
length	O
of	O
q	O
.	O

Therefore	O
,	O
the	O
number	O
of	O
candidates	O
is	O
minimal	O
.	O

Another	O
filter	O
proposed	O
by	O
Hobbes	O
2	O
chooses	O
k	O
+	O
2	O
q	O
−	O
grams	O
instead	O
of	O
k	O
+	O
1	O
and	O
only	O
verifies	O
the	O
locations	O
that	O
appear	O
at	O
least	O
two	O
times	O
.	O

Recently	O
,	O
Masai	O
[	O
10	O
]	O
improved	O
the	O
performance	O
of	O
filtration	O
by	O
generating	O
candidate	O
locations	O
of	O
multiple	O
reads	O
simultaneously	O
and	O
using	O
approximate	O
seeds	O
.	O

Compared	O
with	O
filtration	O
,	O
verification	O
used	O
for	O
edit	O
distance	O
is	O
the	O
dominant	O
part	O
of	O
the	O
whole	O
running	O
time	O
in	O
current	O
mappers	O
[	O
8	O
].	O

Several	O
algorithms	O
have	O
been	O
proposed	O
to	O
speedup	O
verification	O
.	O

A	O
bit	O
-	O
vector	O
algorithm	O
proposed	O
by	O
Myers	O
[	O
11	O
]	O
uses	O
bit	O
representation	O
contained	O
in	O
a	O
machine	O
word	O
to	O
calculte	O
edit	O
distance	O
.	O

RazerS	O
3	O
[	O
5	O
]	O
implements	O
a	O
banded	O
version	O
of	O
Myers	O
’	O
algorithm	O
[	O
12	O
],	O
which	O
only	O
calculates	O
several	O
consecutive	O
diagonals	O
rather	O
than	O
the	O
whole	O
dynamic	O
programming	O
matrix	O
.	O

Although	O
the	O
current	O
banded	O
method	O
of	O
verification	O
is	O
quite	O
quick	O
,	O
it	O
only	O
calculates	O
the	O
edit	O
distance	O
of	O
a	O
read	O
to	O
one	O
location	O
rather	O
than	O
multiple	O
locations	O
.	O

In	O
this	O
paper	O
,	O
we	O
present	O
BitMapper	O
,	O
an	O
efficient	O
read	O
mapper	O
which	O
is	O
designed	O
to	O
return	O
all	O
mapping	O
locations	O
of	O
raw	O
reads	O
containing	O
indels	O
as	O
well	O
as	O
mismatches	O
.	O

It	O
includes	O
a	O
new	O
vectorized	O
bit	O
-	O
vector	O
algorithm	O
using	O
a	O
single	O
machine	O
word	O
to	O
represent	O
several	O
bit	O
vectors	O
and	O
simultaneously	O
calculates	O
the	O
edit	O
distance	O
of	O
a	O
read	O
to	O
multiple	O
locations	O
in	O
a	O
given	O
reference	O
genome	O
.	O

A	O
vectorized	O
verification	O
scheme	O
is	O
also	O
proposed	O
to	O
work	O
with	O
the	O
new	O
bit	O
-	O
vector	O
algorithm	O
.	O

Experimental	O
results	O
show	O
that	O
the	O
running	O
time	O
of	O
BitMapper	O
is	O
from	O
several	O
times	O
to	O
an	O
order	O
of	O
magnitude	O
faster	O
than	O
the	O
best	O
existing	O
all	O
-	O
mappers	O
,	O
including	O
Hobbes	O
2	O
,	O
RazerS	O
3	O
,	O
mrFAST	O
(	O
with	O
FastHASH	O
)	O
[	O
8	O
],	O
Masai	O
and	O
Yara	O
[	O
13	O
].	O

Methods	O

First	O
,	O
we	O
define	O
the	O
read	O
mapping	O
problem	O
and	O
related	O
concepts	O
.	O

Definition1	O
.	O

Given	O
a	O
set	O
of	O
reads	O
R	O
and	O
a	O
reference	O
genome	O
S	O
,	O
find	O
all	O
locations	O
in	O
S	O
where	O
the	O
hamming	O
or	O
edit	O
distance	O
of	O
each	O
read	O
in	O
R	O
is	O
at	O
most	O
k	O
.	O

Hamming	O
and	O
edit	O
distance	O
are	O
two	O
common	O
distance	O
metrics	O
for	O
sequence	O
alignment	O
.	O

Hamming	O
distance	O
only	O
includes	O
the	O
substitutions	O
of	O
the	O
corresponding	O
symbols	O
between	O
two	O
strings	O
of	O
equal	O
length	O
,	O
while	O
edit	O
distance	O
consists	O
of	O
substitutions	O
,	O
insertions	O
and	O
deletions	O
.	O

Calculating	O
hamming	O
distance	O
is	O
relatively	O
easy	O
and	O
has	O
been	O
well	O
solved	O
.	O

On	O
the	O
other	O
hand	O
,	O
calculating	O
edit	O
distance	O
efficiently	O
is	O
still	O
difficult	O
,	O
which	O
is	O
the	O
focus	O
on	O
this	O
article	O
.	O

Similar	O
to	O
existing	O
short	O
reads	O
mappers	O
,	O
BitMapper	O
mainly	O
consists	O
of	O
two	O
parts	O
:	O
filtration	O
and	O
verification	O
.	O

In	O
the	O
following	O
,	O
we	O
first	O
briefly	O
describe	O
the	O
procedure	O
of	O
existing	O
approaches	O
and	O
then	O
present	O
and	O
analyze	O
BitMapper	O
in	O
detail	O
.	O

Filtration	O

Filtration	O
is	O
an	O
important	O
phase	O
for	O
sequence	O
alignment	O
,	O
especially	O
if	O
a	O
reference	O
genome	O
is	O
extremely	O
large	O
.	O

Only	O
the	O
regions	O
consisting	O
of	O
potential	O
mapping	O
locations	O
can	O
be	O
reserved	O
after	O
filtration	O
.	O

Currently	O
,	O
the	O
basic	O
principle	O
of	O
nearly	O
all	O
q	O
-	O
gram	O
-	O
based	O
filtration	O
strategies	O
is	O
that	O
the	O
number	O
of	O
q	O
-	O
grams	O
shared	O
between	O
two	O
sequences	O
should	O
exceed	O
a	O
certain	O
threshold	O
if	O
they	O
are	O
potentially	O
similar	O
.	O

Next	O
,	O
we	O
briefly	O
summarize	O
commonly	O
usedq	O
-	O
gram	O
-	O
based	O
approaches	O
.	O

Pigeonhole	O
principle	O

A	O
simple	O
and	O
efficient	O
filtration	O
strategy	O
is	O
pigeonhole	O
principle	O
:	O
if	O
l	O
items	O
are	O
put	O
into	O
l	O
+	O
1	O
boxes	O
,	O
then	O
one	O
or	O
more	O
boxes	O
would	O
be	O
empty	O
.	O

In	O
its	O
application	O
on	O
sequence	O
alignment	O
,	O
first	O
each	O
read	O
is	O
divided	O
into	O
k	O
+	O
1	O
non	O
-	O
overlapping	O
q	O
-	O
grams	O
,	O
where	O
k	O
is	O
the	O
threshold	O
of	O
edit	O
distance	O
or	O
hamming	O
distance	O
.	O

If	O
the	O
distance	O
between	O
a	O
read	O
and	O
a	O
candidate	O
region	O
is	O
less	O
than	O
k	O
,	O
at	O
least	O
one	O
in	O
k	O
+	O
1	O
non	O
-	O
overlapping	O
q	O
-	O
grams	O
of	O
the	O
read	O
can	O
be	O
mapped	O
to	O
the	O
reference	O
exactly	O
,	O
since	O
a	O
substitution	O
,	O
insertion	O
or	O
deletion	O
only	O
affects	O
a	O
q	O
-	O
gram	O
.	O

A	O
more	O
general	O
version	O
of	O
pigeonhole	O
principle	O
is	O
that	O
if	O
a	O
read	O
is	O
able	O
to	O
be	O
cut	O
into	O
k	O
+	O
m	O
non	O
-	O
overlapping	O
q	O
-	O
grams	O
,	O
sharing	O
at	O
least	O
m	O
of	O
them	O
with	O
a	O
read	O
is	O
necessary	O
for	O
each	O
mappinglocation	O
.	O

Count	O
filtering	O

Compared	O
with	O
pigeonhole	O
principle	O
,	O
a	O
more	O
involved	O
filtration	O
strategy	O
is	O
count	O
filtering	O
.	O

Given	O
a	O
sequence	O
s	O
,	O
there	O
are	O
|	O
s	O
|−	O
q	O
+	O
1	O
overlapping	O
q	O
-	O
grams	O
that	O
are	O
obtained	O
by	O
sliding	O
a	O
window	O
of	O
length	O
q	O
over	O
s	O
,	O
where	O
|	O
s	O
|	O
is	O
the	O
length	O
of	O
s	O
.	O

As	O
in	O
the	O
explanation	O
of	O
pigeonhole	O
principle	O
,	O
a	O
substitution	O
only	O
affects	O
at	O
most	O
q	O
overlapping	O
q	O
-	O
grams	O
.	O

Thus	O
,	O
no	O
more	O
than	O
k	O
×	O
q	O
q	O
-	O
grams	O
could	O
be	O
affected	O
with	O
hamming	O
distance	O
k	O
.	O

If	O
the	O
hamming	O
distance	O
between	O
s	O
and	O
another	O
sequence	O
r	O
is	O
less	O
than	O
k	O
,	O
then	O
the	O
number	O
T	O
of	O
shared	O
q	O
-	O
grams	O
is	O
at	O
least	O
.	O
(	O
1	O
)\	O
documentclass	O
[	O
12pt	O
]{	O
minimal	O
}	O
\	O
usepackage	O
{	O
amsmath	O
}	O
\	O
usepackage	O
{	O
wasysym	O
}	O
\	O
usepackage	O
{	O
amsfonts	O
}	O
\	O
usepackage	O
{	O
amssymb	O
}	O
\	O
usepackage	O
{	O
amsbsy	O
}	O
\	O
usepackage	O
{	O
mathrsfs	O
}	O
\	O
usepackage	O
{	O
upgreek	O
}	O
\	O
setlength	O
{\	O
oddsidemargin	O
}{-	O
69pt	O
}	O
\	O
begin	O
{	O
document	O
}	O
$$	O
T	O
=|	O
s	O
|-(	O
k	O
+	O
1	O
)\	O
times	O
q	O
+	O
1	O
$$	O
\	O
end	O
{	O
document	O
}	O
T	O
=|	O
s	O
|−(	O
k	O
+	O
1	O
)×	O
q	O
+	O
1	O

The	O
lower	O
bound	O
T	O
of	O
edit	O
distance	O
is	O
similar	O
to	O
that	O
of	O
hamming	O
distance	O
.	O

The	O
first	O
method	O
of	O
count	O
filtering	O
on	O
sequence	O
alignment	O
is	O
a	O
modified	O
SWIFT	O
algorithm	O
[	O
14	O
]	O
used	O
in	O
RazerS	O
[	O
15	O
].	O

Our	O
implementation	O

Pigeonhole	O
principle	O
is	O
faster	O
than	O
count	O
filtering	O
on	O
filtration	O
phase	O
,	O
while	O
the	O
verification	O
time	O
of	O
the	O
pigeonhole	O
-	O
principle	O
-	O
based	O
mappers	O
is	O
more	O
than	O
that	O
of	O
the	O
count	O
-	O
filtering	O
-	O
based	O
mappers	O
.	O

In	O
fact	O
,	O
there	O
is	O
a	O
tradeoff	O
between	O
filtration	O
and	O
verification	O
.	O

Because	O
the	O
proportion	O
of	O
verification	O
time	O
for	O
the	O
pigeonhole	O
-	O
principle	O
-	O
based	O
mappers	O
is	O
larger	O
than	O
that	O
for	O
the	O
count	O
-	O
filtering	O
-	O
based	O
mappers	O
,	O
the	O
former	O
benefit	O
more	O
from	O
the	O
improvement	O
of	O
verification	O
than	O
the	O
latter	O
.	O

As	O
our	O
verification	O
method	O
is	O
efficient	O
,	O
Bitmapper	O
used	O
pigeonhole	O
principle	O
instead	O
of	O
count	O
filtering	O
.	O

Verification	O

The	O
locations	O
reserved	O
after	O
filtration	O
are	O
the	O
candidates	O
for	O
matches	O
.	O

During	O
the	O
verification	O
phase	O
,	O
these	O
candidates	O
should	O
be	O
verified	O
by	O
calculating	O
their	O
edit	O
distance	O
or	O
hamming	O
distance	O
to	O
each	O
read	O
.	O

Compared	O
with	O
computing	O
hamming	O
distance	O
,	O
computing	O
edit	O
distance	O
is	O
extremely	O
time	O
-	O
consuming	O
.	O

In	O
the	O
following	O
,	O
we	O
first	O
describe	O
the	O
theoretical	O
basis	O
for	O
our	O
vectorized	O
Gene	O
Myers	O
’	O
bit	O
-	O
vector	O
algorithm	O
,	O
and	O
illustrate	O
the	O
algorithm	O
in	O
detail	O
.	O

Then	O
,	O
we	O
present	O
a	O
vectorized	O
verification	O
scheme	O
,	O
which	O
is	O
designed	O
to	O
work	O
with	O
the	O
vectorized	O
Gene	O
Myers	O
’	O
bit	O
-	O
vector	O
algorithm	O
.	O

Theoretical	O
basis	O

For	O
sequence	O
alignment	O
,	O
the	O
reads	O
and	O
the	O
reference	O
genomes	O
can	O
be	O
viewed	O
as	O
the	O
strings	O
including	O
letters	O
A	O
,	O
C	O
,	O
G	O
,	O
T	O
and	O
N	O
.	O

Assume	O
the	O
length	O
of	O
read	O
r	O
is	O
m	O
,	O
the	O
length	O
of	O
genome	O
s	O
is	O
n	O
,	O
and	O
the	O
threshold	O
of	O
edit	O
distance	O
is	O
k	O
.	O

The	O
dynamic	O
programming	O
algorithm	O
proposed	O
in	O
[	O
16	O
]	O
is	O
a	O
classic	O
method	O
for	O
this	O
problem	O
,	O
which	O
computes	O
a	O
dynamic	O
programming	O
matrix	O
C	O
[	O
0	O
…	O
m	O
,	O
0	O
…	O
n	O
]	O
of	O
size	O
(	O
m	O
+	O
1	O
)×(	O
n	O
+	O
1	O
).	O

The	O
well	O
-	O
known	O
recurrence	O
formula	O
is	O
as	O
follows	O
.	O
(	O
2	O
)\	O
documentclass	O
[	O
12pt	O
]{	O
minimal	O
}	O
\	O
usepackage	O
{	O
amsmath	O
}	O
\	O
usepackage	O
{	O
wasysym	O
}	O
\	O
usepackage	O
{	O
amsfonts	O
}	O
\	O
usepackage	O
{	O
amssymb	O
}	O
\	O
usepackage	O
{	O
amsbsy	O
}	O
\	O
usepackage	O
{	O
mathrsfs	O
}	O
\	O
usepackage	O
{	O
upgreek	O
}	O
\	O
setlength	O
{\	O
oddsidemargin	O
}{-	O
69pt	O
}	O
\	O
begin	O
{	O
document	O
}	O
$$	O
{\	O
small	O
{\	O
begin	O
{	O
aligned	O
}	O
&	O
E	O
[	O
i	O
,	O
j	O
]=\	O
left	O
\{	O
\	O
begin	O
{	O
array	O
}{	O
ll	O
}	O
0	O
&	O
r_	O
{	O
i	O
}=	O
s_	O
{	O
j	O
}\\	O
1	O
&	O
{	O
r_	O
{	O
i	O
}\	O
neq	O
s_	O
{	O
j	O
}}\\	O
\	O
end	O
{	O
array	O
}	O
\	O
right	O
.&	O
{	O
i	O
\	O
in	O
[	O
1	O
,	O
m	O
],	O
j	O
\	O
in	O
[	O
1	O
,	O
n	O
]}	O
&	O
\\	O
&	O
C	O
[	O
i	O
,	O
j	O
]=	O
min	O
\	O
left	O
\{	O
\	O
begin	O
{	O
array	O
}{	O
ll	O
}	O
C	O
[	O
i	O
,	O
j	O
-	O
1	O
]+	O
1	O
\\	O
C	O
[	O
i	O
-	O
1	O
,	O
j	O
]+	O
1	O
\\	O
C	O
[	O
i	O
-	O
1	O
,	O
j	O
-	O
1	O
]+	O
E	O
[	O
i	O
,	O
j	O
]	O
\	O
end	O
{	O
array	O
}	O
\	O
right	O
.&	O
{	O
i	O
\	O
in	O
[	O
1	O
,	O
m	O
],	O
j	O
\	O
in	O
[	O
1	O
,	O
n	O
]}&	O
\\	O
&	O
C	O
[	O
0	O
,	O
j	O
]=	O
0	O
,	O
C	O
[	O
i	O
,	O
0	O
]=	O
i	O
&	O
{	O
i	O
\	O
in	O
[	O
0	O
,	O
m	O
],	O
j	O
\	O
in	O
[	O
0	O
,	O
n	O
]}&	O
\	O
end	O
{	O
aligned	O
}}}	O
$$	O
\	O
end	O
{	O
document	O
}	O
E	O
[	O
i	O
,	O
j	O
]=	O
0ri	O
=	O
sj1ri	O
≠	O
sji	O
∈[	O
1	O
,	O
m	O
],	O
j	O
∈[	O
1	O
,	O
n	O
]	O
C	O
[	O
i	O
,	O
j	O
]=	O
minC	O
[	O
i	O
,	O
j	O
−	O
1	O
]+	O
1C	O
[	O
i	O
−	O
1	O
,	O
j	O
]+	O
1C	O
[	O
i	O
−	O
1	O
,	O
j	O
−	O
1	O
]+	O
E	O
[	O
i	O
,	O
j	O
]	O
i	O
∈[	O
1	O
,	O
m	O
],	O
j	O
∈[	O
1	O
,	O
n	O
]	O
C	O
[	O
0	O
,	O
j	O
]=	O
0	O
,	O
C	O
[	O
i	O
,	O
0	O
]=	O
ii	O
∈[	O
0	O
,	O
m	O
],	O
j	O
∈[	O
0	O
,	O
n	O
]	O

Its	O
time	O
complexity	O
is	O
O	O
(	O
m	O
×	O
n	O
)	O
and	O
it	O
is	O
very	O
slow	O
when	O
a	O
reference	O
genome	O
is	O
large	O
.	O

Actually	O
,	O
calculating	O
the	O
whole	O
dynamic	O
programming	O
matrix	O
is	O
unnecessary	O
when	O
the	O
edit	O
distance	O
threshold	O
k	O
has	O
been	O
set	O
in	O
advance	O
.	O

As	O
stated	O
in	O
the	O
following	O
Lemma	O
1	O
,	O
the	O
size	O
of	O
computing	O
area	O
in	O
dynamic	O
programming	O
matrix	O
is	O
related	O
to	O
k	O
,	O
which	O
has	O
been	O
proven	O
in	O
[	O
17	O
].	O

Lemma1	O
.	O

Given	O
a	O
read	O
of	O
length	O
m	O
,	O
a	O
candidate	O
location	O
d	O
in	O
a	O
reference	O
genome	O
and	O
an	O
edit	O
distance	O
threshold	O
k	O
,	O
the	O
start	O
and	O
end	O
positions	O
of	O
potential	O
matches	O
may	O
be	O
from	O
d	O
−	O
k	O
to	O
d	O
+	O
k	O
and	O
from	O
d	O
+	O
m	O
−	O
k	O
−	O
1	O
to	O
d	O
+	O
m	O
+	O
k	O
−	O
1	O
,	O
respectively	O
.	O

In	O
other	O
words	O
,	O
the	O
length	O
of	O
the	O
verification	O
window	O
,	O
which	O
would	O
be	O
calculated	O
with	O
the	O
read	O
,	O
is	O
m	O
+	O
2k	O
.	O

Figure	O
1	O
shows	O
an	O
example	O
for	O
Lemma	O
1	O
.	O

Note	O
that	O
the	O
candidate	O
location	O
d	O
is	O
obtained	O
by	O
subtracting	O
the	O
offset	O
c	O
from	O
dq	O
,	O
where	O
dq	O
is	O
an	O
exactly	O
matched	O
location	O
of	O
a	O
q	O
-	O
gram	O
and	O
c	O
is	O
the	O
offset	O
of	O
this	O
q	O
-	O
gram	O
in	O
the	O
read	O
.	O

If	O
there	O
are	O
only	O
at	O
most	O
k	O
deletions	O
,	O
the	O
segment	O
starting	O
at	O
d	O
−	O
k	O
and	O
ending	O
at	O
d	O
+	O
m	O
+	O
k	O
−	O
1	O
needs	O
to	O
be	O
computed	O
.	O

If	O
there	O
are	O
only	O
at	O
most	O
k	O
insertions	O
,	O
the	O
segment	O
range	O
needing	O
to	O
be	O
considered	O
is	O
from	O
d	O
+	O
k	O
to	O
d	O
+	O
m	O
−	O
k	O
−	O
1	O
.	O

Combining	O
with	O
these	O
two	O
intervals	O
,	O
the	O
range	O
of	O
maximal	O
verification	O
window	O
is	O
from	O
d	O
-	O
k	O
to	O
d	O
+	O
m	O
+	O
k	O
−	O
1	O
.	O
Fig	O
.	O
1The	O
verification	O
window	O
in	O
reference	O
genome	O
.	O

It	O
includes	O
the	O
candidate	O
mapping	O
locations	O
of	O
the	O
read	O
with	O
edit	O
distance	O
up	O
to	O
3	O

According	O
to	O
Lemma	O
1	O
,	O
the	O
length	O
of	O
verification	O
window	O
is	O
m	O
+	O
2k	O
.	O

Thus	O
,	O
only	O
(	O
m	O
+	O
2k	O
+	O
1	O
)×(	O
m	O
+	O
1	O
)	O
cells	O
in	O
dynamic	O
programming	O
matrix	O
need	O
to	O
be	O
calculated	O
.	O

We	O
define	O
the	O
diagonal	O
which	O
is	O
shifted	O
from	O
the	O
main	O
diagonal	O
by	O
k	O
diagonals	O
to	O
the	O
right	O
as	O
“	O
base	O
diagonal	O
”.	O

It	O
corresponds	O
to	O
the	O
situation	O
that	O
only	O
substitutions	O
are	O
considered	O
,	O
since	O
the	O
computing	O
path	O
moves	O
right	O
down	O
from	O
the	O
current	O
cell	O
in	O
dynamic	O
programming	O
matrix	O
to	O
the	O
adjacent	O
cell	O
when	O
a	O
substitution	O
occurs	O
.	O

For	O
a	O
deletion	O
in	O
the	O
reference	O
genome	O
,	O
the	O
computing	O
path	O
goes	O
right	O
to	O
the	O
adjacent	O
cell	O
.	O

For	O
an	O
insertion	O
,	O
this	O
path	O
goes	O
down	O
to	O
the	O
adjacent	O
cell	O
.	O

Thus	O
,	O
the	O
rightmost	O
and	O
the	O
leftmost	O
diagonals	O
are	O
obtained	O
by	O
sliding	O
k	O
diagonals	O
from	O
the	O
“	O
base	O
diagonal	O
”	O
to	O
its	O
right	O
and	O
left	O
,	O
respectively	O
.	O

In	O
fact	O
,	O
the	O
computing	O
area	O
in	O
dynamic	O
programming	O
matrix	O
is	O
a	O
banded	O
parallelogram	O
,	O
as	O
shownin	O
Fig	O
.	O
2	O
.	O
Fig	O
.	O
2The	O
computing	O
area	O
in	O
dynamic	O
programming	O
matrix	O
with	O
the	O
edit	O
distance	O
threshold	O
k	O
=	O
2	O
.	O

The	O
initial	O
cells	O
should	O
be	O
set	O
to	O
0	O
because	O
the	O
start	O
locations	O
of	O
potential	O
matches	O
can	O
not	O
be	O
known	O
in	O
advance	O

An	O
efficient	O
solution	O
for	O
this	O
problem	O
is	O
the	O
bit	O
-	O
vector	O
algorithm	O
proposed	O
in	O
[	O
11	O
],	O
which	O
is	O
based	O
on	O
the	O
observation	O
that	O
the	O
difference	O
of	O
the	O
values	O
between	O
adjacent	O
cells	O
in	O
dynamic	O
programming	O
matrix	O
is	O
at	O
most	O
1	O
.	O

It	O
is	O
able	O
to	O
encode	O
a	O
whole	O
column	O
in	O
dynamic	O
programming	O
matrix	O
using	O
bit	O
vectors	O
and	O
compute	O
a	O
column	O
by	O
bit	O
operations	O
rather	O
than	O
cell	O
-	O
by	O
-	O
cell	O
.	O

Banded	O
versions	O
of	O
Myers	O
’	O
bit	O
-	O
vector	O
algorithm	O
have	O
been	O
implemented	O
in	O
[	O
5	O
]	O
and	O
[	O
12	O
].	O

They	O
encode	O
a	O
banded	O
parallelogram	O
in	O
dynamic	O
programming	O
matrix	O
into	O
columns	O
for	O
column	O
-	O
wise	O
computation	O
,	O
since	O
only	O
limited	O
consecutive	O
diagonals	O
need	O
to	O
be	O
calculated	O
rather	O
than	O
the	O
whole	O
dynamic	O
programming	O
matrix	O
,	O
according	O
to	O
the	O
analysis	O
above	O
.	O

Figure	O
2	O
shows	O
that	O
at	O
most	O
2k	O
+	O
1	O
cells	O
in	O
each	O
column	O
need	O
to	O
be	O
calculated	O
,	O
so	O
that	O
the	O
length	O
of	O
the	O
bit	O
vectors	O
is	O
also	O
2k	O
+	O
1	O
.	O

If	O
2k	O
+	O
1	O
is	O
less	O
than	O
the	O
word	O
size	O
of	O
computer	O
,	O
a	O
column	O
could	O
be	O
processed	O
in	O
one	O
step	O
.	O

Vectorized	O
Gene	O
Myers	O
’	O
bit	O
-	O
vector	O
algorithm	O

A	O
significant	O
characteristic	O
of	O
the	O
NGS	O
reads	O
is	O
that	O
the	O
length	O
of	O
them	O
is	O
relatively	O
short	O
.	O

For	O
the	O
down	O
-	O
stream	O
applications	O
using	O
all	O
-	O
mappers	O
,	O
the	O
edit	O
distance	O
threshold	O
is	O
usually	O
set	O
to	O
4	O
%	O
or	O
5	O
%	O
of	O
the	O
read	O
length	O
.	O

Thus	O
,	O
the	O
edit	O
distance	O
threshold	O
k	O
is	O
usually	O
low	O
.	O

It	O
means	O
that	O
a	O
few	O
bits	O
are	O
enough	O
for	O
banded	O
bit	O
-	O
vector	O
algorithms	O
to	O
calculate	O
edit	O
distance	O
.	O

For	O
example	O
,	O
the	O
length	O
of	O
the	O
reads	O
sequenced	O
by	O
Illumina	O
platform	O
is	O
always	O
under	O
150	O
so	O
that	O
the	O
threshold	O
k	O
is	O
set	O
to	O
7	O
.	O

If	O
k	O
=	O
7	O
,	O
the	O
length	O
of	O
bit	O
vectors	O
is	O
15	O
,	O
while	O
the	O
word	O
size	O
of	O
modern	O
computers	O
is	O
typically	O
64	O
and	O
the	O
Streaming	O
SIMD	O
Extensions	O
(	O
SSE	O
)	O
instruction	O
set	O
has	O
several	O
128	O
-	O
bit	O
registers	O
.	O

Therefore	O
,	O
it	O
is	O
possible	O
to	O
load	O
multiple	O
bit	O
vectors	O
into	O
a	O
machine	O
word	O
or	O
a	O
128	O
-	O
bit	O
SSE	O
register	O
.	O

Furthermore	O
,	O
the	O
problem	O
can	O
be	O
converted	O
to	O
how	O
to	O
compute	O
the	O
edit	O
distance	O
between	O
several	O
patterns	O
and	O
a	O
text	O
.	O

Based	O
on	O
these	O
observations	O
,	O
we	O
propose	O
a	O
new	O
vectorized	O
Gene	O
Myers	O
’	O
bit	O
-	O
vector	O
algorithm	O
to	O
simultaneously	O
process	O
a	O
text	O
with	O
multiple	O
patterns	O
.	O

First	O
we	O
briefly	O
introduce	O
the	O
current	O
bit	O
-	O
vector	O
algorithm	O
proposed	O
in	O
[	O
12	O
],	O
which	O
is	O
the	O
basis	O
of	O
our	O
vectorized	O
algorithm	O
.	O

It	O
uses	O
delta	O
encoding	O
in	O
dynamic	O
programming	O
matrix	O
C	O
[	O
0	O
…	O
m	O
,	O
0	O
…	O
n	O
].	O

Specifically	O
,	O
for	O
column	O
j	O
,	O
the	O
bit	O
delta	O
vectors	O
are	O
.	O
(	O
3	O
)\	O
documentclass	O
[	O
12pt	O
]{	O
minimal	O
}	O
\	O
usepackage	O
{	O
amsmath	O
}	O
\	O
usepackage	O
{	O
wasysym	O
}	O
\	O
usepackage	O
{	O
amsfonts	O
}	O
\	O
usepackage	O
{	O
amssymb	O
}	O
\	O
usepackage	O
{	O
amsbsy	O
}	O
\	O
usepackage	O
{	O
mathrsfs	O
}	O
\	O
usepackage	O
{	O
upgreek	O
}	O
\	O
setlength	O
{\	O
oddsidemargin	O
}{-	O
69pt	O
}	O
\	O
begin	O
{	O
document	O
}	O
$$\	O
begin	O
{	O
array	O
}{*{	O
20	O
}	O
l	O
}	O
&{	O
HP	O
}	O
_	O
{	O
j	O
}[	O
i	O
]	O
\	O
equiv	O
(	O
C	O
[	O
i	O
,	O
j	O
]-	O
C	O
[	O
i	O
,	O
j	O
-	O
1	O
]=+	O
1	O
)&	O
\\	O
&{	O
HN	O
}	O
_	O
{	O
j	O
}[	O
i	O
]	O
\	O
equiv	O
(	O
C	O
[	O
i	O
,	O
j	O
]-	O
C	O
[	O
i	O
,	O
j	O
-	O
1	O
]=-	O
1	O
)&	O
\\	O
&{	O
VP	O
}	O
_	O
{	O
j	O
}[	O
i	O
]	O
\	O
equiv	O
(	O
C	O
[	O
i	O
,	O
j	O
]-	O
C	O
[	O
i	O
-	O
1	O
,	O
j	O
]=+	O
1	O
)&	O
i	O
\	O
in	O
[	O
1	O
,	O
m	O
],	O
j	O
\	O
in	O
[	O
1	O
,	O
n	O
]	O
&	O
\\	O
&{	O
VN	O
}	O
_	O
{	O
j	O
}[	O
i	O
]	O
\	O
equiv	O
(	O
C	O
[	O
i	O
,	O
j	O
]-	O
C	O
[	O
i	O
-	O
1	O
,	O
j	O
]=-	O
1	O
)&\\	O
&	O
D0_	O
{	O
j	O
}[	O
i	O
]=	O
C	O
[	O
i	O
,	O
j	O
]-	O
C	O
[	O
i	O
-	O
1	O
,	O
j	O
-	O
1	O
]&	O
\\	O
&{	O
Peq	O
}	O
_	O
{	O
j	O
}[	O
s	O
][	O
i	O
]\	O
equiv	O
(	O
pattern	O
[	O
i	O
]=	O
s	O
)&	O
s	O
\	O
in	O
\{	O
A	O
,	O
T	O
,	O
G	O
,	O
C	O
\}&	O
\	O
end	O
{	O
array	O
}	O
$$	O
\	O
end	O
{	O
document	O
}	O
HPj	O
[	O
i	O
]≡(	O
C	O
[	O
i	O
,	O
j	O
]−	O
C	O
[	O
i	O
,	O
j	O
−	O
1	O
]=+	O
1	O
)	O
HNj	O
[	O
i	O
]≡(	O
C	O
[	O
i	O
,	O
j	O
]−	O
C	O
[	O
i	O
,	O
j	O
−	O
1	O
]=−	O
1	O
)	O
VPj	O
[	O
i	O
]≡(	O
C	O
[	O
i	O
,	O
j	O
]−	O
C	O
[	O
i	O
−	O
1	O
,	O
j	O
]=+	O
1	O
)	O
i	O
∈[	O
1	O
,	O
m	O
],	O
j	O
∈[	O
1	O
,	O
n	O
]	O
VNj	O
[	O
i	O
]≡(	O
C	O
[	O
i	O
,	O
j	O
]−	O
C	O
[	O
i	O
−	O
1	O
,	O
j	O
]=−	O
1	O
)	O
D0j	O
[	O
i	O
]=	O
C	O
[	O
i	O
,	O
j	O
]−	O
C	O
[	O
i	O
−	O
1	O
,	O
j	O
−	O
1	O
]	O
Peqj	O
[	O
s	O
][	O
i	O
]≡(	O
pattern	O
[	O
i	O
]=	O
s	O
)	O
s	O
∈{	O
A	O
,	O
T	O
,	O
G	O
,	O
C	O
}	O

where	O
H	O
P	O
j	O
,	O
H	O
N	O
j	O
,	O
V	O
P	O
j	O
,	O
V	O
N	O
j	O
,	O
D0j	O
and	O
P	O
e	O
q	O
j	O
are	O
the	O
jth	O
element	O
of	O
H	O
P	O
,	O
H	O
N	O
,	O
V	O
P	O
,	O
V	O
N	O
,	O
D	O
and	O
P	O
e	O
q	O
,	O
respectively	O
.	O

And	O
the	O
notation	O
H	O
P	O
j	O
[	O
i	O
],	O
H	O
N	O
j	O
[	O
i	O
],	O
V	O
P	O
j	O
[	O
i	O
],	O
V	O
N	O
j	O
[	O
i	O
],	O
D0j	O
[	O
i	O
]	O
and	O
P	O
e	O
q	O
j	O
[	O
s	O
][	O
i	O
]	O
denote	O
the	O
ith	O
bit	O
of	O
H	O
P	O
j	O
,	O
H	O
N	O
j	O
,	O
V	O
P	O
j	O
,	O
V	O
N	O
j	O
,	O
D0j	O
and	O
P	O
e	O
q	O
j	O
[	O
s	O
],	O
respectively	O
.	O

If	O
the	O
values	O
of	O
these	O
bit	O
vectors	O
in	O
column	O
j	O
−	O
1	O
have	O
already	O
been	O
known	O
,	O
then	O
the	O
bit	O
vectors	O
in	O
column	O
j	O
can	O
be	O
computed	O
as	O
following	O
.	O


where	O
t	O
[	O
p	O
]	O
is	O
the	O
pth	O
element	O
of	O
text	O
.	O

Because	O
the	O
length	O
of	O
each	O
column	O
in	O
computing	O
area	O
is	O
2k	O
+	O
1	O
,	O
so	O
the	O
length	O
of	O
these	O
bit	O
vectors	O
is	O
also	O
2k	O
+	O
1	O
.	O

Based	O
on	O
the	O
Algorithm	O
1	O
,	O
we	O
developed	O
the	O
vectorized	O
Gene	O
Myers	O
’	O
bit	O
-	O
vector	O
algorithm	O
.	O

Briefly	O
,	O
it	O
packs	O
multiple	O
bit	O
-	O
vectors	O
of	O
different	O
patterns	O
into	O
a	O
machine	O
word	O
so	O
that	O
these	O
patterns	O
are	O
able	O
to	O
be	O
processed	O
with	O
one	O
text	O
simultaneously	O
.	O

The	O
calculating	O
of	O
each	O
bit	O
-	O
vector	O
is	O
similar	O
to	O
the	O
previous	O
banded	O
bit	O
-	O
vector	O
algorithm	O
[	O
12	O
].	O

However	O
,	O
some	O
problems	O
would	O
occur	O
when	O
multiple	O
bit	O
-	O
vectors	O
are	O
processed	O
as	O
a	O
whole	O
.	O

From	O
Algorithm	O
1	O
,	O
only	O
six	O
operations	O
have	O
been	O
used	O
:	O
‘	O
⊕’,	O
‘	O
|’,	O
‘	O
&’,	O
‘	O
≫’,	O
‘	O
∼’	O
and	O
‘+’.	O

They	O
can	O
be	O
divided	O
into	O
two	O
groups	O
.	O

The	O
first	O
group	O
consists	O
of	O
‘	O
⊕’,	O
‘	O
|’,	O
‘	O
&’	O
and	O
‘	O
∼’,	O
while	O
‘	O
≫’	O
and	O
‘+’	O
belong	O
to	O
the	O
second	O
group	O
.	O

Using	O
the	O
operations	O
of	O
the	O
first	O
group	O
in	O
a	O
machine	O
word	O
including	O
multiple	O
bit	O
vectors	O
does	O
not	O
have	O
any	O
difficulty	O
,	O
because	O
the	O
bit	O
vectors	O
in	O
it	O
cannot	O
be	O
affected	O
with	O
each	O
other	O
.	O

However	O
,	O
implementing	O
the	O
operations	O
of	O
the	O
second	O
group	O
as	O
a	O
whole	O
would	O
influence	O
each	O
other	O
.	O

For	O
operation	O
‘+’,	O
the	O
carries	O
resulted	O
from	O
addition	O
of	O
lower	O
bit	O
vectors	O
would	O
affect	O
the	O
nearly	O
upper	O
bit	O
vectors	O
.	O

For	O
operation	O
‘	O
≫’,	O
the	O
lowest	O
bit	O
in	O
upper	O
bit	O
vector	O
would	O
move	O
right	O
to	O
influence	O
the	O
nearly	O
lower	O
bit	O
vector	O
.	O

To	O
solve	O
the	O
problem	O
about	O
operation	O
‘+’,	O
the	O
data	O
structures	O
of	O
the	O
variables	O
used	O
in	O
our	O
vectorized	O
Gene	O
Myers	O
’	O
bit	O
-	O
vector	O
algorithm	O
have	O
been	O
redesigned	O
.	O

For	O
the	O
previous	O
banded	O
bit	O
-	O
vector	O
algorithm	O
[	O
12	O
],	O
2k	O
+	O
1	O
bits	O
are	O
enough	O
for	O
each	O
variable	O
.	O

Intuitively	O
,	O
for	O
the	O
vectorized	O
algorithm	O
,	O
the	O
length	O
of	O
each	O
variable	O
,	O
which	O
represents	O
n	O
bit	O
vectors	O
,	O
is	O
(	O
2k	O
+	O
1	O
)×	O
n	O
.	O

However	O
,	O
if	O
multiple	O
bit	O
vectors	O
are	O
loaded	O
into	O
a	O
machine	O
word	O
as	O
this	O
,	O
the	O
problem	O
above	O
could	O
not	O
be	O
solved	O
.	O

Our	O
solution	O
is	O
to	O
use	O
one	O
more	O
bit	O
between	O
two	O
bit	O
vectors	O
as	O
a	O
buffer	O
,	O
so	O
that	O
the	O
carries	O
resulted	O
from	O
the	O
operation	O
‘+’	O
among	O
the	O
lower	O
bit	O
vectors	O
would	O
not	O
affect	O
the	O
upper	O
bit	O
vectors	O
.	O

For	O
example	O
,	O
V	O
P	O
l	O
,	O
which	O
represents	O
the	O
difference	O
of	O
values	O
between	O
the	O
vertical	O
cells	O
for	O
pattern	O
l	O
,	O
is	O
a	O
part	O
of	O
V	O
P	O
,	O
starting	O
from	O
(	O
2k	O
+	O
2	O
)×	O
lth	O
bit	O
and	O
ending	O
at	O
(	O
2k	O
+	O
2	O
)×(	O
l	O
+	O
1	O
)−	O
1th	O
bit	O
.	O

For	O
h	O
patterns	O
,	O
the	O
bit	O
vectors	O
of	O
them	O
are	O
assembled	O
together	O
so	O
that	O
the	O
length	O
of	O
variables	O
including	O
VP	O
,	O
V	O
N	O
,	O
H	O
P	O
,	O
H	O
N	O
,	O
D0	O
and	O
Peq	O
is	O
not	O
less	O
than	O
(	O
2k	O
+	O
2	O
)×	O
h	O
,	O
as	O
shown	O
in	O
Fig	O
.	O
3	O
.	O

And	O
the	O
problem	O
about	O
operation	O
‘	O
≫’	O
has	O
been	O
solved	O
in	O
our	O
vectorized	O
Gene	O
Myers	O
’	O
bit	O
-	O
vector	O
algorithm	O
by	O
using	O
an	O
extra	O
‘	O
&’	O
operation	O
with	O
a	O
predefined	O
bitmask	O
.	O
Fig	O
.	O
3The	O
data	O
structure	O
for	O
the	O
variables	O
containing	O
several	O
bit	O
vectors	O
.	O

Each	O
pattern	O
needs	O
(	O
2k	O
+	O
2	O
)	O
bits	O
to	O
represent	O
itself	O

Our	O
vectorized	O
Gene	O
Myers	O
’	O
bit	O
-	O
vector	O
algorithm	O
proceeds	O
column	O
-	O
by	O
-	O
column	O
through	O
the	O
dynamic	O
programming	O
matrix	O
.	O

If	O
the	O
length	O
of	O
patterns	O
is	O
less	O
than	O
that	O
of	O
the	O
text	O
,	O
it	O
returns	O
the	O
optimal	O
end	O
location	O
for	O
each	O
pattern	O
on	O
text	O
.	O

Otherwise	O
,	O
it	O
returns	O
the	O
optimal	O
end	O
locations	O
for	O
the	O
text	O
on	O
each	O
pattern	O
.	O

As	O
an	O
example	O
,	O
we	O
present	O
the	O
outline	O
of	O
the	O
algorithm	O
for	O
the	O
second	O
situation	O
as	O
follows	O
.	O
Preprocess	O
the	O
variables	O
for	O
column	O
0	O
.	O
Set	O
the	O
Peq	O
array	O
for	O
the	O
first	O
2k	O
+	O
1	O
symbols	O
in	O
each	O
pattern	O
.	O
Set	O
VP	O
,	O
VN	O
and	O
E	O
to	O
0	O
,	O
where	O
E	O
contains	O
the	O
edit	O
distances	O
for	O
h	O
patterns	O
.	O
Scan	O
and	O
compute	O
the	O
banded	O
parallelogram	O
in	O
the	O
dynamic	O
programming	O
matrix	O
from	O
left	O
to	O
right	O
by	O
column	O
.	O
Compute	O
HP	O
,	O
HN	O
and	O
D0	O
of	O
column	O
j	O
from	O
VP	O
and	O
VN	O
of	O
column	O
j	O
-	O
1	O
.	O
Compute	O
VP	O
and	O
VN	O
of	O
next	O
column	O
using	O
HP	O
,	O
HN	O
and	O
D0	O
.	O
Set	O
Peq	O
for	O
next	O
column	O
by	O
shifting	O
to	O
the	O
right	O
of	O
the	O
current	O
Peq	O
.	O
Update	O
E	O
for	O
this	O
column	O
using	O
D0	O
.	O
Output	O
the	O
locations	O
with	O
the	O
lowest	O
edit	O
distance	O
as	O
the	O
optimal	O
end	O
location	O
on	O
each	O
pattern	O
,	O
separately	O
.	O

The	O
range	O
in	O
E	O
from	O
(	O
2k	O
+	O
2	O
)×	O
jth	O
bit	O
to	O
(	O
2k	O
+	O
2	O
)×(	O
j	O
+	O
1	O
)−	O
1th	O
bit	O
denotes	O
the	O
edit	O
distance	O
of	O
pattern	O
j	O
.	O

All	O
of	O
the	O
patterns	O
have	O
to	O
be	O
processed	O
one	O
by	O
one	O
in	O
step	O
3	O
,	O
while	O
step	O
1	O
and	O
step	O
2	O
can	O
process	O
multiple	O
patterns	O
simultaneously	O
.	O

Fortunately	O
,	O
unlike	O
step	O
1	O
and	O
step	O
2	O
,	O
step	O
3	O
is	O
not	O
always	O
necessary	O
due	O
to	O
two	O
reasons	O
:	O
a	O
)	O
the	O
number	O
of	O
matched	O
locations	O
is	O
much	O
less	O
than	O
that	O
of	O
the	O
candidate	O
locations	O
,	O
and	O
b	O
)	O
a	O
simple	O
branch	O
-	O
cut	O
strategy	O
is	O
used	O
in	O
step	O
2	O
to	O
stop	O
algorithm	O
earlier	O
,	O
as	O
described	O
in	O
[	O
5	O
].	O

More	O
details	O
of	O
the	O
vectorized	O
Gene	O
Myers	O
’	O
bit	O
-	O
vector	O
algorithm	O
can	O
be	O
found	O
in	O
the	O
Additional	O
file	O
1	O
:	O
Section	O
S5	O
.	O

Influence	O
of	O
the	O
number	O
of	O
patterns	O

We	O
have	O
already	O
implemented	O
the	O
vectorized	O
Gene	O
Myers	O
’	O
bit	O
-	O
vector	O
algorithm	O
using	O
64	O
-	O
bit	O
machine	O
word	O
and	O
128	O
-	O
bit	O
SSE2	O
register	O
.	O

It	O
can	O
calculate	O
the	O
edit	O
distance	O
of	O
a	O
text	O
with	O
n	O
patterns	O
.	O

In	O
order	O
to	O
figure	O
out	O
the	O
influence	O
of	O
different	O
n	O
,	O
we	O
selected	O
a	O
100	O
bp	O
read	O
from	O
specimen	O
HG00096	O
as	O
a	O
text	O
and	O
regarded	O
1	O
thousand	O
subsequences	O
of	O
human	B-OG
genome	O
starting	O
at	O
the	O
candidate	O
locations	O
of	O
this	O
read	O
as	O
patterns	O
.	O

The	O
threshold	O
k	O
of	O
edit	O
distance	O
was	O
set	O
to	O
4	O
.	O

Because	O
the	O
length	O
of	O
each	O
bit	O
vector	O
is	O
2k	O
+	O
2	O
=	O
10	O
and	O
the	O
length	O
of	O
a	O
SSE	O
register	O
is	O
128	O
,	O
the	O
vectorized	O
Gene	O
Myers	O
’	O
bit	O
-	O
vector	O
algorithm	O
can	O
process	O
at	O
most	O
12	O
patterns	O
with	O
a	O
text	O
simultaneously	O
.	O

Figure	O
4	O
shows	O
the	O
running	O
time	O
of	O
the	O
algorithm	O
with	O
different	O
n	O
.	O

Although	O
the	O
performance	O
was	O
improved	O
until	O
n	O
=	O
12	O
,	O
we	O
found	O
that	O
the	O
running	O
time	O
decreased	O
rapidly	O
from	O
n	O
=	O
1	O
to	O
n	O
=	O
8	O
,	O
while	O
it	O
only	O
decreased	O
a	O
little	O
from	O
n	O
=	O
9	O
to	O
n	O
=	O
12	O
.	O
Fig	O
.	O
4Performance	O
for	O
the	O
vectorized	O
Gene	O
Myers	O
’	O
bit	O
-	O
vector	O
algorithm	O
according	O
to	O
different	O
n	O

The	O
reason	O
is	O
that	O
for	O
the	O
original	O
banded	O
bit	O
-	O
vector	O
algorithm	O
which	O
calculates	O
the	O
edit	O
distance	O
between	O
a	O
text	O
and	O
a	O
pattern	O
,	O
algorithm	O
stops	O
once	O
it	O
meets	O
the	O
requirement	O
of	O
the	O
branch	O
-	O
cut	O
strategy	O
.	O

For	O
our	O
vectorized	O
Gene	O
Myers	O
’	O
bit	O
-	O
vector	O
algorithm	O
,	O
calculating	O
stops	O
until	O
all	O
of	O
the	O
patterns	O
meet	O
the	O
requirement	O
.	O

It	O
is	O
difficult	O
when	O
n	O
is	O
large	O
and	O
would	O
result	O
in	O
extra	O
cost	O
.	O

Therefore	O
,	O
we	O
set	O
n	O
to	O
8	O
in	O
most	O
cases	O
.	O

For	O
higher	O
edit	O
distance	O
threshold	O
,	O
n	O
is	O
set	O
to	O
4	O
since	O
a	O
128	O
-	O
bit	O
register	O
cannot	O
load	O
8	O
bit	O
vectors	O
.	O

Vectorized	O
verification	O
scheme	O

In	O
order	O
to	O
make	O
full	O
use	O
of	O
the	O
vectorized	O
algorithm	O
,	O
the	O
patterns	O
used	O
to	O
compare	O
with	O
a	O
same	O
text	O
should	O
be	O
collected	O
.	O

The	O
traditional	O
verification	O
scheme	O
,	O
which	O
only	O
selects	O
a	O
read	O
and	O
a	O
subsequence	O
in	O
given	O
reference	O
genome	O
as	O
input	O
every	O
time	O
,	O
is	O
not	O
suitable	O
for	O
our	O
vectorized	O
Gene	O
Myers	O
’	O
bit	O
-	O
vector	O
algorithm	O
.	O

It	O
is	O
necessary	O
to	O
propose	O
a	O
vectorized	O
verification	O
scheme	O
that	O
considers	O
multiple	O
reads	O
as	O
patterns	O
and	O
a	O
subsequences	O
in	O
given	O
reference	O
genome	O
as	O
text	O
,	O
or	O
vice	O
versa	O
.	O

In	O
other	O
words	O
,	O
multiple	O
reads	O
may	O
correspond	O
to	O
one	O
location	O
in	O
given	O
reference	O
genome	O
,	O
or	O
multiple	O
locations	O
correspond	O
to	O
one	O
read	O
.	O

Figure	O
5a	O
shows	O
the	O
vectorized	O
verification	O
scheme	O
A	O
,	O
which	O
considers	O
multiple	O
reads	O
as	O
patterns	O
and	O
a	O
subsequence	O
in	O
given	O
reference	O
genome	O
as	O
a	O
text	O
.	O

All	O
of	O
the	O
four	O
reads	O
have	O
a	O
matched	O
3	O
-	O
gram	O
ATG	O
in	O
the	O
reference	O
genome	O
and	O
share	O
the	O
same	O
candidate	O
location	O
d	O
.	O

Generally	O
,	O
this	O
scheme	O
needs	O
to	O
build	O
a	O
reads	O
index	O
in	O
order	O
to	O
collect	O
the	O
reads	O
sharing	O
the	O
same	O
locations	O
efficiently	O
.	O

Figure	O
5b	O
shows	O
vectorized	O
verification	O
scheme	O
B	O
that	O
considers	O
a	O
read	O
as	O
a	O
text	O
and	O
multiple	O
subsequences	O
starting	O
at	O
the	O
candidate	O
locations	O
of	O
the	O
read	O
as	O
patterns	O
.	O

The	O
read	O
here	O
corresponds	O
to	O
two	O
subsequences	O
sharing	O
a	O
2	O
-	O
gram	O
AT	O
.	O

These	O
two	O
subsequences	O
are	O
obtained	O
by	O
looking	O
up	O
the	O
index	O
of	O
the	O
reference	O
genome	O
using	O
the	O
non	O
-	O
overlapping	O
q	O
-	O
grams	O
of	O
the	O
read	O
.	O
Fig	O
.	O
5Two	O
vectorized	O
verification	O
schemes	O
for	O
the	O
vectorized	O
Gene	O
Myers	O
’	O
bit	O
-	O
vector	O
algorithm	O
.	O
a	O
A	O
location	O
in	O
a	O
reference	O
genome	O
corresponds	O
to	O
four	O
reads	O
.	O
b	O
A	O
read	O
corresponds	O
to	O
two	O
locations	O
in	O
the	O
reference	O
genome	O

According	O
to	O
the	O
analysis	O
above	O
,	O
we	O
found	O
that	O
scheme	O
A	O
takes	O
advantage	O
of	O
the	O
repeatability	O
of	O
the	O
reads	O
,	O
while	O
B	O
takes	O
advantage	O
of	O
the	O
repeatability	O
of	O
the	O
reference	O
genomes	O
.	O

In	O
the	O
experimental	O
results	O
presented	O
in	O
Additional	O
file	O
1	O
:	O
Section	O
S2	O
,	O
the	O
repeatability	O
of	O
genomes	O
is	O
much	O
more	O
than	O
that	O
of	O
reads	O
.	O

Therefore	O
,	O
scheme	O
B	O
suits	O
the	O
vectorized	O
Gene	O
Myers	O
’	O
bit	O
-	O
vector	O
algorithm	O
better	O
than	O
A	O
.	O

Another	O
advantage	O
of	O
scheme	O
B	O
is	O
that	O
it	O
does	O
not	O
need	O
an	O
extra	O
index	O
of	O
reads	O
.	O

For	O
the	O
reasons	O
outlined	O
above	O
,	O
BitMapper	O
is	O
implemented	O
as	O
scheme	O
B	O
.	O

Results	O
and	O
discussion	O

BitMapper	O
was	O
compared	O
with	O
five	O
state	O
-	O
of	O
-	O
the	O
-	O
art	O
all	O
-	O
mappers	O
,	O
including	O
mrFAST	O
(	O
with	O
FastHASH	O
),	O
Hobbes	O
2	O
,	O
RazerS	O
3	O
,	O
Masai	O
and	O
Yara	O
,	O
and	O
three	O
popular	O
best	O
-	O
mappers	O
,	O
Bowtie	O
2	O
,	O
GEM	O
and	O
BWA	O
in	O
our	O
experiments	O
.	O

The	O
default	O
configurations	O
of	O
these	O
mappers	O
were	O
used	O
except	O
stated	O
otherwise	O
,	O
and	O
the	O
results	O
were	O
output	O
in	O
the	O
SAM	O
format	O
.	O

For	O
a	O
fair	O
comparison	O
,	O
all	O
mappers	O
ran	O
on	O
the	O
same	O
computer	O
with	O
an	O
Intel	O
(	O
R	O
)	O
Core	O
(	O
TM	O
)	O
i7	O
-	O
4770	O
processor	O
and	O
24GB	O
of	O
RAM	O
running	O
64	O
-	O
bit	O
Ubuntu	O
14	O
.	O
04	O
.	O

The	O
distance	O
metric	O
used	O
in	O
our	O
experiments	O
was	O
edit	O
distance	O
with	O
threshold	O
5	O
%.	O

The	O
reference	O
genomes	O
were	O
the	O
whole	O
genome	O
of	O
human	B-OG
(	O
NCBI	O
HG19	O
),	O
caenorhabditis	B-OG
elegans	I-OG
(	O
WormBase	O
WS201	O
)	O
and	O
arabidopsis	B-OG
thaliana	I-OG
(	O
assembly	O
TAIR10	O
).	O

In	O
the	O
following	O
,	O
mapping	O
time	O
and	O
sensitivity	O
on	O
both	O
real	O
and	O
simulated	O
data	O
sets	O
were	O
presented	O
.	O

Sensitivity	O
comparison	O
using	O
Rabema	O
results	O

In	O
this	O
experiment	O
,	O
100	O
k	O
simulated	O
100	O
bp	O
reads	O
of	O
human	B-OG
were	O
generated	O
by	O
a	O
simulator	O
tool	O
Mason	O
[	O
18	O
]	O
using	O
default	O
profile	O
setting	O
.	O

And	O
we	O
also	O
selected	O
a	O
real	O
data	O
set	O
consisting	O
of	O
1	O
million	O
100	O
bp	O
reads	O
from	O
specimen	O
HG00096	O
of	O
the	O
1000	O
Genome	O
project	O
[	O
19	O
].	O

To	O
compare	O
the	O
sensitivity	O
of	O
single	O
-	O
end	O
alignment	O
in	O
different	O
genomes	O
,	O
we	O
used	O
the	O
first	O
1	O
million	O
100	O
bp	O
reads	O
of	O
the	O
data	O
sets	O
SRX026594	O
and	O
the	O
first	O
1	O
million	O
101	O
bp	O
reads	O
of	O
SRR1604937	O
,	O
which	O
were	O
obtained	O
from	O
the	O
DNA	O
Data	O
Bank	O
of	O
Japan	O
(	O
DDBJ	O
)	O
repository	O
[	O
20	O
]	O
and	O
National	O
Center	O
for	O
Biotechnology	O
Information	O
(	O
NCBI	O
)	O
repository	O
[	O
21	O
],	O
respectively	O
.	O

To	O
compare	O
the	O
sensitivity	O
of	O
different	O
mappers	O
fairly	O
,	O
Rabema	O
benchmark	O
[	O
22	O
]	O
was	O
used	O
to	O
evaluate	O
them	O
.	O

It	O
has	O
been	O
widely	O
used	O
in	O
recent	O
articles	O
,	O
such	O
as	O
[	O
5	O
,	O
6	O
]	O
and	O
[	O
10	O
].	O

The	O
categories	O
of	O
sensitivity	O
scores	O
provided	O
by	O
Rabema	O
benchmark	O
include	O
all	O
,	O
all	O
-	O
best	O
,	O
and	O
any	O
-	O
best	O
,	O
which	O
are	O
designed	O
to	O
denote	O
the	O
mapped	O
fraction	O
of	O
all	O
,	O
all	O
of	O
the	O
best	O
,	O
and	O
any	O
of	O
the	O
best	O
matches	O
.	O

And	O
to	O
measure	O
these	O
scores	O
,	O
Rabema	O
benchmark	O
defines	O
two	O
metrics	O
:	O
normalized	O
found	O
interval	O
and	O
found	O
interval	O
.	O

For	O
normalized	O
found	O
interval	O
,	O
each	O
read	O
is	O
given	O
at	O
most	O
one	O
point	O
no	O
matter	O
how	O
many	O
mapping	O
locations	O
it	O
has	O
.	O

For	O
found	O
interval	O
,	O
each	O
mapping	O
location	O
is	O
given	O
one	O
point	O
[	O
see	O
Additional	O
file	O
1	O
:	O
Section	O
S4	O
for	O
more	O
detailed	O
illustration	O
].	O

Note	O
that	O
we	O
only	O
presented	O
the	O
Rabema	O
scores	O
(	O
normalized	O
found	O
interval	O
)	O
in	O
the	O
following	O
,	O
and	O
presented	O
the	O
Rabema	O
scores	O
(	O
found	O
interval	O
)	O
in	O
Additional	O
file	O
1	O
:	O
Section	O
S4	O
due	O
to	O
the	O
limited	O
space	O
.	O

Because	O
Rabema	O
benchmark	O
needs	O
a	O
baseline	O
of	O
mapping	O
locations	O
to	O
build	O
a	O
gold	O
standard	O
,	O
we	O
implemented	O
RazerS	O
3	O
in	O
full	O
sensitivity	O
mode	O
,	O
which	O
can	O
report	O
100	O
%	O
of	O
mapping	O
locations	O
for	O
each	O
read	O
.	O

Rabema	O
benchmark	O
results	O
on	O
simulated	O
data	O

Table	O
1	O
shows	O
the	O
results	O
of	O
mapping	O
100k	O
simulated	O
reads	O
to	O
the	O
reference	O
genome	O
of	O
human	B-OG
.	O

The	O
Rabema	O
all	O
,	O
all	O
-	O
best	O
and	O
any	O
-	O
best	O
scores	O
were	O
presented	O
here	O
.	O

Each	O
Rabema	O
category	O
has	O
a	O
large	O
number	O
and	O
6	O
small	O
numbers	O
representing	O
the	O
total	O
score	O
and	O
the	O
scores	O
for	O
mapping	O
locations	O
with	O
\	O
documentclass	O
[	O
12pt	O
]{	O
minimal	O
}	O
\	O
usepackage	O
{	O
amsmath	O
}	O
\	O
usepackage	O
{	O
wasysym	O
}	O
\	O
usepackage	O
{	O
amsfonts	O
}	O
\	O
usepackage	O
{	O
amssymb	O
}	O
\	O
usepackage	O
{	O
amsbsy	O
}	O
\	O
usepackage	O
{	O
mathrsfs	O
}	O
\	O
usepackage	O
{	O
upgreek	O
}	O
\	O
setlength	O
{\	O
oddsidemargin	O
}{-	O
69pt	O
}	O
\	O
begin	O
{	O
document	O
}	O
$\	O
binom	O
{	O
0	O
\	O
1	O
\	O
2	O
}{	O
3	O
\	O
4	O
\	O
5	O
}$	O
\	O
end	O
{	O
document	O
}	O
012345	O
errors	O
,	O
respectively	O
.	O

Best	O
-	O
mappers	O
including	O
Bowtie	O
2	O
,	O
GEM	O
and	O
BWA	O
were	O
implemented	O
in	O
both	O
high	O
and	O
default	O
sensitivity	O
mode	O
.	O

In	O
high	O
sensitivity	O
mode	O
,	O
the	O
Rabema	O
all	O
-	O
scores	O
(	O
normalized	O
found	O
interval	O
)	O
for	O
Bowtie	O
2	O
,	O
BWA	O
and	O
GEM	O
were	O
99	O
.	O
73	O
%,	O
97	O
.	O
80	O
%	O
and	O
96	O
.	O
02	O
%,	O
respectively	O
.	O

It	O
seems	O
that	O
these	O
best	O
-	O
mappers	O
can	O
achieve	O
nearly	O
full	O
sensitivity	O
.	O

However	O
,	O
the	O
Rabema	O
all	O
-	O
scores	O
(	O
found	O
interval	O
)	O
of	O
BWA	O
and	O
GEM	O
,	O
which	O
can	O
be	O
found	O
in	O
in	O
Additional	O
file	O
1	O
:	O
Table	O
S3	O
,	O
were	O
86	O
.	O
67	O
%	O
and	O
61	O
.	O
46	O
%,	O
respectively	O
.	O

For	O
Bowtie	O
2	O
,	O
although	O
the	O
Rabema	O
all	O
-	O
scores	O
(	O
found	O
interval	O
)	O
was	O
still	O
more	O
than	O
98	O
%,	O
it	O
was	O
extremely	O
slow	O
using	O
one	O
thread	O
.	O

Thus	O
,	O
we	O
implemented	O
Bowtie	O
2	O
with	O
16	O
threads	O
and	O
did	O
not	O
present	O
its	O
running	O
time	O
here	O
.	O

This	O
means	O
that	O
the	O
best	O
-	O
mappers	O
are	O
not	O
suitable	O
for	O
applications	O
requiring	O
full	O
or	O
nearly	O
full	O
sensitivity	O
.	O

It	O
is	O
mainly	O
because	O
the	O
best	O
-	O
mappers	O
are	O
designed	O
specifically	O
for	O
identifying	O
the	O
best	O
mapping	O
locations	O
of	O
each	O
read	O
.	O
Table	O
1Rabema	O
benchmark	O
results	O
(	O
normalized	O
found	O
interval	O
)	O
for	O
100	O
k	O
simulated	O
readsMapperTimeBenchmark	O
category	O
[	O
min	O
:	O
sec	O
]	O
All	O
[%]	O
All	O
-	O
best	O
[%]	O
Any	O
-	O
best	O
[%]	O
Bowtie2	O
a	O
0	O
:	O
1890	O
.	O
1897	O
.	O
6896	O
.	O
6092	O
.	O
2595	O
.	O
8796	O
.	O
4696	O
.	O
1494	O
.	O
4899	O
.	O
26100	O
.	O
0099	O
.	O
4997	O
.	O
5178	O
.	O
9552	O
.	O
7121	O
.	O
1393	O
.	O
6992	O
.	O
7692	O
.	O
2796	O
.	O
6396	O
.	O
2795	O
.	O
38BWA	O
b	O
0	O
:	O
4992	O
.	O
28100	O
.	O
0099	O
.	O
8196	O
.	O
7598	O
.	O
84100	O
.	O
0099	O
.	O
8099	O
.	O
4098	O
.	O
89100	O
.	O
0099	O
.	O
8699	O
.	O
5079	O
.	O
4744	O
.	O
9116	O
.	O
6593	O
.	O
6178	O
.	O
4270	O
.	O
6793	O
.	O
7078	O
.	O
6171	O
.	O
17GEM	O
c	O
0	O
:	O
1492	O
.	O
7598	O
.	O
2597	O
.	O
6595	O
.	O
6998	O
.	O
1598	O
.	O
2798	O
.	O
2197	O
.	O
9799	O
.	O
3699	O
.	O
4299	O
.	O
4299	O
.	O
2488	O
.	O
4467	O
.	O
0633	O
.	O
4498	O
.	O
1196	O
.	O
8795	O
.	O
8799	O
.	O
4298	O
.	O
7497	O
.	O
33Bowtie	O
2	O
—	O
99	O
.	O
73100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
97100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
97100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
9699	O
.	O
5395	O
.	O
4599	O
.	O
9599	O
.	O
6797	O
.	O
8999	O
.	O
9599	O
.	O
6797	O
.	O
89BWA40	O
:	O
3297	O
.	O
80100	O
.	O
0099	O
.	O
9799	O
.	O
6298	O
.	O
95100	O
.	O
0099	O
.	O
9799	O
.	O
6298	O
.	O
95100	O
.	O
0099	O
.	O
9799	O
.	O
6294	O
.	O
2683	O
.	O
5375	O
.	O
3093	O
.	O
8279	O
.	O
0370	O
.	O
9393	O
.	O
8279	O
.	O
1671	O
.	O
17GEM3	O
:	O
1596	O
.	O
0298	O
.	O
2598	O
.	O
2498	O
.	O
0998	O
.	O
1598	O
.	O
2798	O
.	O
1898	O
.	O
0199	O
.	O
3599	O
.	O
4299	O
.	O
4199	O
.	O
2495	O
.	O
9287	O
.	O
0266	O
.	O
3598	O
.	O
1797	O
.	O
0295	O
.	O
9499	O
.	O
4498	O
.	O
6897	O
.	O
17Masai17	O
:	O
4399	O
.	O
86100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
96100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
97100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
8799	O
.	O
5497	O
.	O
8799	O
.	O
8599	O
.	O
2998	O
.	O
5999	O
.	O
8598	O
.	O
3498	O
.	O
70Hobbes	O
27	O
:	O
5199	O
.	O
8299	O
.	O
9899	O
.	O
9799	O
.	O
9799	O
.	O
9799	O
.	O
9899	O
.	O
9799	O
.	O
9799	O
.	O
99100	O
.	O
0099	O
.	O
9999	O
.	O
9899	O
.	O
9899	O
.	O
8797	O
.	O
2099	O
.	O
9799	O
.	O
9899	O
.	O
8099	O
.	O
97100	O
.	O
0099	O
.	O
92mrFAST12	O
:	O
3299	O
.	O
32100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
42100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
43100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
9687	O
.	O
51100	O
.	O
00100	O
.	O
0053	O
.	O
69100	O
.	O
00100	O
.	O
0054	O
.	O
09RazerS	O
3	O
d	O
41	O
:	O
3399	O
.	O
92100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
99100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
99100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
8498	O
.	O
62100	O
.	O
0099	O
.	O
9599	O
.	O
92100	O
.	O
0099	O
.	O
9599	O
.	O
92RazerS	O
354	O
:	O
59100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00Yara3	O
:	O
06	O
—————————————————————	O
BitMapper2	O
:	O
5799	O
.	O
99100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
9999	O
.	O
98100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00Bowtie2	O
a	O
,	O
BWA	O
b	O
,	O
and	O
GEM	O
c	O
represent	O
the	O
results	O
in	O
default	O
sensitivity	O
mode	O
,	O
while	O
Bowtie2	O
,	O
BWA	O
,	O
and	O
GEM	O
represent	O
the	O
results	O
in	O
high	O
sensitivity	O
mode	O
.	O

The	O
RazerS	O
3	O
d	O
and	O
RazerS	O
3	O
represent	O
the	O
results	O
of	O
RazerS	O
3	O
in	O
default	O
and	O
full	O
sensitivity	O
mode	O
,	O
respectively	O
.	O

Note	O
that	O
in	O
default	O
mode	O
,	O
RazerS	O
3	O
is	O
designed	O
to	O
find	O
99	O
%	O
of	O
mapping	O
locations	O
,	O
while	O
Bowtie2	O
,	O
BWA	O
,	O
and	O
GEM	O
are	O
designed	O
to	O
find	O
the	O
best	O
mapping	O
locations	O
for	O
each	O
reads	O

Compared	O
to	O
the	O
best	O
-	O
mappers	O
,	O
all	O
-	O
mappers	O
usually	O
achieve	O
higher	O
sensitivity	O
.	O

For	O
mrFAST	O
,	O
it	O
is	O
interesting	O
that	O
its	O
Rabema	O
any	O
-	O
best	O
and	O
all	O
-	O
best	O
scores	O
were	O
53	O
.	O
69	O
%	O
and	O
54	O
.	O
09	O
%	O
at	O
edit	O
distance	O
5	O
,	O
which	O
were	O
much	O
lower	O
than	O
other	O
all	O
-	O
mappers	O
.	O

Masai	O
and	O
Hobbes	O
2	O
lost	O
a	O
few	O
mapping	O
locations	O
due	O
to	O
their	O
heuristic	O
methods	O
.	O

BitMapper	O
and	O
RazerS	O
3	O
were	O
the	O
only	O
two	O
mappers	O
identifying	O
100	O
%	O
all	O
of	O
the	O
best	O
and	O
any	O
of	O
the	O
best	O
mapping	O
locations	O
.	O

Note	O
that	O
the	O
all	O
,	O
all	O
-	O
best	O
and	O
any	O
-	O
best	O
scores	O
of	O
RazerS	O
3	O
in	O
full	O
sensitivity	O
mode	O
were	O
100	O
%,	O
since	O
we	O
used	O
the	O
output	O
of	O
RazerS	O
3	O
in	O
full	O
sensitivity	O
mode	O
as	O
the	O
baseline	O
for	O
Rabema	O
benchmark	O
.	O

However	O
,	O
it	O
was	O
extremely	O
slow	O
.	O

The	O
Rabema	O
all	O
-	O
score	O
for	O
BitMapper	O
was	O
nearly	O
100	O
%,	O
which	O
was	O
the	O
best	O
except	O
RazerS	O
3	O
in	O
full	O
sensitivity	O
.	O

We	O
did	O
not	O
present	O
the	O
sensitivity	O
of	O
Yara	O
in	O
Table	O
1	O
,	O
since	O
it	O
could	O
not	O
generate	O
CIGAR	O
strings	O
for	O
suboptimal	O
alignments	O
,	O
which	O
led	O
to	O
incorrect	O
output	O
of	O
Rabema	O
benchmark	O
.	O

Rabema	O
benchmark	O
results	O
on	O
real	O
data	O

According	O
to	O
the	O
results	O
above	O
,	O
we	O
found	O
that	O
the	O
sensitivities	O
of	O
GEM	O
and	O
BWA	O
on	O
both	O
high	O
and	O
default	O
sensitivity	O
modes	O
were	O
not	O
high	O
enough	O
for	O
the	O
applications	O
needing	O
all	O
or	O
nearly	O
all	O
mapping	O
locations	O
.	O

For	O
Bowtie	O
2	O
,	O
although	O
the	O
sensitivity	O
on	O
high	O
sensitivity	O
mode	O
has	O
been	O
improved	O
,	O
it	O
spent	O
much	O
more	O
time	O
and	O
memory	O
than	O
all	O
-	O
mappers	O
.	O

Thus	O
,	O
we	O
would	O
not	O
present	O
the	O
results	O
of	O
them	O
in	O
the	O
following	O
.	O

To	O
compare	O
the	O
sensitivity	O
of	O
all	O
-	O
mappers	O
on	O
real	O
data	O
sets	O
,	O
we	O
also	O
measured	O
the	O
Rabema	O
scores	O
using	O
1	O
million	O
100	O
bp	O
reads	O
of	O
human	B-OG
,	O
as	O
shown	O
in	O
Table	O
2	O
.	O

And	O
to	O
evaluate	O
the	O
sensitivity	O
for	O
different	O
genomes	O
,	O
the	O
Rabema	O
scores	O
for	O
caenorhabditis	B-OG
elegans	I-OG
genome	O
and	O
arabidopsis	B-OG
thaliana	I-OG
genome	O
were	O
presented	O
in	O
Tables	O
3	O
and	O
4	O
,	O
respectively	O
.	O

According	O
to	O
these	O
results	O
,	O
we	O
fonud	O
that	O
the	O
sensitivity	O
of	O
Bitmapper	O
was	O
also	O
best	O
among	O
all	O
of	O
the	O
all	O
-	O
mappers	O
except	O
RazerS	O
3	O
in	O
full	O
sensitivity	O
,	O
which	O
generated	O
the	O
baseline	O
of	O
Rabema	O
benchmark	O
.	O

As	O
the	O
results	O
in	O
Table	O
1	O
,	O
the	O
Rabema	O
scores	O
of	O
Yara	O
were	O
not	O
included	O
in	O
Tables	O
2	O
,	O
3	O
and	O
4	O
due	O
to	O
the	O
absence	O
of	O
CIGAR	O
strings	O
.	O
Table	O
2Rabema	O
benchmark	O
results	O
(	O
normalized	O
found	O
interval	O
)	O
for	O
1	O
million	O
100	O
bp	O
real	O
reads	O
of	O
humanMapperTimeBenchmark	O
category	O
[	O
min	O
:	O
sec	O
]	O
All	O
[%]	O
All	O
-	O
best	O
[%]	O
Any	O
-	O
best	O
[%]	O
Masai42	O
:	O
5099	O
.	O
94100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
99100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
99100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
9798	O
.	O
93100	O
.	O
0099	O
.	O
9999	O
.	O
70100	O
.	O
0099	O
.	O
9999	O
.	O
80Hobbes	O
260	O
:	O
0599	O
.	O
8999	O
.	O
9999	O
.	O
9799	O
.	O
9799	O
.	O
9899	O
.	O
9899	O
.	O
9899	O
.	O
9999	O
.	O
9999	O
.	O
9999	O
.	O
99100	O
.	O
0099	O
.	O
9699	O
.	O
9198	O
.	O
4399	O
.	O
9999	O
.	O
9999	O
.	O
91100	O
.	O
00100	O
.	O
0099	O
.	O
99mrFAST98	O
:	O
0699	O
.	O
79100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
91100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
92100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
9796	O
.	O
45100	O
.	O
0099	O
.	O
9693	O
.	O
61100	O
.	O
0099	O
.	O
9793	O
.	O
88RazerS	O
3	O
a	O
372	O
:	O
2199	O
.	O
90100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
99100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
99100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
8098	O
.	O
45100	O
.	O
0099	O
.	O
9099	O
.	O
47100	O
.	O
0099	O
.	O
9199	O
.	O
70RazerS	O
3512	O
:	O
46100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00Yara29	O
:	O
25	O
—————————————————————	O
BitMapper17	O
:	O
0399	O
.	O
99100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
99100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
99100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
9999	O
.	O
98100	O
.	O
00100	O
.	O
0099	O
.	O
98100	O
.	O
00100	O
.	O
0099	O
.	O
99RazerS	O
3	O
a	O
:	O
the	O
result	O
of	O
RazerS	O
3	O
in	O
default	O
sensitivity	O
mode	O
(	O
i	O
.	O
e	O
.,	O
finding	O
99	O
%	O
of	O
mapping	O
locations	O
);	O
RazerS	O
3	O
:	O
the	O
result	O
of	O
RazerS	O
3	O
in	O
full	O
sensitivity	O
mode	O
(	O
i	O
.	O
e	O
.,	O
finding	O
100	O
%	O
of	O
mapping	O
locations	O
)	O
Table	O
3Rabema	O
benchmark	O
results	O
(	O
normalized	O
found	O
interval	O
)	O
for	O
1	O
million	O
100	O
bp	O
real	O
reads	O
of	O
caenorhabditis	O
elegansMapperTimeBenchmark	O
category	O
[	O
min	O
:	O
sec	O
]	O
All	O
[%]	O
All	O
-	O
best	O
[%]	O
Any	O
-	O
best	O
[%]	O
Masai3	O
:	O
0299	O
.	O
93100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
99100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
99100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
9299	O
.	O
6798	O
.	O
1499	O
.	O
9899	O
.	O
9399	O
.	O
7899	O
.	O
9999	O
.	O
9599	O
.	O
89Hobbes	O
22	O
:	O
0199	O
.	O
94100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
99100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
99100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
9999	O
.	O
8698	O
.	O
1899	O
.	O
9999	O
.	O
9699	O
.	O
7299	O
.	O
9999	O
.	O
9999	O
.	O
97mrFAST3	O
:	O
4098	O
.	O
89100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
95100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
96100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
9999	O
.	O
9996	O
.	O
5099	O
.	O
99100	O
.	O
0093	O
.	O
4399	O
.	O
99100	O
.	O
0093	O
.	O
89RazerS	O
3	O
a	O
7	O
:	O
1899	O
.	O
95100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
99100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
99100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
9999	O
.	O
7998	O
.	O
6499	O
.	O
9999	O
.	O
8999	O
.	O
6199	O
.	O
9999	O
.	O
9599	O
.	O
84RazerS	O
37	O
:	O
53100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00Yara1	O
:	O
25	O
—————————————————————	O
BitMapper0	O
:	O
3299	O
.	O
99100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
99100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
99100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
9999	O
.	O
98100	O
.	O
0099	O
.	O
9999	O
.	O
98100	O
.	O
0099	O
.	O
9999	O
.	O
98RazerS	O
3	O
a	O
:	O
the	O
result	O
of	O
RazerS	O
3	O
in	O
default	O
sensitivity	O
mode	O
(	O
i	O
.	O
e	O
.,	O
finding	O
99	O
%	O
of	O
mapping	O
locations	O
);	O
RazerS	O
3	O
:	O
the	O
result	O
of	O
RazerS	O
3	O
in	O
full	O
sensitivity	O
mode	O
(	O
i	O
.	O
e	O
.,	O
finding	O
100	O
%	O
of	O
mapping	O
locations	O
)	O
Table	O
4Rabema	O
benchmark	O
results	O
(	O
normalized	O
found	O
interval	O
)	O
for	O
1	O
million	O
101	O
bp	O
real	O
reads	O
of	O
arabidopsis	O
thalianaMapperTimeBenchmark	O
category	O
[	O
min	O
:	O
sec	O
]	O
All	O
[%]	O
All	O
-	O
best	O
[%]	O
Any	O
-	O
best	O
[%]	O
Masai3	O
:	O
0599	O
.	O
96100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
99100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
99100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
9799	O
.	O
9699	O
.	O
2599	O
.	O
9899	O
.	O
9699	O
.	O
2799	O
.	O
9899	O
.	O
9699	O
.	O
53Hobbes	O
21	O
:	O
5299	O
.	O
92100	O
.	O
00100	O
.	O
0099	O
.	O
9999	O
.	O
99100	O
.	O
00100	O
.	O
0099	O
.	O
9999	O
.	O
99100	O
.	O
00100	O
.	O
0099	O
.	O
9999	O
.	O
9799	O
.	O
8898	O
.	O
7299	O
.	O
9899	O
.	O
9999	O
.	O
6499	O
.	O
99100	O
.	O
0099	O
.	O
98mrFAST2	O
:	O
3099	O
.	O
88100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
98100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
99100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
9999	O
.	O
9997	O
.	O
9499	O
.	O
99100	O
.	O
0097	O
.	O
70100	O
.	O
00100	O
.	O
0098	O
.	O
50RazerS	O
3	O
a	O
8	O
:	O
3099	O
.	O
88100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
98100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
99100	O
.	O
00100	O
.	O
00100	O
.	O
0099	O
.	O
9999	O
.	O
7098	O
.	O
1299	O
.	O
9899	O
.	O
7098	O
.	O
6399	O
.	O
9999	O
.	O
8499	O
.	O
27RazerS	O
39	O
:	O
06100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00100	O
.	O
00Yara1	O
:	O
25	O
—————————————————————	O
BitMapper0	O
:	O
3299	O
.	O
99100	O
.	O
00100	O
.	O
0099	O
.	O
9999	O
.	O
99100	O
.	O
00100	O
.	O
0099	O
.	O
9999	O
.	O
99100	O
.	O
00100	O
.	O
0099	O
.	O
9999	O
.	O
98100	O
.	O
0099	O
.	O
9999	O
.	O
99100	O
.	O
0099	O
.	O
9999	O
.	O
99100	O
.	O
0099	O
.	O
99RazerS	O
3	O
a	O
:	O
the	O
result	O
of	O
RazerS	O
3	O
in	O
default	O
sensitivity	O
mode	O
(	O
i	O
.	O
e	O
.,	O
finding	O
99	O
%	O
of	O
mapping	O
locations	O
);	O
RazerS	O
3	O
:	O
the	O
result	O
of	O
RazerS	O
3	O
in	O
full	O
sensitivity	O
mode	O
(	O
i	O
.	O
e	O
.,	O
finding	O
100	O
%	O
of	O
mapping	O
locations	O
)	O

Performance	O
comparison	O
on	O
large	O
data	O
sets	O

In	O
order	O
to	O
compare	O
the	O
performance	O
of	O
BitMapper	O
with	O
other	O
mappers	O
on	O
large	O
data	O
sets	O
,	O
we	O
selected	O
a	O
single	O
-	O
end	O
data	O
set	O
consisting	O
of	O
10	O
million	O
100	O
bp	O
reads	O
from	O
specimen	O
HG00096	O
of	O
the	O
1000	O
Genome	O
project	O
.	O

And	O
to	O
compare	O
the	O
performance	O
in	O
different	O
genomes	O
,	O
we	O
used	O
the	O
first	O
10	O
million	O
100	O
bp	O
reads	O
of	O
the	O
data	O
sets	O
SRX026594	O
and	O
the	O
first	O
10	O
million	O
101	O
bp	O
reads	O
of	O
SRR1604937	O
,	O
which	O
were	O
obtained	O
from	O
the	O
DNA	O
Data	O
Bank	O
of	O
Japan	O
(	O
DDBJ	O
)	O
repository	O
and	O
National	O
Center	O
for	O
Biotechnology	O
Information	O
(	O
NCBI	O
)	O
repository	O
,	O
respectively	O
.	O

The	O
first	O
10	O
million	O
read	O
pairs	O
of	O
these	O
data	O
sets	O
were	O
also	O
used	O
to	O
measure	O
the	O
performance	O
of	O
paired	O
-	O
end	O
alignment	O
.	O

Moreover	O
,	O
to	O
demonstrate	O
that	O
Bitmapper	O
also	O
works	O
well	O
for	O
longer	O
reads	O
,	O
a	O
real	O
data	O
set	O
and	O
two	O
simulated	O
data	O
sets	O
were	O
used	O
.	O

The	O
real	O
data	O
set	O
consists	O
of	O
the	O
first	O
10	O
million	O
151	O
bp	O
reads	O
of	O
human	B-OG
in	O
the	O
HiSeq	O
2500	O
NA12878	O
demo	O
data	O
set	O
in	O
[	O
23	O
],	O
while	O
the	O
two	O
simulated	O
data	O
sets	O
include	O
10	O
million	O
300	O
bp	O
reads	O
of	O
caenorhabditis	B-OG
elegans	I-OG
and	O
arabidopsis	B-OG
thaliana	I-OG
,	O
respectively	O
.	O

All	O
of	O
these	O
data	O
sets	O
with	O
100	O
bp	O
,	O
151	O
bp	O
and	O
300	O
bp	O
reads	O
were	O
mapped	O
to	O
their	O
reference	O
genomes	O
using	O
edit	O
distance	O
threshold	O
5	O
,	O
7	O
and	O
15	O
,	O
respectively	O
.	O

Because	O
the	O
Rabema	O
benchmark	O
cannot	O
be	O
implemented	O
in	O
such	O
large	O
data	O
sets	O
,	O
we	O
used	O
the	O
percentage	O
of	O
mapped	O
reads	O
and	O
the	O
number	O
of	O
mapping	O
sites	O
to	O
measure	O
the	O
sensitivity	O
,	O
instead	O
of	O
Rabema	O
scores	O
.	O

For	O
running	O
time	O
comparison	O
,	O
the	O
results	O
of	O
different	O
mappers	O
with	O
single	O
and	O
eight	O
threads	O
were	O
presented	O
in	O
Tables	O
5	O
,	O
6	O
,	O
7	O
and	O
8	O
.	O

Note	O
that	O
since	O
Masai	O
and	O
mrFAST	O
do	O
not	O
support	O
multi	O
-	O
threading	O
,	O
the	O
results	O
of	O
them	O
with	O
eight	O
threads	O
were	O
omitted	O
.	O

In	O
addition	O
,	O
peak	O
memory	O
consumption	O
was	O
also	O
compared	O
.	O
Table	O
5Results	O
for	O
mapping	O
10	O
million	O
100	O
bp	O
and	O
151	O
bp	O
single	O
-	O
end	O
reads	O
against	O
human	B-OG
genome100	O
bp	O
reads151	O
bp	O
readsMapperTime	O
[	O
min	O
:	O
sec	O
]	O
PeakMappingMappedTime	O
[	O
min	O
:	O
sec	O
]	O
PeakMappingMapped1	O
thr8	O
thrmemorysites	O
[	O
million	O
]	O
reads	O
[%]	O
1	O
thr8	O
thrmemorysites	O
[	O
million	O
]	O
reads	O
[%]	O
Masai361	O
:	O
35	O
—	O
20	O
.	O
1GB1371	O
.	O
1892	O
.	O
2736602	O
:	O
06	O
—	O
21	O
.	O
3GB939	O
.	O
8993	O
.	O
8483Hobbes	O
2587	O
:	O
04135	O
:	O
1014	O
.	O
0GB1368	O
.	O
8692	O
.	O
2767694	O
:	O
53151	O
:	O
5214	O
.	O
5GB936	O
.	O
4293	O
.	O
8481mrFAST921	O
:	O
46	O
—	O
4	O
.	O
9GB1374	O
.	O
7692	O
.	O
2572795	O
:	O
59	O
—	O
6	O
.	O
5GB939	O
.	O
4893	O
.	O
7376RazerS	O
3	O
a	O
——>	O
24GB	O
————>	O
24GB	O
——	O
RazerS	O
3	O
——>	O
24GB	O
————>	O
24GB	O
——	O
Yara278	O
:	O
0978	O
:	O
109	O
.	O
0GB1367	O
.	O
4292	O
.	O
2658389	O
:	O
5693	O
:	O
159	O
.	O
3GB939	O
.	O
4493	O
.	O
8480BitMapper158	O
:	O
5732	O
:	O
5917	O
.	O
9GB1375	O
.	O
6892	O
.	O
2771135	O
:	O
0627	O
:	O
5619	O
.	O
2GB940	O
.	O
1693	O
.	O
8487RazerS	O
3	O
a	O
:	O
the	O
result	O
of	O
RazerS	O
3	O
in	O
default	O
sensitivity	O
mode	O
(	O
i	O
.	O
e	O
.,	O
finding	O
99	O
%	O
of	O
mapping	O
locations	O
);	O
RazerS	O
3	O
:	O
the	O
result	O
of	O
RazerS	O
3	O
in	O
full	O
sensitivity	O
mode	O
(	O
i	O
.	O
e	O
.,	O
finding	O
100	O
%	O
of	O
mapping	O
locations	O
)	O
Table	O
6Results	O
for	O
mapping	O
10	O
million	O
100	O
bp	O
single	O
-	O
end	O
reads	O
against	O
caenorhabditis	B-OG
elegans	I-OG
and	O
arabidopsis	O
thalianaCaenorhabditis	O
elegansArabidopsis	O
thalianaMapperTime	O
[	O
min	O
:	O
sec	O
]	O
PeakMappingMappedTime	O
[	O
min	O
:	O
sec	O
]	O
PeakMappingMapped1	O
thr8	O
thrmemorysites	O
[	O
million	O
]	O
reads	O
[%]	O
1	O
thr8	O
thrmemorysites	O
[	O
million	O
]	O
reads	O
[%]	O
Masai22	O
:	O
28	O
—	O
3	O
.	O
2GB54	O
.	O
6190	O
.	O
414021	O
:	O
06	O
—	O
3	O
.	O
3GB57	O
.	O
8398	O
.	O
2578Hobbes	O
216	O
:	O
514	O
:	O
420	O
.	O
9GB55	O
.	O
4090	O
.	O
415016	O
:	O
053	O
:	O
421	O
.	O
0GB57	O
.	O
7698	O
.	O
2616mrFAST35	O
:	O
15	O
—	O
4	O
.	O
2GB55	O
.	O
6090	O
.	O
411923	O
:	O
12	O
—	O
4	O
.	O
3GB57	O
.	O
9498	O
.	O
2609RazerS	O
3	O
a	O
69	O
:	O
2459	O
:	O
3912	O
.	O
0GB55	O
.	O
2490	O
.	O
411886	O
:	O
3972	O
:	O
3110	O
.	O
3GB57	O
.	O
4998	O
.	O
2551RazerS	O
375	O
:	O
2761	O
:	O
4012	O
.	O
6GB55	O
.	O
6190	O
.	O
415489	O
:	O
3175	O
:	O
2610	O
.	O
4GB57	O
.	O
9698	O
.	O
2622Yara13	O
:	O
423	O
:	O
371	O
.	O
1GB54	O
.	O
6590	O
.	O
415015	O
:	O
134	O
:	O
011	O
.	O
2GB57	O
.	O
8798	O
.	O
2608BitMapper5	O
:	O
081	O
:	O
254	O
.	O
5GB55	O
.	O
6390	O
.	O
41595	O
:	O
241	O
:	O
304	O
.	O
5GB57	O
.	O
9498	O
.	O
2631RazerS	O
3	O
a	O
:	O
the	O
result	O
of	O
RazerS	O
3	O
in	O
default	O
sensitivity	O
mode	O
(	O
i	O
.	O
e	O
.,	O
finding	O
99	O
%	O
of	O
mapping	O
locations	O
);	O
RazerS	O
3	O
:	O
the	O
result	O
of	O
RazerS	O
3	O
in	O
full	O
sensitivity	O
mode	O
(	O
i	O
.	O
e	O
.,	O
finding	O
100	O
%	O
of	O
mapping	O
locations	O
)	O
Table	O
7Results	O
for	O
mapping	O
10	O
million	O
300bp	O
single	O
-	O
end	O
reads	O
against	O
caenorhabditis	B-OG
elegans	I-OG
and	O
arabidopsis	O
thalianaCaenorhabditis	O
elegansArabidopsis	O
thalianaMapperTime	O
[	O
min	O
:	O
sec	O
]	O
PeakMappingMappedTime	O
[	O
min	O
:	O
sec	O
]	O
PeakMappingMapped1	O
thr8	O
thrmemorysites	O
[	O
million	O
]	O
reads	O
[%]	O
1	O
thr8	O
thrmemorysites	O
[	O
million	O
]	O
reads	O
[%]	O
Masai48	O
:	O
54	O
—	O
11	O
.	O
5GB17	O
.	O
4499	O
.	O
989446	O
:	O
26	O
—	O
11	O
.	O
8GB14	O
.	O
8399	O
.	O
9884Hobbes	O
266	O
:	O
3813	O
:	O
120	O
.	O
9GB2	O
.	O
140	O
.	O
532764	O
:	O
2512	O
:	O
501	O
.	O
0GB0	O
.	O
010	O
.	O
0219mrFAST80	O
:	O
56	O
—	O
9	O
.	O
9GB16	O
.	O
7196	O
.	O
188847	O
:	O
00	O
—	O
10	O
.	O
0GB14	O
.	O
2796	O
.	O
2356RazerS	O
3	O
a	O
195	O
:	O
07182	O
:	O
3411	O
.	O
9GB17	O
.	O
4399	O
.	O
9894172	O
:	O
21155	O
:	O
4812	O
.	O
0GB14	O
.	O
8299	O
.	O
9884RazerS	O
3209	O
:	O
30185	O
:	O
2912	O
.	O
6GB17	O
.	O
4499	O
.	O
9894185	O
:	O
05160	O
:	O
0212	O
.	O
0GB14	O
.	O
8399	O
.	O
9884Yara34	O
:	O
207	O
:	O
432	O
.	O
1GB17	O
.	O
3399	O
.	O
989429	O
:	O
446	O
:	O
342	O
.	O
1GB14	O
.	O
7299	O
.	O
9884BitMapper12	O
:	O
264	O
:	O
5710	O
.	O
1GB17	O
.	O
4399	O
.	O
989412	O
:	O
104	O
:	O
5510	O
.	O
2GB14	O
.	O
8399	O
.	O
9884RazerS	O
3	O
a	O
:	O
the	O
result	O
of	O
RazerS	O
3	O
in	O
default	O
sensitivity	O
mode	O
(	O
i	O
.	O
e	O
.,	O
finding	O
99	O
%	O
of	O
mapping	O
locations	O
);	O
RazerS	O
3	O
:	O
the	O
result	O
of	O
RazerS	O
3	O
in	O
full	O
sensitivity	O
mode	O
(	O
i	O
.	O
e	O
.,	O
finding	O
100	O
%	O
of	O
mapping	O
locations	O
)	O
Table	O
8Results	O
for	O
mapping	O
10	O
million	O
paired	O
-	O
end	O
readsHumanCaenorhabditis	O
elegansArabidopsis	O
thalianaMapperTime	O
[	O
min	O
:	O
sec	O
]	O
PeakMappedTime	O
[	O
min	O
:	O
sec	O
]	O
PeakMappedTime	O
[	O
min	O
:	O
sec	O
]	O
PeakMapped1	O
thr8	O
thrmemorypairs	O
[%]	O
1	O
thr8	O
thrmemorypairs	O
[%]	O
1	O
thr8	O
thrmemorypairs	O
[%]	O
Masai464	O
:	O
07	O
—	O
16	O
.	O
8GB84	O
.	O
898431	O
:	O
07	O
—	O
11	O
.	O
3GB65	O
.	O
867429	O
:	O
40	O
—	O
11	O
.	O
6GB64	O
.	O
9149Hobbes	O
2439	O
:	O
05105	O
:	O
2914	O
.	O
6GB87	O
.	O
394580	O
:	O
0422	O
:	O
410	O
.	O
9GB67	O
.	O
173923	O
:	O
596	O
:	O
211	O
.	O
0GB68	O
.	O
1224RazerS	O
3	O
a	O
——>	O
24GB	O
—	O
61	O
:	O
1547	O
:	O
1116	O
.	O
4GB67	O
.	O
184151	O
:	O
2541	O
:	O
3114	O
.	O
9GB68	O
.	O
1250RazerS	O
3	O
——>	O
24GB	O
—	O
66	O
:	O
2850	O
:	O
1317	O
.	O
4GB67	O
.	O
189455	O
:	O
3342	O
:	O
3817	O
.	O
1GB68	O
.	O
1473Yara489	O
:	O
58117	O
:	O
4013	O
.	O
2GB87	O
.	O
161423	O
:	O
435	O
:	O
472	O
.	O
0GB67	O
.	O
105828	O
:	O
096	O
:	O
522	O
.	O
2GB66	O
.	O
8150BitMapper177	O
:	O
4739	O
:	O
3921	O
.	O
5GB87	O
.	O
423311	O
:	O
163	O
:	O
158	O
.	O
0GB67	O
.	O
18836	O
:	O
472	O
:	O
208	O
.	O
1GB68	O
.	O
1500RazerS	O
3	O
a	O
:	O
the	O
result	O
of	O
RazerS	O
3	O
in	O
default	O
sensitivity	O
mode	O
(	O
i	O
.	O
e	O
.,	O
finding	O
99	O
%	O
of	O
mapping	O
locations	O
);	O
RazerS	O
3	O
:	O
the	O
result	O
of	O
RazerS	O
3	O
in	O
full	O
sensitivity	O
mode	O
(	O
i	O
.	O
e	O
.,	O
finding	O
100	O
%	O
of	O
mapping	O
locations	O
)	O

Sensitivity	O
and	O
running	O
time	O
comparison	O

Table	O
5	O
shows	O
the	O
results	O
of	O
mapping	O
10	O
million	O
100	O
bp	O
and	O
151	O
bp	O
single	O
-	O
end	O
reads	O
to	O
the	O
whole	O
human	B-OG
genome	O
.	O

Results	O
of	O
the	O
best	O
-	O
mappers	O
including	O
GEM	O
,	O
Bowtie	O
2	O
and	O
BWA	O
were	O
left	O
out	O
,	O
because	O
the	O
sensitivity	O
of	O
them	O
is	O
usually	O
substantially	O
less	O
than	O
that	O
of	O
all	O
-	O
mappers	O
and	O
the	O
running	O
time	O
is	O
usually	O
longer	O
,	O
as	O
shown	O
in	O
Table	O
1	O
and	O
Additional	O
file	O
1	O
:	O
Table	O
S3	O
.	O

The	O
results	O
in	O
Table	O
5	O
show	O
that	O
BitMapper	O
was	O
the	O
best	O
in	O
terms	O
of	O
sensitivity	O
and	O
running	O
time	O
on	O
the	O
human	B-OG
genome	O
data	O
sets	O
.	O

For	O
10	O
million	O
151	O
bp	O
reads	O
,	O
it	O
was	O
nearly	O
3	O
times	O
faster	O
than	O
the	O
second	O
fastest	O
read	O
mapper	O
Yara	O
,	O
and	O
achieved	O
highest	O
sensitivity	O
with	O
940	O
.	O
16	O
million	O
mapping	O
locations	O
identified	O
and	O
93	O
.	O
8487	O
%	O
reads	O
mapped	O
in	O
the	O
human	B-OG
genome	O
.	O

Compared	O
to	O
Masai	O
,	O
BitMapper	O
was	O
more	O
than	O
4	O
times	O
faster	O
and	O
found	O
more	O
mapping	O
locations	O
.	O

For	O
10	O
million	O
100	O
bp	O
reads	O
,	O
Bitmapper	O
also	O
presented	O
the	O
best	O
performance	O
among	O
all	O
read	O
mappers	O
.	O

The	O
results	O
of	O
RazerS	O
3	O
were	O
not	O
shown	O
,	O
since	O
the	O
memory	O
requirement	O
of	O
RazerS	O
3	O
was	O
larger	O
than	O
the	O
memory	O
capacity	O
of	O
our	O
computer	O
.	O

Similarly	O
,	O
BitMapper	O
was	O
superior	O
in	O
mapping	O
10	O
million	O
single	O
-	O
end	O
reads	O
against	O
the	O
genomes	O
of	O
caenorhabditis	B-OG
elegans	I-OG
and	O
arabidopsis	B-OG
thaliana	I-OG
,	O
as	O
shown	O
in	O
Table	O
6	O
.	O

And	O
for	O
longer	O
300	O
bp	O
reads	O
,	O
Bitmapper	O
was	O
still	O
more	O
efficient	O
than	O
others	O
,	O
as	O
shown	O
in	O
Table	O
7	O
.	O

Finally	O
,	O
Table	O
8	O
shows	O
the	O
experimental	O
results	O
for	O
paired	O
-	O
end	O
alignment	O
,	O
where	O
three	O
data	O
sets	O
consisting	O
of	O
10	O
million	O
read	O
pairs	O
from	O
different	O
genomes	O
were	O
used	O
to	O
evaluate	O
the	O
performance	O
.	O

Again	O
,	O
BitMapper	O
was	O
the	O
best	O
,	O
2	O
.	O
5	O
times	O
faster	O
than	O
Hobbes	O
2	O
,	O
nearly	O
3	O
times	O
faster	O
than	O
Masai	O
and	O
Yara	O
in	O
human	B-OG
genome	O
.	O

Note	O
that	O
the	O
results	O
of	O
the	O
human	B-OG
genome	O
using	O
RazerS	O
3	O
are	O
not	O
shown	O
here	O
,	O
because	O
the	O
memory	O
requirement	O
of	O
RazerS	O
3	O
was	O
larger	O
than	O
the	O
memory	O
capacity	O
of	O
our	O
computer	O
.	O

For	O
caenorhabditis	B-OG
elegans	I-OG
and	O
arabidopsis	B-OG
thaliana	I-OG
,	O
BitMapper	O
was	O
also	O
several	O
times	O
faster	O
than	O
the	O
existing	O
all	O
-	O
mappers	O
.	O

In	O
addition	O
,	O
BitMapper	O
still	O
showed	O
great	O
performance	O
in	O
sensitivity	O
comparison	O
.	O

We	O
did	O
not	O
present	O
the	O
results	O
of	O
mrFAST	O
,	O
since	O
it	O
reported	O
many	O
extra	O
locations	O
.	O

Thus	O
,	O
the	O
running	O
time	O
was	O
extremely	O
long	O
.	O

Memory	O
usage	O
comparison	O

If	O
a	O
reference	O
genome	O
is	O
large	O
,	O
the	O
memory	O
usage	O
of	O
most	O
mappers	O
mainly	O
depends	O
on	O
the	O
size	O
of	O
the	O
genome	O
and	O
the	O
index	O
for	O
it	O
.	O

For	O
instance	O
,	O
the	O
human	B-OG
genome	O
could	O
be	O
regarded	O
as	O
a	O
long	O
string	O
including	O
3	O
.	O
15	O
billion	O
symbols	O
so	O
that	O
3GB	O
is	O
required	O
to	O
store	O
them	O
.	O

For	O
hash	O
table	O
index	O
,	O
the	O
locations	O
for	O
each	O
q	O
-	O
gram	O
should	O
be	O
saved	O
and	O
a	O
location	O
is	O
represented	O
by	O
a	O
32	O
-	O
bit	O
integer	O
.	O

Thus	O
,	O
BitMapper	O
and	O
Hobbes	O
2	O
,	O
which	O
both	O
index	O
the	O
reference	O
genome	O
using	O
hash	O
tables	O
,	O
require	O
more	O
than	O
14GB	O
to	O
load	O
the	O
index	O
and	O
genome	O
.	O

Similarly	O
,	O
Masai	O
requires	O
large	O
memory	O
space	O
and	O
uses	O
about	O
20GB	O
to	O
map	O
10	O
million	O
reads	O
to	O
human	B-OG
genome	O
.	O

Although	O
the	O
hash	O
table	O
index	O
is	O
also	O
used	O
in	O
mrFAST	O
,	O
only	O
7GB	O
is	O
used	O
since	O
it	O
splits	O
the	O
whole	O
human	B-OG
genome	O
and	O
index	O
into	O
several	O
segments	O
and	O
loads	O
one	O
of	O
them	O
at	O
a	O
time	O
.	O

Yara	O
is	O
another	O
read	O
mapper	O
which	O
requires	O
small	O
memory	O
space	O
,	O
since	O
it	O
uses	O
the	O
BWT	O
and	O
FM	O
-	O
index	O
.	O

The	O
memory	O
usage	O
of	O
RazerS	O
3	O
mainly	O
depends	O
on	O
the	O
number	O
of	O
mapping	O
locations	O
.	O

It	O
needs	O
more	O
than	O
24GB	O
to	O
map	O
10	O
million	O
151	O
bp	O
reads	O
of	O
human	B-OG
.	O

Conclusion	O

BitMapper	O
is	O
designed	O
to	O
find	O
all	O
mapping	O
locations	O
for	O
each	O
read	O
based	O
on	O
bit	O
-	O
vector	O
computing	O
.	O

In	O
experiments	O
on	O
both	O
simulated	O
and	O
real	O
data	O
sets	O
,	O
it	O
achieved	O
nearly	O
full	O
sensitivity	O
and	O
superior	O
speed	O
,	O
outperforming	O
existing	O
state	O
-	O
of	O
-	O
the	O
-	O
art	O
all	O
-	O
mappers	O
.	O

The	O
verification	O
of	O
edit	O
distance	O
constitutes	O
a	O
significant	O
portion	O
of	O
the	O
whole	O
running	O
time	O
.	O

We	O
propose	O
a	O
new	O
vectorized	O
Gene	O
Myers	O
’	O
bit	O
-	O
vector	O
algorithm	O
,	O
which	O
calculates	O
the	O
edit	O
distance	O
of	O
a	O
read	O
to	O
multiple	O
locations	O
in	O
a	O
given	O
genome	O
.	O

To	O
make	O
full	O
use	O
of	O
the	O
algorithm	O
,	O
the	O
traditional	O
verification	O
scheme	O
is	O
redesigned	O
in	O
BitMapper	O
.	O

Recently	O
,	O
a	O
new	O
SIMD	O
instruction	O
set	O
AVX2	O
has	O
been	O
applied	O
to	O
many	O
CPUs	O
.	O

Thus	O
,	O
the	O
performance	O
of	O
our	O
vectorized	O
Gene	O
Myers	O
’	O
bit	O
-	O
vector	O
algorithm	O
will	O
be	O
improved	O
further	O
by	O
using	O
AVX2	O
in	O
the	O
future	O
.	O

The	O
vectorized	O
bit	O
-	O
vector	O
computing	O
approach	O
can	O
also	O
be	O
used	O
to	O
accelerate	O
filtration	O
,	O
which	O
is	O
a	O
future	O
research	O
direction	O
in	O
BitMapper	O
.	O

BitMapper	O
is	O
implemented	O
in	O
C	O
under	O
a	O
GPL	O
license	O
and	O
is	O
able	O
to	O
download	O
at	O
http	O
://	O
home	O
.	O
ustc	O
.	O
edu	O
.	O
cn	O
/%	O
7Echhy	O
.	O

Additional	O
file	O

Additional	O
file	O
1	O
Supplementary	O
material	O
.	O
This	O
file	O
consists	O
of	O
the	O
configuration	O
of	O
each	O
read	O
mapper	O
and	O
the	O
analysis	O
of	O
the	O
two	O
vectorized	O
verification	O
schemes	O
.	O

Besides	O
,	O
we	O
present	O
the	O
pseudo	O
code	O
of	O
our	O
vectorized	O
bit	O
-	O
vector	O
algorithm	O
and	O
the	O
performance	O
comparison	O
between	O
it	O
and	O
other	O
existing	O
implementation	O
of	O
the	O
Gene	O
Myers	O
’	O
algorithmin	O
in	O
the	O
additional	O
file	O
.	O

Competing	O
interests	O

The	O
authors	O
declare	O
that	O
they	O
have	O
no	O
competing	O
interests	O
.	O

Authors	O
’	O
contributions	O

HC	O
developed	O
the	O
vectorized	O
Gene	O
Myers	O
’	O
bit	O
-	O
vector	O
algorithm	O
,	O
and	O
implemented	O
the	O
whole	O
software	O
.	O

HC	O
,	O
JY	O
and	O
YX	O
designed	O
the	O
strategies	O
in	O
the	O
software	O
.	O

HC	O
,	O
YX	O
and	O
YS	O
drafted	O
the	O
manuscript	O
.	O

HJ	O
tested	O
the	O
software	O
and	O
revised	O
the	O
bugs	O
of	O
it	O
.	O

All	O
authors	O
read	O
and	O
approved	O
the	O
final	O
manuscript	O
.	O


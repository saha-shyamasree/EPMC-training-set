The	O
Harvest	O
suite	O
for	O
rapid	O
core	O
-	O
genome	O
alignment	O
and	O
visualization	O
of	O
thousands	O
of	O
intraspecific	O
microbial	O
genomes	O

Whole	O
-	O
genome	O
sequences	O
are	O
now	O
available	O
for	O
many	O
microbial	O
species	O
and	O
clades	O
,	O
however	O
existing	O
whole	O
-	O
genome	O
alignment	O
methods	O
are	O
limited	O
in	O
their	O
ability	O
to	O
perform	O
sequence	O
comparisons	O
of	O
multiple	O
sequences	O
simultaneously	O
.	O

Here	O
we	O
present	O
the	O
Harvest	O
suite	O
of	O
core	O
-	O
genome	O
alignment	O
and	O
visualization	O
tools	O
for	O
the	O
rapid	O
and	O
simultaneous	O
analysis	O
of	O
thousands	O
of	O
intraspecific	O
microbial	O
strains	O
.	O

Harvest	O
includes	O
Parsnp	O
,	O
a	O
fast	O
core	O
-	O
genome	O
multi	O
-	O
aligner	O
,	O
and	O
Gingr	O
,	O
a	O
dynamic	O
visual	O
platform	O
.	O

Together	O
they	O
provide	O
interactive	O
core	O
-	O
genome	O
alignments	O
,	O
variant	O
calls	O
,	O
recombination	O
detection	O
,	O
and	O
phylogenetic	O
trees	O
.	O

Using	O
simulated	O
and	O
real	O
data	O
we	O
demonstrate	O
that	O
our	O
approach	O
exhibits	O
unrivaled	O
speed	O
while	O
maintaining	O
the	O
accuracy	O
of	O
existing	O
methods	O
.	O

The	O
Harvest	O
suite	O
is	O
open	O
-	O
source	O
and	O
freely	O
available	O
from	O
:	O
http	O
://	O
github	O
.	O
com	O
/	O
marbl	O
/	O
harvest	O
.	O

Electronic	O
supplementary	O
material	O

The	O
online	O
version	O
of	O
this	O
article	O
(	O
doi	O
:	O
10	O
.	O
1186	O
/	O
s13059	O
-	O
014	O
-	O
0524	O
-	O
x	O
)	O
contains	O
supplementary	O
material	O
,	O
which	O
is	O
available	O
to	O
authorized	O
users	O
.	O

Rationale	O

Microbial	O
genomes	O
represent	O
over	O
93	O
%	O
of	O
past	O
sequencing	O
projects	O
,	O
with	O
the	O
current	O
total	O
over	O
10	O
,	O
000	O
and	O
growing	O
exponentially	O
.	O

Multiple	O
clades	O
of	O
draft	O
and	O
complete	O
genomes	O
comprising	O
hundreds	O
of	O
closely	O
related	O
strains	O
are	O
now	O
available	O
from	O
public	O
databases	O
[	O
1	O
],	O
largely	O
due	O
to	O
an	O
increase	O
in	O
sequencing	O
-	O
based	O
outbreak	O
studies	O
[	O
2	O
].	O

The	O
quality	O
of	O
future	O
genomes	O
is	O
also	O
set	O
to	O
improve	O
as	O
short	O
-	O
read	O
assemblers	O
mature	O
[	O
3	O
]	O
and	O
long	O
-	O
read	O
sequencing	O
enables	O
finishing	O
at	O
greatly	O
reduced	O
costs	O
[	O
4	O
,	O
5	O
].	O

One	O
direct	O
benefit	O
of	O
high	O
-	O
quality	O
genomes	O
is	O
that	O
they	O
empower	O
comparative	O
genomic	O
studies	O
based	O
on	O
multiple	O
genome	O
alignment	O
.	O

Multiple	O
genome	O
alignment	O
is	O
a	O
fundamental	O
tool	O
in	O
genomics	O
essential	O
for	O
tracking	O
genome	O
evolution	O
[	O
6	O
–	O
8	O
],	O
accurate	O
inference	O
of	O
recombination	O
[	O
9	O
–	O
14	O
],	O
identification	O
of	O
genomic	O
islands	O
[	O
15	O
,	O
16	O
],	O
analysis	O
of	O
mobile	O
genetic	O
elements	O
[	O
17	O
,	O
18	O
],	O
comprehensive	O
classification	O
of	O
homology	O
[	O
19	O
,	O
20	O
],	O
ancestral	O
genome	O
reconstruction	O
[	O
21	O
],	O
and	O
phylogenomic	O
analyses	O
[	O
22	O
–	O
24	O
].	O

The	O
task	O
of	O
whole	O
-	O
genome	O
alignment	O
is	O
to	O
create	O
a	O
catalog	O
of	O
relationships	O
between	O
the	O
sequences	O
of	O
each	O
genome	O
(	O
ortholog	O
,	O
paralog	O
,	O
xenolog	O
,	O
and	O
so	O
on	O
[	O
25	O
])	O
to	O
reveal	O
their	O
evolutionary	O
history	O
[	O
26	O
,	O
27	O
].	O

While	O
several	O
tools	O
exist	O
(	O
LS	O
-	O
BSR	O
[	O
28	O
],	O
Magic	O
[	O
29	O
],	O
Mavid	O
[	O
30	O
],	O
Mauve	O
[	O
31	O
–	O
33	O
],	O
MGA	O
[	O
34	O
],	O
M	O
-	O
GCAT	O
[	O
35	O
],	O
Mugsy	O
[	O
36	O
],	O
TBA	O
[	O
37	O
],	O
multi	O
-	O
LAGAN	O
[	O
38	O
],	O
PECAN	O
[	O
39	O
]),	O
multiple	O
genome	O
alignment	O
remains	O
a	O
challenging	O
task	O
due	O
to	O
the	O
prevalence	O
of	O
horizontal	O
gene	O
transfer	O
[	O
26	O
,	O
40	O
],	O
recombination	O
,	O
homoplasy	O
,	O
gene	O
conversion	O
,	O
mobile	O
genetic	O
elements	O
,	O
pseudogenization	O
,	O
and	O
convoluted	O
orthology	O
relationships	O
[	O
25	O
].	O

In	O
addition	O
,	O
the	O
computational	O
burden	O
of	O
multiple	O
sequence	O
alignment	O
remains	O
very	O
high	O
[	O
41	O
]	O
despite	O
recent	O
progress	O
[	O
42	O
].	O

The	O
current	O
influx	O
of	O
microbial	O
sequencing	O
data	O
necessitates	O
methods	O
for	O
large	O
-	O
scale	O
comparative	O
genomics	O
and	O
shifts	O
the	O
focus	O
towards	O
scalability	O
.	O

Current	O
microbial	O
genome	O
alignment	O
methods	O
focus	O
on	O
all	O
-	O
versus	O
-	O
all	O
progressive	O
alignment	O
[	O
31	O
,	O
36	O
]	O
to	O
detect	O
subset	O
relationships	O
(	O
that	O
is	O
,	O
gene	O
gain	O
/	O
loss	O
),	O
but	O
these	O
methods	O
are	O
bounded	O
at	O
various	O
steps	O
by	O
quadratic	O
time	O
complexity	O
.	O

This	O
exponential	O
growth	O
in	O
compute	O
time	O
prohibits	O
comparisons	O
involving	O
thousands	O
of	O
genomes	O
.	O

Chan	O
and	O
Ragan	O
[	O
43	O
]	O
reiterated	O
this	O
point	O
,	O
emphasizing	O
that	O
current	O
phylogenomic	O
methods	O
,	O
such	O
as	O
multiple	O
alignment	O
,	O
will	O
not	O
scale	O
with	O
the	O
increasing	O
number	O
of	O
genomes	O
,	O
and	O
that	O
‘	O
alignment	O
-	O
free	O
’	O
or	O
exact	O
alignment	O
methods	O
must	O
be	O
used	O
to	O
analyze	O
such	O
datasets	O
.	O

However	O
,	O
such	O
approaches	O
do	O
not	O
come	O
without	O
compromising	O
phylogenetic	O
resolution	O
[	O
44	O
].	O

Core	O
-	O
genome	O
alignment	O
is	O
a	O
subset	O
of	O
whole	O
-	O
genome	O
alignment	O
,	O
focused	O
on	O
identifying	O
the	O
set	O
of	O
orthologous	O
sequence	O
conserved	O
in	O
all	O
aligned	O
genomes	O
.	O

In	O
contrast	O
to	O
the	O
exponential	O
complexity	O
of	O
multiple	O
alignment	O
,	O
core	O
-	O
genome	O
alignment	O
is	O
inherently	O
more	O
scalable	O
because	O
it	O
ignores	O
subset	O
relationships	O
.	O

In	O
addition	O
,	O
the	O
core	O
genome	O
contains	O
essential	O
genes	O
that	O
are	O
often	O
vertically	O
inherited	O
and	O
most	O
likely	O
to	O
have	O
the	O
strongest	O
signal	O
-	O
to	O
-	O
noise	O
ratio	O
for	O
inferring	O
phylogeny	O
.	O

The	O
most	O
reliable	O
variants	O
for	O
building	O
such	O
phylogenies	O
are	O
single	O
-	O
nucleotide	O
polymorphisms	O
(	O
SNPs	O
).	O

Thus	O
,	O
core	O
-	O
genome	O
SNP	O
typing	O
is	O
currently	O
the	O
standard	O
method	O
for	O
reconstructing	O
large	O
phylogenies	O
of	O
closely	O
related	O
microbes	B-OG
[	O
45	O
].	O

Currently	O
,	O
there	O
are	O
three	O
paradigms	O
for	O
core	O
-	O
genome	O
SNP	O
typing	O
based	O
on	O
read	O
mapping	O
,	O
k	O
-	O
mer	O
analyses	O
,	O
and	O
whole	O
-	O
genome	O
alignment	O
.	O

Read	O
-	O
based	O
methods	O
have	O
dominated	O
the	O
bioinformatics	O
methods	O
landscape	O
since	O
the	O
invention	O
of	O
high	O
-	O
fidelity	O
,	O
short	O
-	O
read	O
sequencing	O
(	O
50	O
to	O
300	O
bp	O
)	O
[	O
46	O
].	O

This	O
has	O
made	O
it	O
very	O
affordable	O
to	O
sequence	O
,	O
yet	O
extremely	O
challenging	O
to	O
produce	O
finished	O
genomes	O
[	O
47	O
,	O
48	O
].	O

Thus	O
,	O
comparative	O
genomics	O
has	O
turned	O
to	O
highly	O
efficient	O
and	O
accurate	O
read	O
mapping	O
algorithms	O
to	O
carry	O
out	O
assembly	O
-	O
free	O
analyses	O
,	O
spawning	O
many	O
mapping	O
tools	O
[	O
49	O
–	O
52	O
]	O
and	O
variant	O
callers	O
[	O
53	O
–	O
55	O
]	O
for	O
detecting	O
SNPs	O
and	O
short	O
Indels	O
.	O

Read	O
-	O
based	O
variant	O
calling	O
typically	O
utilizes	O
a	O
finished	O
reference	O
genome	O
and	O
a	O
sensitive	O
read	O
mapper	O
(	O
BWA	O
[	O
51	O
],	O
Smalt	O
),	O
variant	O
caller	O
(	O
samtools	O
/	O
bcftools	O
[	O
55	O
],	O
GATK	O
[	O
53	O
]),	O
and	O
variant	O
filter	O
(	O
minimum	O
mapping	O
quality	O
,	O
core	O
genomic	O
regions	O
).	O

This	O
method	O
has	O
been	O
shown	O
effective	O
in	O
practice	O
[	O
56	O
]	O
and	O
does	O
not	O
rely	O
on	O
assembly	O
.	O

However	O
,	O
mapping	O
requires	O
the	O
read	O
data	O
,	O
which	O
is	O
not	O
always	O
available	O
and	O
can	O
be	O
orders	O
of	O
magnitude	O
larger	O
than	O
the	O
genomes	O
themselves	O
.	O

In	O
addition	O
,	O
mapping	O
can	O
be	O
sensitive	O
to	O
contaminant	O
,	O
overlook	O
structural	O
variation	O
,	O
misalign	O
low	O
-	O
complexity	O
and	O
repetitive	O
sequence	O
,	O
and	O
introduce	O
systematic	O
bias	O
in	O
phylogenetic	O
reconstruction	O
[	O
57	O
–	O
59	O
].	O

Exact	O
alignment	O
methods	O
,	O
often	O
formulated	O
as	O
k	O
-	O
mer	O
matching	O
,	O
can	O
produce	O
high	O
precision	O
results	O
in	O
a	O
fraction	O
of	O
the	O
time	O
required	O
for	O
gapped	O
alignment	O
methods	O
[	O
60	O
–	O
62	O
].	O

Spectral	O
k	O
-	O
mer	O
approaches	O
have	O
been	O
used	O
to	O
estimate	O
genome	O
similarity	O
[	O
63	O
],	O
and	O
k	O
-	O
mer	O
based	O
methods	O
are	O
commonly	O
used	O
to	O
identify	O
or	O
cluster	O
homologous	O
genomic	O
sequence	O
[	O
64	O
,	O
65	O
].	O

Recently	O
,	O
k	O
-	O
mers	O
have	O
also	O
been	O
extended	O
to	O
SNP	O
identification	O
.	O

kSNP	O
[	O
66	O
]	O
identifies	O
odd	O
-	O
length	O
k	O
-	O
mers	O
between	O
multiple	O
samples	O
that	O
match	O
at	O
all	O
but	O
the	O
central	O
position	O
.	O

The	O
matched	O
k	O
-	O
mers	O
are	O
then	O
mapped	O
back	O
to	O
a	O
reference	O
genome	O
to	O
locate	O
putative	O
SNPs	O
.	O

Conveniently	O
,	O
this	O
approach	O
is	O
suitable	O
for	O
both	O
assembled	O
genomes	O
and	O
read	O
sets	O
,	O
but	O
sensitivity	O
is	O
sacrificed	O
for	O
the	O
improved	O
efficiency	O
of	O
exact	O
alignment	O
[	O
67	O
].	O

Genome	O
assembly	O
[	O
4	O
,	O
68	O
–	O
75	O
],	O
followed	O
by	O
whole	O
-	O
genome	O
alignment	O
[	O
38	O
,	O
76	O
,	O
77	O
],	O
is	O
the	O
original	O
method	O
for	O
variant	O
detection	O
between	O
closely	O
related	O
bacterial	O
genomes	O
[	O
78	O
]	O
and	O
has	O
been	O
shown	O
to	O
perform	O
well	O
across	O
multiple	O
sequencing	O
platforms	O
[	O
79	O
].	O

In	O
addition	O
to	O
SNPs	O
,	O
whole	O
-	O
genome	O
alignment	O
is	O
able	O
to	O
reliably	O
identify	O
insertions	O
and	O
deletions	O
(	O
Indels	O
)	O
and	O
other	O
forms	O
of	O
structural	O
variation	O
.	O

Thus	O
,	O
whole	O
-	O
genome	O
alignment	O
is	O
the	O
gold	O
standard	O
for	O
comprehensive	O
variant	O
identification	O
,	O
but	O
relies	O
on	O
highly	O
accurate	O
and	O
continuous	O
assemblies	O
,	O
which	O
can	O
be	O
expensive	O
to	O
generate	O
.	O

Lastly	O
,	O
and	O
unlike	O
reference	O
mapping	O
,	O
whole	O
-	O
genome	O
alignment	O
is	O
not	O
easily	O
parallelized	O
or	O
scaled	O
to	O
many	O
genomes	O
.	O

Specifically	O
for	O
the	O
task	O
of	O
whole	O
-	O
genome	O
SNP	O
typing	O
,	O
the	O
choice	O
of	O
read	O
-	O
or	O
genome	O
-	O
based	O
methods	O
can	O
often	O
depend	O
on	O
data	O
availability	O
.	O

For	O
example	O
,	O
of	O
the	O
24	O
,	O
000	O
bacterial	O
genomes	O
currently	O
in	O
NCBI	O
RefSeq	O
[	O
80	O
],	O
only	O
55	O
%	O
have	O
associated	O
SRA	O
read	O
data	O
and	O
analysis	O
of	O
the	O
remaining	O
45	O
%	O
requires	O
genome	O
-	O
based	O
methods	O
.	O

Thankfully	O
,	O
recent	O
advances	O
in	O
both	O
sequencing	O
technology	O
and	O
assembly	O
algorithms	O
are	O
making	O
microbial	O
genomes	O
more	O
complete	O
than	O
ever	O
before	O
.	O

Modern	O
de	O
Bruijn	O
assemblers	O
like	O
SPAdes	O
[	O
81	O
]	O
are	O
able	O
to	O
generate	O
high	O
-	O
quality	O
assemblies	O
from	O
short	O
reads	O
[	O
3	O
],	O
and	O
long	O
read	O
technologies	O
have	O
enabled	O
the	O
automated	O
finishing	O
of	O
microbial	O
genomes	O
for	O
under	O
$	O
1	O
,	O
000	O
[	O
82	O
].	O

With	O
the	O
number	O
of	O
publically	O
available	O
genomes	O
currently	O
doubling	O
every	O
18	O
months	O
[	O
1	O
],	O
and	O
genome	O
quality	O
improving	O
with	O
the	O
arrival	O
of	O
new	O
technologies	O
,	O
we	O
set	O
out	O
to	O
solve	O
the	O
problem	O
of	O
aligning	O
thousands	O
of	O
closely	O
-	O
related	O
whole	O
genomes	O
.	O

Rapid	O
core	O
-	O
genome	O
alignment	O
and	O
visualization	O

Here	O
we	O
present	O
Parsnp	O
and	O
Gingr	O
for	O
the	O
construction	O
and	O
interactive	O
visualization	O
of	O
massive	O
core	O
-	O
genome	O
alignments	O
.	O

For	O
alignment	O
,	O
Parsnp	O
combines	O
the	O
advantages	O
of	O
both	O
whole	O
-	O
genome	O
alignment	O
and	O
read	O
mapping	O
.	O

Like	O
whole	O
-	O
genome	O
alignment	O
,	O
Parsnp	O
accurately	O
aligns	O
microbial	O
genomes	O
to	O
identify	O
both	O
structural	O
and	O
point	O
variations	O
,	O
but	O
like	O
read	O
mapping	O
,	O
Parsnp	O
scales	O
to	O
thousands	O
of	O
closely	O
related	O
genomes	O
.	O

To	O
achieve	O
this	O
scalability	O
,	O
Parsnp	O
is	O
based	O
on	O
a	O
suffix	O
graph	O
data	O
structure	O
for	O
the	O
rapid	O
identification	O
of	O
maximal	O
unique	O
matches	O
(	O
MUMs	O
),	O
which	O
serve	O
as	O
a	O
common	O
foundation	O
to	O
many	O
pairwise	O
[	O
76	O
,	O
77	O
,	O
83	O
]	O
and	O
multiple	O
genome	O
alignment	O
tools	O
[	O
31	O
–	O
36	O
].	O

Parsnp	O
uses	O
MUMs	O
to	O
both	O
recruit	O
similar	O
genomes	O
and	O
anchor	O
the	O
multiple	O
alignment	O
.	O

As	O
input	O
,	O
Parsnp	O
takes	O
a	O
directory	O
of	O
MultiFASTA	O
files	O
to	O
be	O
aligned	O
;	O
and	O
as	O
output	O
,	O
Parsnp	O
produces	O
a	O
core	O
-	O
genome	O
alignment	O
,	O
variant	O
calls	O
,	O
and	O
a	O
SNP	O
tree	O
.	O

These	O
outputs	O
can	O
then	O
be	O
visually	O
explored	O
using	O
Gingr	O
.	O

The	O
details	O
of	O
Parsnp	O
and	O
Gingr	O
are	O
described	O
below	O
.	O

MUMi	O
recruitment	O

Parsnp	O
is	O
designed	O
for	O
intraspecific	O
alignments	O
and	O
requires	O
input	O
genomes	O
to	O
be	O
highly	O
similar	O
(	O
for	O
example	O
,	O
within	O
the	O
same	O
subspecies	O
group	O
or	O
>	O
=	O
97	O
%	O
average	O
nucleotide	O
identity	O
).	O

For	O
novel	O
genomes	O
or	O
an	O
inaccurate	O
taxonomy	O
,	O
which	O
genomes	O
meet	O
this	O
criterion	O
is	O
not	O
always	O
known	O
.	O

To	O
automatically	O
identify	O
genomes	O
suitable	O
for	O
alignment	O
,	O
Parsnp	O
uses	O
a	O
recruitment	O
strategy	O
based	O
on	O
the	O
MUMi	O
distance	O
[	O
84	O
].	O

Only	O
genomes	O
within	O
a	O
specified	O
MUMi	O
distance	O
threshold	O
are	O
recruited	O
into	O
the	O
full	O
alignment	O
.	O

Compressed	O
suffix	O
graph	O

Parsnp	O
utilizes	O
a	O
Directed	O
Acyclic	O
Graph	O
(	O
DAG	O
)	O
data	O
structure	O
,	O
called	O
a	O
Compressed	O
Suffix	O
Graph	O
(	O
CSG	O
),	O
to	O
index	O
the	O
reference	O
genome	O
for	O
efficient	O
identification	O
of	O
multi	O
-	O
MUMs	O
.	O

CSGs	O
have	O
the	O
unique	O
property	O
of	O
representing	O
an	O
optimally	O
compressed	O
structure	O
,	O
in	O
terms	O
of	O
number	O
of	O
nodes	O
and	O
edges	O
,	O
while	O
maintaining	O
all	O
intrinsic	O
properties	O
of	O
a	O
Suffix	O
Tree	O
.	O

CSGs	O
were	O
originally	O
proposed	O
as	O
a	O
more	O
space	O
-	O
efficient	O
alternative	O
to	O
Suffix	O
Trees	O
and	O
first	O
implemented	O
in	O
M	O
-	O
GCAT	O
[	O
35	O
].	O

Node	O
and	O
edge	O
compression	O
of	O
the	O
Suffix	O
Tree	O
incurs	O
a	O
linear	O
-	O
time	O
construction	O
penalty	O
,	O
but	O
facilitates	O
faster	O
traversal	O
of	O
the	O
structure	O
once	O
built	O
.	O

Provided	O
sufficient	O
memory	O
,	O
the	O
CSG	O
can	O
be	O
used	O
to	O
align	O
genomes	O
of	O
any	O
size	O
;	O
however	O
,	O
the	O
current	O
implementation	O
has	O
been	O
optimized	O
for	O
microbial	O
genomes	O
,	O
requiring	O
approximately	O
32	O
bytes	O
per	O
reference	O
base	O
for	O
CSG	O
construction	O
and	O
15	O
bytes	O
per	O
base	O
for	O
the	O
aligned	O
genomes	O
.	O

Note	O
that	O
because	O
multi	O
-	O
MUMs	O
are	O
necessarily	O
present	O
in	O
all	O
genomes	O
,	O
the	O
choice	O
of	O
a	O
reference	O
genome	O
has	O
no	O
effect	O
on	O
the	O
resulting	O
alignment	O
.	O

Multi	O
-	O
MUM	O
search	O

Once	O
built	O
for	O
the	O
reference	O
genome	O
,	O
all	O
additional	O
genomes	O
are	O
streamed	O
through	O
the	O
CSG	O
,	O
enabling	O
rapid	O
,	O
linear	O
-	O
time	O
identification	O
of	O
MUMs	O
shared	O
across	O
all	O
genomes	O
.	O

A	O
divide	O
-	O
and	O
-	O
conquer	O
algorithm	O
,	O
adapted	O
from	O
M	O
-	O
GCAT	O
[	O
35	O
],	O
recursively	O
searches	O
for	O
smaller	O
matches	O
and	O
iteratively	O
refines	O
the	O
multi	O
-	O
MUMs	O
.	O

Next	O
,	O
locally	O
collinear	O
blocks	O
(	O
LCBs	O
)	O
of	O
multi	O
-	O
MUMs	O
are	O
identified	O
.	O

These	O
LCBs	O
form	O
the	O
basis	O
of	O
the	O
core	O
-	O
genome	O
alignment	O
.	O

Parallelized	O
LCB	O
alignment	O

The	O
multi	O
-	O
MUMs	O
within	O
LCBs	O
are	O
used	O
to	O
anchor	O
multiple	O
alignments	O
.	O

Gaps	O
between	O
collinear	O
multi	O
-	O
MUMs	O
are	O
aligned	O
in	O
parallel	O
using	O
MUSCLE	O
[	O
85	O
].	O

To	O
avoid	O
the	O
unnecessary	O
overhead	O
of	O
reading	O
and	O
writing	O
MultiFASTA	O
alignment	O
files	O
,	O
Parsnp	O
makes	O
direct	O
library	O
calls	O
via	O
a	O
MUSCLE	O
API	O
.	O

The	O
MUSCLE	O
library	O
is	O
packaged	O
with	O
Parsnp	O
,	O
but	O
originally	O
sourced	O
from	O
the	O
Mauve	O
code	O
base	O
[	O
86	O
].	O

As	O
with	O
Mauve	O
,	O
MUSCLE	O
is	O
used	O
to	O
compute	O
an	O
accurate	O
gapped	O
alignment	O
between	O
the	O
match	O
anchors	O
.	O

Though	O
MUSCLE	O
alignment	O
can	O
be	O
computationally	O
expensive	O
,	O
for	O
highly	O
similar	O
genomes	O
,	O
the	O
gaps	O
between	O
collinear	O
multi	O
-	O
MUMs	O
are	O
typically	O
very	O
short	O
(	O
for	O
example	O
,	O
a	O
single	O
SNP	O
column	O
in	O
the	O
degenerate	O
case	O
).	O

SNP	O
filtering	O
and	O
trees	O

The	O
final	O
Parsnp	O
multiple	O
alignment	O
contains	O
all	O
SNP	O
,	O
Indel	O
,	O
and	O
structural	O
variation	O
within	O
the	O
core	O
genome	O
.	O

However	O
,	O
given	O
their	O
ubiquity	O
in	O
microbial	O
genome	O
analyses	O
,	O
Parsnp	O
performs	O
additional	O
processing	O
of	O
the	O
core	O
-	O
genome	O
SNPs	O
.	O

First	O
,	O
all	O
polymorphic	O
columns	O
in	O
the	O
multiple	O
alignment	O
are	O
flagged	O
to	O
identify	O
:	O
(	O
1	O
)	O
repetitive	O
sequence	O
;	O
(	O
2	O
)	O
small	O
LCB	O
size	O
;	O
(	O
3	O
)	O
poor	O
alignment	O
quality	O
;	O
(	O
4	O
)	O
poor	O
base	O
quality	O
;	O
and	O
(	O
5	O
)	O
possible	O
recombination	O
.	O

Alignment	O
quality	O
is	O
determined	O
by	O
a	O
threshold	O
of	O
the	O
number	O
of	O
SNPs	O
and	O
Indels	O
contained	O
within	O
a	O
given	O
window	O
size	O
.	O

Base	O
quality	O
is	O
optionally	O
determined	O
using	O
FreeBayes	O
[	O
54	O
]	O
to	O
measure	O
read	O
support	O
and	O
mixed	O
alleles	O
.	O

Bases	O
likely	O
to	O
have	O
undergone	O
recent	O
recombination	O
are	O
identified	O
using	O
PhiPack	O
[	O
87	O
].	O

Only	O
columns	O
passing	O
a	O
set	O
of	O
filters	O
based	O
on	O
these	O
criteria	O
are	O
considered	O
reliable	O
core	O
-	O
genome	O
SNPs	O
.	O

The	O
final	O
set	O
of	O
core	O
-	O
genome	O
SNPs	O
is	O
given	O
to	O
FastTree2	O
[	O
88	O
]	O
for	O
reconstruction	O
of	O
the	O
whole	O
-	O
genome	O
phylogeny	O
.	O

Compressed	O
alignment	O
file	O

For	O
simplicity	O
and	O
storage	O
efficiency	O
,	O
the	O
output	O
of	O
Parsnp	O
includes	O
a	O
single	O
binary	O
file	O
encoding	O
the	O
reference	O
genome	O
,	O
annotations	O
,	O
alignment	O
,	O
variants	O
,	O
and	O
tree	O
.	O

Thousand	O
-	O
fold	O
compression	O
of	O
the	O
alignment	O
is	O
achieved	O
by	O
storing	O
only	O
the	O
columns	O
that	O
contain	O
variants	O
.	O

The	O
full	O
multiple	O
alignment	O
can	O
be	O
faithfully	O
reconstructed	O
from	O
this	O
reference	O
-	O
compressed	O
representation	O
on	O
demand	O
.	O

Since	O
Parsnp	O
focuses	O
on	O
aligning	O
only	O
core	O
blocks	O
of	O
relatively	O
similar	O
genomes	O
,	O
the	O
number	O
of	O
variant	O
columns	O
tends	O
to	O
increase	O
at	O
a	O
sub	O
-	O
linear	O
rate	O
as	O
the	O
number	O
of	O
genomes	O
increases	O
,	O
resulting	O
in	O
huge	O
space	O
savings	O
versus	O
alternative	O
multiple	O
alignment	O
formats	O
.	O

Conversion	O
utilities	O
are	O
provided	O
for	O
importing	O
/	O
exporting	O
common	O
formats	O
to	O
/	O
from	O
the	O
binary	O
archive	O
file	O
,	O
including	O
:	O
BED	O
,	O
GenBank	O
,	O
FASTA	O
,	O
MAF	O
,	O
Newick	O
,	O
VCF	O
,	O
and	O
XMFA	O
.	O

Interactive	O
visualization	O

Developed	O
in	O
tandem	O
with	O
Parsnp	O
,	O
the	O
visualization	O
tool	O
Gingr	O
allows	O
for	O
interactive	O
exploration	O
of	O
trees	O
and	O
alignments	O
.	O

In	O
addition	O
to	O
the	O
compressed	O
alignment	O
format	O
,	O
Gingr	O
accepts	O
standard	O
alignment	O
formats	O
and	O
can	O
serve	O
as	O
a	O
general	O
-	O
purpose	O
multiple	O
alignment	O
viewer	O
.	O

Uniquely	O
,	O
Gingr	O
is	O
capable	O
of	O
providing	O
dynamic	O
exploration	O
of	O
alignments	O
comprising	O
thousands	O
of	O
genomes	O
and	O
millions	O
of	O
alignment	O
columns	O
.	O

It	O
is	O
the	O
first	O
tool	O
of	O
its	O
kind	O
capable	O
of	O
dynamically	O
visualizing	O
multiple	O
alignments	O
of	O
this	O
scale	O
.	O

The	O
alignment	O
can	O
be	O
seamlessly	O
zoomed	O
from	O
a	O
display	O
of	O
variant	O
density	O
(	O
at	O
the	O
genome	O
level	O
)	O
to	O
a	O
full	O
representation	O
of	O
the	O
multiple	O
alignment	O
(	O
at	O
the	O
nucleotide	O
level	O
).	O

For	O
exploration	O
of	O
phyletic	O
patterns	O
,	O
the	O
alignment	O
is	O
simultaneously	O
presented	O
along	O
with	O
the	O
core	O
-	O
genome	O
SNP	O
tree	O
,	O
annotations	O
,	O
and	O
dynamic	O
variant	O
highlighting	O
.	O

The	O
tree	O
can	O
be	O
zoomed	O
by	O
clade	O
,	O
or	O
individual	O
genomes	O
selected	O
to	O
expand	O
via	O
a	O
fisheye	O
zoom	O
.	O

Structural	O
variation	O
across	O
the	O
genome	O
can	O
also	O
be	O
displayed	O
using	O
Sybil	O
coloring	O
[	O
89	O
],	O
where	O
a	O
color	O
gradient	O
represents	O
the	O
location	O
and	O
orientation	O
of	O
each	O
LCB	O
with	O
respect	O
to	O
the	O
reference	O
.	O

This	O
is	O
useful	O
for	O
identifying	O
structurally	O
variant	O
regions	O
of	O
the	O
core	O
.	O

Evaluation	O
of	O
performance	O

We	O
evaluated	O
Parsnp	O
on	O
three	O
simulated	O
datasets	O
(	O
derived	O
from	O
Escherichia	B-OG
coli	I-OG
(	B-OG
E	I-OG
.	I-OG
coli	I-OG
)	I-OG
K	I-OG
-	I-OG
12	I-OG
W3110	I-OG
)	O
and	O
three	O
real	O
datasets	O
(	O
Streptococcus	B-OG
pneumoniae	I-OG
,	O
Peptoclostridium	B-OG
difficile	I-OG
,	O
and	O
Mycobacterium	B-OG
tuberculosis	I-OG
).	O

Parsnp	O
is	O
compared	O
below	O
versus	O
two	O
whole	O
-	O
genome	O
alignment	O
methods	O
(	O
Mugsy	O
,	O
Mauve	O
),	O
a	O
k	O
-	O
mer	O
based	O
method	O
(	O
kSNP	O
),	O
and	O
two	O
commonly	O
used	O
mapping	O
pipelines	O
(	O
based	O
on	O
Smalt	O
and	O
BWA	O
).	O

The	O
Smalt	O
pipeline	O
replicates	O
the	O
methods	O
of	O
the	O
landmark	O
Harris	O
et	O
al	O
.	O
paper	O
[	O
90	O
]	O
that	O
has	O
been	O
adopted	O
in	O
many	O
subsequent	O
studies	O
.	O

The	O
BWA	O
pipeline	O
is	O
similar	O
to	O
the	O
Smalt	O
pipeline	O
,	O
but	O
uses	O
BWA	O
for	O
read	O
mapping	O
(	O
Materials	O
and	O
methods	O
).	O

Simulated	O
E	B-OG
.	I-OG
coli	I-OG
W3110	I-OG
dataset	O

To	O
precisely	O
measure	O
the	O
accuracy	O
of	O
multiple	O
tools	O
across	O
varying	O
levels	O
of	O
divergence	O
,	O
we	O
computationally	O
evolved	O
the	O
genome	O
of	O
E	B-OG
.	I-OG
coli	I-OG
K	I-OG
-	I-OG
12	I-OG
W3110	I-OG
at	O
three	O
different	O
mutation	O
rates	O
:	O
0	O
.	O
00001	O
(	O
low	O
),	O
0	O
.	O
0001	O
(	O
medium	O
),	O
and	O
0	O
.	O
001	O
(	O
high	O
)	O
SNPs	O
per	O
site	O
,	O
per	O
branch	O
.	O

An	O
average	O
of	O
10	O
rearrangements	O
were	O
introduced	O
,	O
per	O
genome	O
.	O

Each	O
dataset	O
comprises	O
32	O
simulated	O
genomes	O
,	O
forming	O
a	O
perfect	O
binary	O
tree	O
.	O

Approximately	O
65X	O
coverage	O
of	O
Illumina	O
MiSeq	O
reads	O
was	O
simulated	O
and	O
assembled	O
for	O
each	O
genome	O
to	O
create	O
draft	O
assemblies	O
.	O

For	O
input	O
,	O
the	O
whole	O
-	O
genome	O
alignment	O
programs	O
were	O
given	O
the	O
draft	O
assemblies	O
,	O
and	O
the	O
mapping	O
pipelines	O
the	O
raw	O
reads	O
.	O

Additional	O
file	O
1	O
:	O
Figure	O
S1	O
details	O
the	O
computational	O
performance	O
on	O
the	O
simulated	O
datasets	O
.	O

Parsnp	O
was	O
the	O
only	O
method	O
to	O
finish	O
in	O
fewer	O
than	O
10	O
min	O
on	O
the	O
32	O
-	O
genome	O
dataset	O
,	O
with	O
the	O
other	O
methods	O
requiring	O
between	O
30	O
min	O
to	O
10	O
h	O
.	O

Table	O
1	O
gives	O
the	O
accuracy	O
of	O
each	O
tool	O
on	O
each	O
dataset	O
.	O

The	O
tools	O
were	O
benchmarked	O
using	O
true	O
-	O
positive	O
and	O
false	O
-	O
positive	O
rates	O
compared	O
to	O
a	O
known	O
truth	O
,	O
which	O
captures	O
the	O
full	O
alignment	O
accuracy	O
.	O

Figure	O
1	O
plots	O
the	O
performance	O
of	O
all	O
tools	O
averaged	O
across	O
all	O
mutation	O
rates	O
.	O
Table	O
1Core	O
-	O
genome	O
SNP	O
accuracy	O
for	O
simulated	O
E	B-OG
.	I-OG
coli	I-OG
datasets	O
Method	O
Description	O
a	O
FP	O
Low	O
FN	O
Low	O
FP	O
Med	O
FN	O
Med	O
FP	O
High	O
FN	O
High	O
TPR	O
FDR	O
Mauve	O
WGA	O
1483181982	O
,	O
87710030	O
,	O
3780	O
.	O
9740	O
.	O
0004Mauve	O
(	O
c	O
)	O
WGA	O
0023866490	O
.	O
9990Mugsy	O
WGA	O
1	O
,	O
261b	O
3951	O
,	O
9283	O
,	O
3711	O
,	O
33534	O
,	O
9230	O
.	O
9700	O
.	O
0036Mugsy	O
(	O
c	O
)	O
WGA	O
20201810	O
.	O
9990Parsnp	O
CGA	O
23423453	O
,	O
494735	O
,	O
4660	O
.	O
9700	O
.	O
0001Parsnp	O
(	O
c	O
)	O
CGA	O
0240603010	O
,	O
9890	O
.	O
9920kSNP	O
KMER	O
25960090819	O
,	O
7301	O
,	O
968916	O
,	O
1270	O
.	O
2800	O
.	O
0086Smalt	O
MAP	O
3311001	O
,	O
3075522	O
,	O
9570	O
.	O
9810	O
.	O
0001BWA	O
MAP	O
0168161	O
,	O
9472727	O
,	O
0910	O
.	O
97750	O
.	O
0000Data	O
shown	O
indicates	O
performance	O
metrics	O
of	O
the	O
evaluated	O
methods	O
on	O
the	O
three	O
simulated	O
E	B-OG
.	I-OG
coli	I-OG
datasets	O
(	O
low	O
,	O
medium	O
,	O
and	O
high	O
).	O

Method	O
:	O
Tool	O
used	O
.(	O
c	O
)	O
indicates	O
aligner	O
ran	O
on	O
closed	O
genomes	O
rather	O
than	O
draft	O
assemblies	O
.	O
False	O
positive	O
(	O
FP	O
)	O
and	O
false	O
negative	O
(	O
FN	O
)	O
counts	O
for	O
the	O
three	O
mutation	O
rates	O
(	O
low	O
,	O
med	O
,	O
and	O
high	O
).	O

True	O
positive	O
rate	O
TPR	O
:	O
TP	O
/(	O
TP	O
+	O
FN	O
).	O

False	O
discovery	O
rate	O
FDR	O
:	O
FP	O
/(	O
TP	O
+	O
FP	O
).	O

A	O
total	O
of	O
1	O
,	O
299	O
,	O
178	O
SNPs	O
were	O
introduced	O
into	O
the	O
32	O
-	O
genome	O
dataset	O
,	O
across	O
all	O
three	O
mutational	O
rates	O
.	O
aParadigm	O
employed	O
by	O
each	O
method	O
.	O
bMugsy	O
’	O
s	O
lower	O
precision	O
was	O
traced	O
to	O
a	O
paralog	O
misalignment	O
that	O
resulted	O
in	O
many	O
false	O
-	O
positive	O
SNPs	O
.	O
CGA	O
:	O
core	O
genome	O
alignment	O
,	O
FN	O
,	O
number	O
of	O
truth	O
SNP	O
calls	O
not	O
detected	O
,	O
FP	O
,	O
number	O
of	O
SNP	O
calls	O
that	O
are	O
not	O
in	O
truth	O
set	O
,	O
KMER	O
:	O
k	O
-	O
mer	O
based	O
SNP	O
calls	O
,	O
MAP	O
:	O
read	O
mapping	O
,	O
TP	O
:	O
number	O
of	O
SNP	O
calls	O
that	O
agreed	O
with	O
the	O
truth	O
,	O
WGA	O
:	O
whole	O
-	O
genome	O
alignment	O
.	O
Figure	O
1	O
Core	O
-	O
genome	O
SNP	O
accuracy	O
for	O
simulated	O
E	B-OG
.	I-OG
coli	I-OG
datasets	O
.	O
Results	O
are	O
averaged	O
across	O
low	O
,	O
medium	O
,	O
and	O
high	O
mutation	O
rates	O
.	O

Red	O
squares	O
denote	O
alignment	O
-	O
based	O
SNP	O
calls	O
on	O
draft	O
assemblies	O
,	O
green	O
squares	O
alignment	O
-	O
based	O
SNP	O
calls	O
on	O
closed	O
genomes	O
,	O
and	O
blue	O
triangles	O
for	O
read	O
mapping	O
.	O

Full	O
results	O
for	O
each	O
dataset	O
are	O
given	O
in	O
Table	O
1	O
.	O

The	O
whole	O
-	O
genome	O
alignment	O
methods	O
performed	O
comparably	O
across	O
all	O
three	O
mutation	O
rates	O
(	O
Figure	O
1	O
,	O
red	O
squares	O
),	O
with	O
Mauve	O
exhibiting	O
the	O
highest	O
sensitivity	O
(	O
97	O
.	O
42	O
%)	O
and	O
Parsnp	O
the	O
highest	O
precision	O
(	O
99	O
.	O
99	O
%).	O

In	O
addition	O
,	O
Parsnp	O
identified	O
98	O
%	O
the	O
rearrangement	O
breakpoints	O
within	O
1	O
%	O
of	O
the	O
rearrangement	O
length	O
(+/-	O
50	O
bp	O
)	O
with	O
no	O
breakpoint	O
spans	O
.	O

Mugsy	O
demonstrated	O
slightly	O
higher	O
sensitivity	O
than	O
Parsnp	O
but	O
with	O
lower	O
precision	O
.	O

Mugsy	O
’	O
s	O
lower	O
precision	O
was	O
traced	O
to	O
a	O
single	O
fumA	B-GP
paralog	O
[	O
91	O
]	O
misalignment	O
that	O
generated	O
a	O
high	O
number	O
of	O
false	O
-	O
positive	O
SNPs	O
.	O

All	O
genome	O
alignment	O
methods	O
were	O
affected	O
by	O
misalignment	O
of	O
repeats	O
and	O
missing	O
or	O
low	O
-	O
quality	O
bases	O
in	O
the	O
assembly	O
.	O

Performance	O
of	O
the	O
individual	O
methods	O
was	O
also	O
measured	O
in	O
terms	O
of	O
branch	O
SNP	O
and	O
length	O
error	O
with	O
respect	O
to	O
the	O
true	O
phylogeny	O
(	O
Figure	O
2	O
).	O

These	O
errors	O
closely	O
followed	O
the	O
false	O
-	O
negative	O
and	O
false	O
-	O
positive	O
rates	O
of	O
each	O
method	O
,	O
with	O
no	O
distinguishable	O
pattern	O
or	O
branch	O
biases	O
.	O

On	O
draft	O
genomes	O
,	O
precise	O
methods	O
such	O
as	O
Parsnp	O
yielded	O
underestimates	O
of	O
branch	O
lengths	O
while	O
more	O
aggressive	O
methods	O
like	O
Mugsy	O
resulted	O
in	O
more	O
overestimates	O
(	O
outliers	O
not	O
shown	O
).	O

The	O
aggressive	O
methods	O
also	O
showed	O
more	O
variance	O
in	O
performance	O
across	O
branches	O
.	O
Figure	O
2	O
Branch	O
errors	O
for	O
simulated	O
E	B-OG
.	I-OG
coli	I-OG
datasets	O
.	O
Simulated	O
E	B-OG
.	I-OG
coli	I-OG
trees	O
are	O
shown	O
for	O
medium	O
mutation	O
rate	O
(	O
0	O
.	O
0001	O
per	O
base	O
per	O
branch	O
).	O
(	O
A	O
)	O
shows	O
branch	O
length	O
errors	O
as	O
bars	O
,	O
with	O
overestimates	O
of	O
branch	O
length	O
above	O
each	O
branch	O
and	O
underestimates	O
below	O
each	O
branch	O
.	O

Maximum	O
overestimate	O
of	O
branch	O
length	O
was	O
2	O
.	O
15	O
%	O
(	O
bars	O
above	O
each	O
branch	O
)	O
and	O
maximum	O
underestimate	O
was	O
4	O
.	O
73	O
%	O
(	O
bars	O
below	O
each	O
branch	O
).	O
(	O
B	O
)	O
shows	O
branch	O
SNP	O
errors	O
as	O
bars	O
,	O
with	O
false	O
-	O
positive	O
errors	O
above	O
each	O
branch	O
and	O
false	O
-	O
negative	O
errors	O
below	O
each	O
branch	O
.	O

The	O
maximum	O
FP	O
SNP	O
value	O
is	O
6	O
(	O
bars	O
above	O
each	O
branch	O
)	O
and	O
maximum	O
FN	O
SNP	O
value	O
is	O
23	O
(	O
bars	O
below	O
each	O
branch	O
).	O

Note	O
that	O
the	O
bar	O
heights	O
have	O
been	O
normalized	O
by	O
the	O
maximum	O
value	O
for	O
each	O
tree	O
and	O
are	O
not	O
comparable	O
across	O
trees	O
.	O

Outlier	O
results	O
from	O
Mugsy	O
were	O
excluded	O
from	O
the	O
branch	O
length	O
plot	O
,	O
and	O
kSNP	O
results	O
are	O
not	O
shown	O
.	O

All	O
genome	O
alignment	O
methods	O
performed	O
similarly	O
on	O
closed	O
genomes	O
,	O
with	O
Mauve	O
and	O
Mugsy	O
exhibiting	O
the	O
best	O
sensitivity	O
(	O
Table	O
1	O
).	O

Comparison	O
on	O
closed	O
genomes	O

Mugsy	O
,	O
Mauve	O
,	O
and	O
Parsnp	O
all	O
performed	O
similarly	O
on	O
finished	O
genomes	O
(	O
Figures	O
1	O
and	O
2	O
,	O
green	O
squares	O
),	O
offering	O
a	O
significant	O
boost	O
in	O
sensitivity	O
over	O
both	O
draft	O
assemblies	O
and	O
reference	O
mapping	O
.	O

Mugsy	O
,	O
Mauve	O
,	O
and	O
Parsnp	O
all	O
exhibited	O
near	O
perfect	O
false	O
-	O
discovery	O
rates	O
(	O
FDR	O
),	O
with	O
Parsnp	O
being	O
the	O
only	O
method	O
to	O
not	O
report	O
a	O
single	O
false	O
positive	O
across	O
the	O
three	O
datasets	O
.	O

Both	O
Mauve	O
and	O
Mugsy	O
were	O
similarly	O
near	O
-	O
perfect	O
in	O
terms	O
of	O
true	O
-	O
positive	O
rates	O
(	O
TPR	O
).	O

The	O
drop	O
in	O
sensitivity	O
(	O
0	O
.	O
9	O
%)	O
for	O
Parsnp	O
on	O
full	O
genomes	O
can	O
be	O
explained	O
by	O
a	O
lack	O
of	O
an	O
LCB	O
extension	O
method	O
.	O

Mugsy	O
was	O
the	O
most	O
affected	O
by	O
draft	O
genomes	O
,	O
going	O
from	O
best	O
on	O
closed	O
genomes	O
to	O
demonstrating	O
more	O
false	O
positives	O
(	O
Table	O
1	O
)	O
and	O
LCB	O
counts	O
(	O
Table	O
2	O
)	O
on	O
draft	O
genomes	O
.	O

Parsnp	O
offered	O
the	O
overall	O
best	O
FDR	O
of	O
the	O
genome	O
alignment	O
methods	O
,	O
and	O
the	O
fewest	O
number	O
of	O
LCBs	O
,	O
averaged	O
across	O
both	O
draft	O
and	O
closed	O
genome	O
datasets	O
.	O
Table	O
2	O
Comparison	O
of	O
locally	O
collinear	O
alignment	O
block	O
(	O
LCB	O
)	O
count	O
for	O
simulated	O
E	B-OG
.	I-OG
coli	I-OG
datasets	O
,	O
on	O
assembled	O
and	O
finished	O
genomes	O
Method	O
Low	O
Medium	O
High	O
Mauve325363519Mauve	O
(	O
c	O
)	O
150174333Mugsy10	O
,	O
97711	O
,	O
19416	O
,	O
632Mugsy	O
(	O
c	O
)	O
237247351Parsnp205271344Parsnp	O
(	O
c	O
)	O
139190506Method	O
:	O
Tool	O
used	O
.(	O
c	O
)	O
indicates	O
aligner	O
ran	O
on	O
closed	O
genomes	O
rather	O
than	O
draft	O
assemblies	O
.	O
Low	O
:	O
>	O
99	O
.	O
99	O
%	O
similarity	O
,	O
Medium	O
:	O
>	O
99	O
.	O
9	O
%	O
similarity	O
,	O
High	O
:	O
>	O
99	O
%	O
similarity	O
.	O

Comparison	O
to	O
read	O
mapping	O
methods	O

On	O
average	O
,	O
mapping	O
-	O
based	O
methods	O
were	O
as	O
precise	O
and	O
0	O
.	O
5	O
%	O
to	O
1	O
%	O
more	O
sensitive	O
than	O
alignment	O
of	O
draft	O
genomes	O
(	O
Figure	O
1	O
,	O
blue	O
triangles	O
).	O

Smalt	O
showed	O
the	O
highest	O
sensitivity	O
,	O
while	O
BWA	O
was	O
the	O
most	O
specific	O
.	O

The	O
precision	O
of	O
the	O
mapping	O
approaches	O
may	O
be	O
overestimated	O
for	O
this	O
dataset	O
due	O
to	O
the	O
absence	O
of	O
non	O
-	O
core	O
sequence	O
that	O
is	O
known	O
to	O
confound	O
mapping	O
[	O
58	O
].	O

Parsnp	O
was	O
the	O
only	O
genome	O
alignment	O
method	O
to	O
match	O
the	O
precision	O
of	O
mapping	O
,	O
but	O
with	O
a	O
slight	O
reduction	O
in	O
sensitivity	O
.	O

However	O
,	O
when	O
provided	O
with	O
finished	O
genomes	O
,	O
the	O
whole	O
-	O
genome	O
alignment	O
methods	O
excel	O
in	O
both	O
sensitivity	O
and	O
specificity	O
compared	O
to	O
read	O
mapping	O
.	O

Thus	O
,	O
the	O
performance	O
divide	O
between	O
whole	O
-	O
genome	O
alignment	O
and	O
mapping	O
is	O
entirely	O
due	O
to	O
assembly	O
quality	O
and	O
completeness	O
.	O

Using	O
short	O
reads	O
,	O
both	O
the	O
mapping	O
and	O
assembly	O
-	O
based	O
approaches	O
suffer	O
false	O
negatives	O
due	O
to	O
ambiguous	O
mappings	O
or	O
collapsed	O
repeats	O
,	O
respectively	O
.	O

Exceeding	O
99	O
%	O
sensitivity	O
for	O
this	O
test	O
set	O
requires	O
either	O
longer	O
reads	O
(	O
for	O
mapping	O
)	O
or	O
complete	O
genomes	O
(	O
for	O
alignment	O
)	O
to	O
accurately	O
identify	O
SNPs	O
in	O
the	O
repetitive	O
regions	O
.	O

Comparison	O
on	O
31	O
Streptococcus	B-OG
pneumoniae	I-OG
genomes	O

Parsnp	O
was	O
compared	O
to	O
whole	O
-	O
genome	O
alignment	O
methods	O
using	O
the	O
31	O
-	O
genome	O
S	B-OG
.	I-OG
pneumoniae	I-OG
dataset	O
presented	O
in	O
the	O
original	O
Mugsy	O
publication	O
[	O
36	O
].	O

Angiuoli	O
and	O
Salzberg	O
compared	O
Mugsy	O
,	O
Mauve	O
,	O
and	O
Nucmer	O
+	O
TBA	O
to	O
measure	O
the	O
number	O
of	O
LCBs	O
and	O
size	O
of	O
the	O
core	O
genome	O
aligned	O
.	O

On	O
this	O
dataset	O
,	O
Parsnp	O
aligns	O
90	O
%	O
of	O
the	O
bases	O
aligned	O
by	O
Mugsy	O
,	O
while	O
using	O
50	O
%	O
fewer	O
LCBs	O
(	O
Table	O
3	O
).	O

In	O
addition	O
,	O
Parsnp	O
ran	O
hundreds	O
of	O
times	O
faster	O
than	O
the	O
other	O
methods	O
,	O
finishing	O
this	O
31	O
-	O
way	O
alignment	O
in	O
less	O
than	O
60	O
s	O
.	O
Table	O
3	O
Comparison	O
to	O
the	O
31	O
S	B-OG
.	I-OG
pneumoniae	I-OG
Mugsy	O
benchmark	O
Method	O
Time	O
Core	O
(	O
bp	O
)	O
LCBs	O
Parsnp0	O
.	O
3	O
min1	O
,	O
428	O
,	O
4071	O
,	O
171Mugsy100	O
min1	O
,	O
590	O
,	O
8202	O
,	O
394Mauve377	O
min1	O
,	O
568	O
,	O
7151	O
,	O
366NUCmer	O
+	O
TBA80	O
min1	O
,	O
457	O
,	O
57527	O
,	O
075Time	O
:	O
Method	O
runtime	O
from	O
input	O
to	O
output	O
.	O

Core	O
:	O
Size	O
of	O
the	O
aligned	O
core	O
genome	O
measured	O
in	O
base	O
pairs	O
.	O

LCBs	O
:	O
Number	O
of	O
locally	O
colinear	O
blocks	O
in	O
the	O
alignment	O
.	O

Peptoclostridium	B-OG
difficile	I-OG
outbreak	O
in	O
the	O
UK	O

Parsnp	O
and	O
Gingr	O
are	O
particularly	O
suited	O
for	O
outbreak	O
analyses	O
of	O
infectious	B-DS
diseases	I-DS
.	O

To	O
demonstrate	O
this	O
,	O
we	O
applied	O
Parsnp	O
to	O
a	O
recent	O
P	B-OG
.	I-OG
difficile	I-OG
outbreak	O
dataset	O
[	O
92	O
].	O

To	O
generate	O
input	O
suitable	O
for	O
Parsnp	O
,	O
we	O
assembled	O
all	O
genomes	O
using	O
iMetAMOS	O
[	O
93	O
].	O

It	O
is	O
important	O
to	O
note	O
that	O
this	O
was	O
a	O
resequencing	O
project	O
not	O
intended	O
for	O
assembly	O
and	O
represents	O
a	O
worst	O
case	O
for	O
a	O
core	O
-	O
genome	O
alignment	O
approach	O
;	O
reads	O
ranged	O
from	O
50	O
to	O
100	O
bp	O
in	O
length	O
and	O
some	O
genomes	O
were	O
sequenced	O
without	O
paired	O
ends	O
.	O

The	O
826	O
-	O
way	O
core	O
genome	O
alignment	O
resulted	O
in	O
1	O
.	O
4	O
Gbp	O
being	O
aligned	O
in	O
less	O
than	O
5	O
h	O
.	O

The	O
core	O
genome	O
represented	O
40	O
%	O
of	O
the	O
P	B-OG
.	I-OG
difficile	I-OG
630	O
reference	O
genome	O
,	O
consistent	O
with	O
previous	O
findings	O
[	O
94	O
].	O

Specifically	O
,	O
previous	O
microarray	O
experiments	O
have	O
indicated	O
that	O
39	O
%	O
of	O
the	O
total	O
CDS	O
in	O
the	O
evaluated	O
P	B-OG
.	I-OG
difficile	I-OG
clade	O
pertains	O
to	O
the	O
core	O
genome	O
(	O
1	O
%	O
less	O
than	O
identified	O
by	O
Parsnp	O
).	O

Figure	O
3	O
shows	O
a	O
Gingr	O
visualization	O
of	O
the	O
826	O
-	O
way	O
alignment	O
and	O
clade	O
phylogeny	O
.	O

Related	O
outbreak	O
clusters	O
are	O
immediately	O
visible	O
from	O
the	O
phyletic	O
patterns	O
of	O
the	O
alignment	O
,	O
confirming	O
the	O
primary	O
clades	O
of	O
the	O
tree	O
.	O

In	O
addition	O
,	O
the	O
SNP	O
heatmap	O
highlights	O
the	O
phyletic	O
signature	O
of	O
several	O
subclades	O
,	O
in	O
this	O
case	O
within	O
the	O
known	O
hpdBCA	O
operon	O
[	O
95	O
]	O
that	O
is	O
extremely	O
well	O
conserved	O
across	O
all	O
826	O
genomes	O
.	O
Figure	O
3	O
Gingr	O
visualization	O
of	O
826	O
P	B-OG
.	I-OG
difficile	I-OG
genomes	O
aligned	O
with	O
Parsnp	O
.	O
The	O
leaves	O
of	O
the	O
reconstructed	O
phylogenetic	O
tree	O
(	O
left	O
)	O
are	O
paired	O
with	O
their	O
corresponding	O
rows	O
in	O
the	O
multi	O
-	O
alignment	O
.	O

A	O
genome	O
has	O
been	O
selected	O
(	O
rectangular	O
aqua	O
highlight	O
),	O
resulting	O
in	O
a	O
fisheye	O
zoom	O
of	O
several	O
leaves	O
and	O
their	O
rows	O
.	O

A	O
SNP	O
density	O
plot	O
(	O
center	O
)	O
reveals	O
the	O
phylogenetic	O
signature	O
of	O
several	O
clades	O
,	O
in	O
this	O
case	O
within	O
the	O
fully	O
-	O
aligned	O
hpd	B-GP
operon	O
(	O
hpdB	B-GP
,	O
hpdC	B-GP
,	O
hpdA	B-GP
).	O

The	O
light	O
gray	O
regions	O
flanking	O
the	O
operon	O
indicate	O
unaligned	O
sequence	O
.	O

When	O
fully	O
zoomed	O
(	O
right	O
),	O
individual	O
bases	O
and	O
SNPs	O
can	O
be	O
inspected	O
.	O

Figure	O
4	O
shows	O
a	O
zoomed	O
view	O
of	O
the	O
826	O
P	B-OG
.	I-OG
difficile	I-OG
genome	O
alignment	O
in	O
Gingr	O
,	O
highlighting	O
a	O
single	O
annotated	O
gene	O
.	O

Although	O
no	O
metadata	O
is	O
publically	O
available	O
for	O
this	O
outbreak	O
dataset	O
,	O
we	O
identified	O
that	O
bacA	B-GP
,	O
a	O
gene	O
conferring	O
antibiotic	O
resistance	O
to	O
bacitracin	O
,	O
is	O
conserved	O
in	O
all	O
826	O
isolates	O
.	O

While	O
alternative	O
antibiotic	O
treatments	O
for	O
P	B-DS
.	I-DS
difficile	I-DS
infections	I-DS
have	O
been	O
well	O
-	O
studied	O
over	O
the	O
past	O
20	O
to	O
30	O
years	O
[	O
96	O
],	O
a	O
recent	O
study	O
reported	O
that	O
100	O
%	O
of	O
276	O
clinical	O
isolates	O
had	O
high	O
-	O
level	O
resistance	O
to	O
bacitracin	O
[	O
97	O
].	O

In	O
concordance	O
with	O
this	O
study	O
,	O
our	O
results	O
indicate	O
there	O
may	O
be	O
widespread	O
bacitracin	O
resistance	O
across	O
this	O
outbreak	O
dataset	O
.	O

Thus	O
alternative	O
antibiotics	O
,	O
such	O
as	O
vancomycin	O
,	O
could	O
represent	O
better	O
treatment	O
options	O
.	O
Figure	O
4	O
Conserved	O
presence	O
of	O
bacA	B-GP
antiobiotic	O
resistance	O
gene	O
in	O
P	B-OG
.	I-OG
difficile	I-OG
outbreak	O
.	O
Gingr	O
visualization	O
of	O
conserved	O
bacitracin	O
resistance	O
gene	O
within	O
the	O
Parsnp	O
alignment	O
of	O
826	O
P	B-OG
.	I-OG
difficile	I-OG
genomes	O
.	O

Vertical	O
lines	O
indicate	O
SNPs	O
,	O
providing	O
visual	O
support	O
of	O
subclades	O
within	O
this	O
outbreak	O
dataset	O
.	O

Mycobacterium	B-OG
tuberculosis	I-OG
geographic	O
spread	O

For	O
a	O
second	O
case	O
evaluation	O
,	O
we	O
ran	O
Parsnp	O
on	O
a	O
M	B-OG
.	I-OG
tuberculosis	I-OG
global	O
diversity	O
dataset	O
[	O
98	O
].	O

In	O
this	O
case	O
,	O
the	O
raw	O
SNP	O
calls	O
were	O
kindly	O
made	O
available	O
(	O
Iñaki	O
Comas	O
,	O
personal	O
communication	O
),	O
facilitating	O
a	O
direct	O
comparison	O
to	O
the	O
published	O
results	O
.	O

The	O
variant	O
pipeline	O
of	O
Comas	O
et	O
al	O
.	O
is	O
similar	O
to	O
our	O
BWA	O
pipeline	O
,	O
but	O
with	O
all	O
SNP	O
calls	O
intersected	O
with	O
MAQ	O
SNPfilter	O
,	O
which	O
discards	O
any	O
SNP	O
with	O
neighboring	O
Indels	O
±	O
3	O
bp	O
or	O
surrounded	O
by	O
>	O
3	O
SNPs	O
within	O
a	O
10	O
bp	O
window	O
.	O

To	O
replicate	O
this	O
study	O
using	O
whole	O
-	O
genome	O
alignment	O
,	O
we	O
assembled	O
all	O
genomes	O
from	O
the	O
raw	O
reads	O
using	O
iMetAMOS	O
and	O
ran	O
Parsnp	O
on	O
the	O
resulting	O
draft	O
assemblies	O
.	O

Figure	O
5	O
summarizes	O
the	O
results	O
of	O
the	O
comparison	O
and	O
Figure	O
6	O
shows	O
a	O
Gingr	O
visualization	O
of	O
the	O
resulting	O
tree	O
and	O
alignment	O
,	O
with	O
major	O
clades	O
confirmed	O
by	O
correlations	O
in	O
the	O
SNP	O
density	O
display	O
.	O
Figure	O
5	O
Comparison	O
of	O
Parsnp	O
and	O
Comas	O
et	O
al	O
.	O
result	O
on	O
M	B-OG
.	I-OG
tuberculosis	I-OG
dataset	O
.	O
A	O
Venn	O
diagram	O
displays	O
SNPs	O
unique	O
to	O
Comas	O
et	O
al	O
.	O
[	O
98	O
]	O
(	O
left	O
,	O
blue	O
),	O
unique	O
to	O
Parsnp	O
(	O
right	O
,	O
red	O
),	O
and	O
shared	O
between	O
the	O
two	O
analyses	O
(	O
middle	O
,	O
brown	O
).	O

On	O
top	O
,	O
an	O
unrooted	O
reference	O
phylogeny	O
is	O
given	O
based	O
on	O
the	O
intersection	O
of	O
shared	O
SNPs	O
produced	O
by	O
both	O
methods	O
(	O
90	O
,	O
295	O
SNPs	O
).	O

On	O
bottom	O
,	O
the	O
phylogenies	O
of	O
Comas	O
et	O
al	O
.	O
(	O
left	O
)	O
and	O
Parsnp	O
(	O
right	O
)	O
are	O
given	O
.	O

Pairs	O
of	O
trees	O
are	O
annotated	O
with	O
their	O
Robinson	O
-	O
Foulds	O
distance	O
(	O
RFD	O
)	O
and	O
percentage	O
of	O
shared	O
splits	O
.	O

The	O
Comas	O
et	O
al	O
.	O
and	O
Parsnp	O
trees	O
are	O
largely	O
concordant	O
with	O
each	O
other	O
and	O
the	O
reference	O
phylogeny	O
.	O

All	O
major	O
clades	O
are	O
shared	O
and	O
well	O
supported	O
by	O
all	O
three	O
trees	O
.	O
Figure	O
6	O
Gingr	O
visualization	O
of	O
171	O
M	B-OG
.	I-OG
tuberculosis	I-OG
genomes	O
aligned	O
with	O
Parsnp	O
.	O
The	O
visual	O
layout	O
is	O
the	O
same	O
as	O
Figure	O
3	O
,	O
but	O
unlike	O
Figure	O
3	O
,	O
a	O
SNP	O
density	O
plot	O
across	O
the	O
entire	O
genome	O
is	O
displayed	O
.	O

Major	O
clades	O
are	O
visible	O
as	O
correlated	O
SNP	O
densities	O
across	O
the	O
length	O
of	O
the	O
genome	O
.	O

Given	O
a	O
lack	O
of	O
truth	O
for	O
this	O
dataset	O
,	O
we	O
constructed	O
a	O
reference	O
phylogeny	O
based	O
on	O
the	O
intersection	O
of	O
the	O
Parsnp	O
and	O
Comas	O
et	O
al	O
.	O
SNP	O
sets	O
,	O
which	O
excludes	O
potential	O
false	O
positives	O
produced	O
by	O
only	O
one	O
of	O
the	O
methods	O
.	O

We	O
evaluated	O
the	O
accuracy	O
of	O
phylogenetic	O
reconstruction	O
by	O
measuring	O
the	O
Robinson	O
-	O
Foulds	O
distance	O
[	O
99	O
]	O
and	O
calculating	O
the	O
number	O
of	O
shared	O
splits	O
between	O
the	O
resulting	O
trees	O
(	O
Figure	O
5	O
).	O

The	O
Parsnp	O
generated	O
phylogeny	O
has	O
a	O
higher	O
percentage	O
of	O
shared	O
splits	O
with	O
the	O
reference	O
phylogeny	O
(	O
94	O
.	O
1	O
%	O
versus	O
92	O
.	O
3	O
%	O
for	O
Comas	O
),	O
while	O
both	O
methods	O
exhibited	O
a	O
similar	O
Robinson	O
-	O
Foulds	O
distance	O
to	O
the	O
reference	O
phylogeny	O
(	O
0	O
.	O
0007	O
).	O

When	O
compared	O
directly	O
,	O
Parsnp	O
was	O
found	O
to	O
share	O
90	O
,	O
295	O
of	O
its	O
104	O
,	O
896	O
SNPs	O
calls	O
(	O
86	O
%)	O
and	O
19	O
,	O
838	O
of	O
its	O
22	O
,	O
131	O
SNP	O
positions	O
(	O
90	O
%)	O
with	O
the	O
Comas	O
et	O
al	O
.	O
study	O
,	O
resulting	O
in	O
90	O
.	O
5	O
%	O
shared	O
splits	O
between	O
the	O
reconstructed	O
phylogenies	O
.	O

We	O
further	O
investigated	O
the	O
SNP	O
calls	O
unique	O
to	O
either	O
Parsnp	O
or	O
Comas	O
and	O
found	O
that	O
the	O
majority	O
formed	O
a	O
few	O
well	O
-	O
defined	O
splits	O
that	O
were	O
largely	O
consistent	O
with	O
the	O
reference	O
phylogeny	O
(	O
Additional	O
file	O
1	O
:	O
Table	O
S1	O
).	O

These	O
SNPs	O
are	O
likely	O
true	O
positives	O
that	O
were	O
missed	O
by	O
one	O
of	O
the	O
two	O
methods	O
.	O

A	O
smaller	O
fraction	O
of	O
unique	O
SNPs	O
formed	O
single	O
-	O
genome	O
splits	O
,	O
representing	O
potential	O
false	O
positives	O
due	O
to	O
sequencing	O
or	O
mapping	O
error	O
(	O
1	O
,	O
503	O
for	O
Parsnp	O
,	O
3	O
,	O
016	O
for	O
Comas	O
).	O

Runtime	O
and	O
storage	O
analysis	O

To	O
evaluate	O
Parsnp	O
’	O
s	O
scalability	O
,	O
we	O
profiled	O
performance	O
across	O
six	O
datasets	O
ranging	O
from	O
32	O
genomes	O
to	O
10	O
,	O
000	O
genomes	O
.	O

Runtime	O
was	O
observed	O
to	O
increase	O
linearly	O
with	O
additional	O
genomes	O
(	O
Additional	O
file	O
1	O
:	O
Figure	O
S2	O
),	O
requiring	O
a	O
few	O
minutes	O
for	O
the	O
32	O
genome	O
E	B-OG
.	I-OG
coli	I-OG
dataset	O
,	O
1	O
.	O
5	O
h	O
for	O
the	O
826	O
genome	O
P	B-OG
.	I-OG
difficile	I-OG
dataset	O
,	O
and	O
a	O
maximum	O
of	O
roughly	O
14	O
h	O
to	O
align	O
the	O
10	O
,	O
000	O
genome	O
set	O
on	O
a	O
2	O
.	O
2	O
GHz	O
,	O
32	O
-	O
core	O
,	O
1	O
TB	O
RAM	O
server	O
(	O
Table	O
4	O
).	O

In	O
addition	O
,	O
for	O
the	O
32	O
-	O
genome	O
simulated	O
E	B-OG
.	I-OG
coli	I-OG
datasets	O
,	O
Parsnp	O
was	O
10	O
to	O
100	O
times	O
faster	O
than	O
all	O
other	O
methods	O
evaluated	O
.	O

Maximum	O
memory	O
usage	O
was	O
2	O
GB	O
for	O
the	O
145	O
Mbp	O
E	B-OG
.	I-OG
coli	I-OG
dataset	O
and	O
309	O
GB	O
for	O
the	O
21	O
Gbp	O
S	B-OG
.	I-OG
pneumoniae	I-OG
dataset	O
(	O
Table	O
4	O
).	O

Memory	O
usage	O
can	O
be	O
explicitly	O
limited	O
via	O
a	O
command	O
-	O
line	O
parameter	O
(−−	O
max	O
-	O
partition	O
-	O
size	O
)	O
but	O
this	O
results	O
in	O
increased	O
runtime	O
.	O
Table	O
4	O
Performance	O
profile	O
of	O
Parsnp	O
runtime	O
(	O
MUM	O
+	O
alignment	O
)	O
on	O
all	O
evaluated	O
datasets	O
Dataset	O
Num	O
Genomes	O
a	O
Aligned	O
b	O
(	O
Mbp	O
)	O
MUM	O
c	O
(	O
min	O
)	O
MUSCLE	O
d	O
(	O
min	O
)	O
Total	O
e	O
(	O
min	O
)	O
Mem	O
f	O
(	O
GB	O
)	O
E	B-OG
.	I-OG
coli	I-OG
(	O
avg	O
)	O
321422242	O
M	B-OG
.	I-OG
tuberculosis	I-OG
17142412203214	O
P	B-OG
.	I-OG
difficile	I-OG
8261	O
,	O
39246398571	O
S	O
.	O
aureus	O
SIM	O
10	O
,	O
00021	O
,	O
000668201869309Results	O
were	O
generated	O
on	O
a	O
32	O
-	O
core	O
,	O
2	O
.	O
2	O
GHz	O
,	O
1	O
TB	O
RAM	O
Linux	O
server	O
.	O
Dataset	O
:	O
the	O
genome	O
set	O
.	O
aThe	O
number	O
of	O
genomes	O
aligned	O
.	O
bTotal	O
Mbp	O
aligned	O
.	O
cThe	O
time	O
spent	O
finding	O
maximal	O
unique	O
matches	O
.	O
dThe	O
time	O
spent	O
performing	O
gapped	O
multi	O
-	O
alignment	O
with	O
MUSCLE	O
.	O
eTotal	O
Parsnp	O
runtime	O
(	O
sum	O
of	O
MUM	O
and	O
MUSCLE	O
).	O
fMaximum	O
memory	O
usage	O
.	O

In	O
addition	O
to	O
runtime	O
efficiency	O
,	O
Parsnp	O
requires	O
much	O
less	O
storage	O
than	O
the	O
other	O
approaches	O
due	O
to	O
its	O
binary	O
alignment	O
format	O
and	O
the	O
compressive	O
effect	O
of	O
assembly	O
.	O

For	O
the	O
32	O
-	O
genome	O
E	B-OG
.	I-OG
coli	I-OG
dataset	O
,	O
Parsnp	O
’	O
s	O
output	O
totals	O
just	O
4	O
.	O
5	O
MB	O
,	O
compared	O
to	O
13	O
GB	O
required	O
to	O
store	O
compressed	O
FASTQ	O
[	O
100	O
]	O
and	O
VCF	O
[	O
101	O
]	O
files	O
and	O
149	O
MB	O
to	O
store	O
XMFA	O
[	O
38	O
].	O

Storage	O
reductions	O
are	O
amplified	O
for	O
larger	O
datasets	O
.	O

For	O
example	O
,	O
the	O
raw	O
read	O
data	O
for	O
the	O
P	B-OG
.	I-OG
difficile	I-OG
dataset	O
requires	O
1	O
.	O
4	O
TB	O
of	O
storage	O
(	O
0	O
.	O
6	O
TB	O
compressed	O
).	O

Assembling	O
these	O
data	O
reduces	O
the	O
total	O
to	O
3	O
.	O
3	O
GB	O
by	O
removing	O
the	O
redundancy	O
of	O
the	O
reads	O
.	O

The	O
XMFA	O
alignment	O
of	O
these	O
assemblies	O
is	O
1	O
.	O
4	O
GB	O
,	O
and	O
reference	O
-	O
compressed	O
binary	O
format	O
occupies	O
just	O
15	O
MB	O
.	O

This	O
equates	O
to	O
roughly	O
a	O
100	O
,	O
000X	O
(	O
lossy	O
)	O
compression	O
factor	O
from	O
raw	O
reads	O
to	O
compressed	O
archive	O
,	O
requiring	O
only	O
0	O
.	O
08	O
bits	O
per	O
base	O
to	O
store	O
the	O
full	O
core	O
-	O
genome	O
alignment	O
plus	O
other	O
related	O
information	O
,	O
which	O
is	O
competitive	O
with	O
related	O
techniques	O
like	O
CRAM	O
[	O
102	O
].	O

As	O
outbreak	O
studies	O
continue	O
to	O
expand	O
in	O
scale	O
,	O
whole	O
-	O
genome	O
assembly	O
and	O
alignment	O
presents	O
a	O
sustainable	O
alternative	O
to	O
the	O
current	O
mapping	O
-	O
based	O
strategies	O
.	O

Discussion	O

Parsnp	O
is	O
orders	O
of	O
magnitude	O
faster	O
than	O
current	O
methods	O
for	O
whole	O
-	O
genome	O
alignment	O
and	O
SNP	O
typing	O
,	O
but	O
it	O
is	O
not	O
without	O
limitations	O
.	O

Parsnp	O
represents	O
a	O
compromise	O
between	O
whole	O
-	O
genome	O
alignment	O
and	O
read	O
mapping	O
.	O

Compared	O
to	O
whole	O
-	O
genome	O
aligners	O
,	O
Parsnp	O
is	O
less	O
flexible	O
because	O
it	O
is	O
designed	O
to	O
conservatively	O
align	O
the	O
core	O
genome	O
and	O
is	O
less	O
sensitive	O
as	O
a	O
result	O
.	O

Additionally	O
,	O
Parsnp	O
is	O
currently	O
limited	O
to	O
intraspecific	O
analysis	O
of	O
closely	O
-	O
related	O
species	O
and	O
strains	O
;	O
future	O
improvements	O
will	O
target	O
more	O
sensitive	O
match	O
detection	O
for	O
increased	O
tolerance	O
of	O
divergent	O
genomes	O
.	O

Compared	O
to	O
read	O
mapping	O
,	O
Parsnp	O
is	O
less	O
robust	O
and	O
requires	O
high	O
-	O
quality	O
assemblies	O
to	O
maximize	O
sensitivity	O
.	O

Thus	O
,	O
the	O
right	O
tool	O
depends	O
on	O
the	O
data	O
and	O
task	O
at	O
hand	O
.	O

Core	O
-	O
genome	O
alignment	O
and	O
phylogeny	O
reconstruction	O
are	O
critical	O
to	O
microbial	O
forensics	O
and	O
modern	O
epidemiology	O
.	O

When	O
finished	O
or	O
high	O
-	O
quality	O
genomes	O
are	O
available	O
,	O
Parsnp	O
is	O
both	O
efficient	O
and	O
accurate	O
for	O
these	O
tasks	O
.	O

In	O
addition	O
,	O
even	O
for	O
fragmented	O
draft	O
assemblies	O
,	O
Parsnp	O
exhibits	O
a	O
favorable	O
compromise	O
between	O
sensitivity	O
and	O
specificity	O
.	O

Surprisingly	O
,	O
Parsnp	O
matched	O
the	O
specificity	O
of	O
the	O
mapping	O
-	O
based	O
approaches	O
on	O
the	O
simulated	O
datasets	O
.	O

However	O
,	O
multiplexed	O
short	O
-	O
read	O
sequencing	O
followed	O
by	O
mapping	O
still	O
remains	O
the	O
most	O
economical	O
approach	O
for	O
sensitive	O
analysis	O
of	O
large	O
strain	O
collections	O
.	O

Furthermore	O
,	O
whole	O
-	O
genome	O
alignment	O
depends	O
on	O
genome	O
assemblies	O
for	O
variant	O
detection	O
;	O
the	O
accuracy	O
of	O
these	O
methods	O
for	O
SNP	O
calling	O
is	O
directly	O
proportional	O
to	O
the	O
quality	O
of	O
the	O
assembly	O
.	O

Thus	O
,	O
Parsnp	O
is	O
recommended	O
for	O
analyzing	O
high	O
-	O
quality	O
assemblies	O
or	O
when	O
raw	O
read	O
data	O
are	O
not	O
available	O
.	O

Assembled	O
genomes	O
have	O
a	O
number	O
of	O
advantages	O
over	O
read	O
data	O
-	O
primarily	O
compression	O
and	O
convenience	O
.	O

Storing	O
,	O
sharing	O
,	O
and	O
analyzing	O
raw	O
read	O
datasets	O
incurs	O
significant	O
overhead	O
from	O
the	O
redundancy	O
in	O
sequencing	O
(	O
often	O
100	O
-	O
fold	O
),	O
and	O
this	O
burden	O
nearly	O
resulted	O
in	O
the	O
closure	O
of	O
the	O
NCBI	O
SRA	O
database	O
[	O
103	O
].	O

Adding	O
additional	O
orders	O
of	O
magnitude	O
to	O
the	O
already	O
exponential	O
growth	O
of	O
sequencing	O
data	O
is	O
not	O
sustainable	O
.	O

Instead	O
,	O
information	O
in	O
the	O
reads	O
not	O
currently	O
stored	O
in	O
common	O
assembly	O
formats	O
(	O
for	O
example	O
,	O
allelic	O
variants	O
)	O
should	O
be	O
propagated	O
to	O
the	O
assembled	O
representation	O
,	O
forming	O
a	O
compressed	O
,	O
but	O
nearly	O
lossless	O
format	O
.	O

In	O
this	O
way	O
,	O
genomes	O
could	O
be	O
shared	O
in	O
their	O
native	O
,	O
assembled	O
format	O
,	O
saving	O
both	O
space	O
and	O
time	O
of	O
analysis	O
.	O

Here	O
,	O
we	O
have	O
taken	O
a	O
small	O
step	O
in	O
that	O
direction	O
by	O
identifying	O
low	O
quality	O
bases	O
,	O
as	O
computed	O
by	O
FreeBayes	O
[	O
54	O
].	O

This	O
allows	O
filtering	O
of	O
low	O
quality	O
and	O
mixed	O
alleles	O
and	O
improves	O
the	O
specificity	O
of	O
the	O
assembly	O
-	O
based	O
approaches	O
.	O

However	O
,	O
more	O
comprehensive	O
,	O
graph	O
-	O
based	O
formats	O
are	O
needed	O
to	O
capture	O
the	O
full	O
population	O
information	O
contained	O
in	O
the	O
raw	O
reads	O
.	O

Parsnp	O
was	O
also	O
built	O
around	O
the	O
observation	O
that	O
high	O
-	O
quality	O
,	O
finished	O
genome	O
sequences	O
have	O
become	O
more	O
common	O
as	O
sequencing	O
technology	O
and	O
assembly	O
algorithms	O
continue	O
to	O
improve	O
.	O

New	O
technologies	O
,	O
such	O
as	O
PacBio	O
SMRT	O
sequencing	O
[	O
104	O
]	O
are	O
enabling	O
the	O
generation	O
of	O
reference	O
-	O
grade	O
sequences	O
at	O
extremely	O
reduced	O
costs	O
.	O

This	O
presents	O
another	O
opportunity	O
for	O
Parsnp	O
-	O
the	O
construction	O
and	O
maintenance	O
of	O
core	O
genomes	O
and	O
trees	O
for	O
clinically	O
important	O
species	O
.	O

With	O
well	O
-	O
defined	O
reference	O
cores	O
,	O
outbreaks	O
could	O
be	O
accurately	O
typed	O
in	O
real	O
-	O
time	O
by	O
mapping	O
sequences	O
directly	O
to	O
the	O
tree	O
using	O
phylogenetically	O
aware	O
methods	O
such	O
as	O
pplacer	O
[	O
105	O
]	O
or	O
PAGAN	O
[	O
106	O
].	O

Such	O
a	O
phylogenetic	O
approach	O
would	O
be	O
preferable	O
to	O
alternative	O
typing	O
schemes	O
based	O
on	O
loosely	O
defined	O
notions	O
of	O
similarity	O
,	O
such	O
as	O
pulse	O
-	O
field	O
electrophoresis	O
(	O
PFGE	O
)	O
[	O
107	O
]	O
and	O
multi	O
-	O
locus	O
sequence	O
typing	O
(	O
MLST	O
)	O
[	O
108	O
].	O

Conclusion	O

Parsnp	O
offers	O
a	O
highly	O
efficient	O
method	O
for	O
aligning	O
the	O
core	O
genome	O
of	O
thousands	O
of	O
closely	O
related	O
species	O
,	O
and	O
Gingr	O
provides	O
a	O
flexible	O
,	O
interactive	O
visualization	O
tool	O
for	O
the	O
exploration	O
of	O
huge	O
trees	O
and	O
alignments	O
.	O

Together	O
,	O
they	O
enable	O
analyses	O
not	O
previously	O
possible	O
with	O
whole	O
-	O
genome	O
aligners	O
.	O

We	O
have	O
demonstrated	O
that	O
Parsnp	O
provides	O
highly	O
specific	O
variant	O
calls	O
,	O
even	O
for	O
highly	O
fragmented	O
draft	O
genomes	O
,	O
and	O
can	O
efficiently	O
reconstruct	O
recent	O
outbreak	O
analyses	O
including	O
hundreds	O
of	O
whole	O
genomes	O
.	O

Future	O
improvements	O
in	O
genome	O
assembly	O
quality	O
and	O
formats	O
will	O
enable	O
comprehensive	O
cataloging	O
of	O
microbial	O
population	O
variation	O
,	O
including	O
both	O
point	O
and	O
structural	O
mutations	O
,	O
using	O
genome	O
alignment	O
methods	O
such	O
as	O
Parsnp	O
.	O

Materials	O
and	O
methods	O

Software	O
and	O
configurations	O

Mugsy	O
[	O
36	O
]	O
v1	O
.	O
23	O
and	O
Mauve	O
Aligner	O
[	O
31	O
,	O
33	O
]	O
v2	O
.	O
3	O
.	O
1	O
were	O
run	O
using	O
default	O
parameters	O
on	O
assembled	O
sequences	O
.	O

mauveAligner	O
was	O
selected	O
instead	O
of	O
progressiveMauve	O
due	O
to	O
improved	O
performance	O
on	O
the	O
simulated	O
E	B-OG
.	I-OG
coli	I-OG
datasets	O
,	O
which	O
do	O
not	O
contain	O
subset	O
relationships	O
.	O

kSNP	O
v2	O
.	O
0	O
[	O
66	O
]	O
was	O
run	O
with	O
a	O
k	O
-	O
mer	O
size	O
of	O
25	O
on	O
both	O
the	O
raw	O
read	O
data	O
and	O
the	O
assemblies	O
;	O
the	O
assemblies	O
were	O
merged	O
with	O
Ns	O
using	O
the	O
provided	O
merge_fasta_contigs	O
.	O
pl	O
utility	O
.	O

Raw	O
MAF	O
/	O
XMFA	O
/	O
VCF	O
output	O
was	O
parsed	O
to	O
recover	O
SNPs	O
and	O
build	O
MultiFASTA	O
files	O
.	O

Smalt	O
version	O
0	O
.	O
7	O
.	O
5	O
was	O
run	O
with	O
default	O
parameters	O
for	O
paired	O
reads	O
,	O
mirroring	O
the	O
pipeline	O
used	O
in	O
several	O
recent	O
SNP	O
typing	O
studies	O
[	O
90	O
,	O
109	O
–	O
111	O
].	O

Samtools	O
view	O
was	O
used	O
to	O
filter	O
for	O
alignments	O
with	O
mapping	O
qualities	O
greater	O
than	O
or	O
equal	O
to	O
30	O
.	O

Variants	O
were	O
called	O
by	O
piping	O
samtools	O
mpileup	O
output	O
into	O
bcftools	O
view	O
with	O
the	O
-	O
v	O
(	O
variants	O
only	O
),	O
-	O
g	O
(	O
genotype	O
)	O
and	O
-	O
I	O
(	O
skip	O
Indels	O
)	O
flags	O
.	O

Variants	O
were	O
then	O
filtered	O
with	O
VCFUtils	O
varFilter	O
with	O
the	O
-	O
d	O
(	O
minimum	O
read	O
depth	O
)	O
parameter	O
set	O
to	O
3	O
.	O

Variants	O
for	O
all	O
samples	O
of	O
each	O
set	O
were	O
called	O
concomitantly	O
by	O
providing	O
samtools	O
mpileup	O
with	O
all	O
BAM	O
files	O
.	O

BWA	O
[	O
52	O
]	O
was	O
run	O
in	O
its	O
standard	O
paired	O
-	O
end	O
alignment	O
mode	O
with	O
default	O
parameters	O
,	O
using	O
aln	O
to	O
align	O
each	O
set	O
of	O
ends	O
and	O
sampe	O
to	O
produce	O
a	O
combined	O
SAM	O
file	O
.	O

Samtools	O
view	O
was	O
used	O
to	O
filter	O
for	O
alignments	O
with	O
mapping	O
qualities	O
greater	O
than	O
or	O
equal	O
to	O
30	O
.	O

Variants	O
were	O
called	O
by	O
piping	O
samtools	O
mpileup	O
output	O
into	O
bcftools	O
view	O
with	O
the	O
-	O
v	O
(	O
variants	O
only	O
),	O
-	O
g	O
(	O
genotype	O
)	O
and	O
-	O
I	O
(	O
skip	O
Indels	O
)	O
flags	O
.	O

Variants	O
were	O
then	O
filtered	O
with	O
VCFUtils	O
varFilter	O
with	O
the	O
-	O
d	O
(	O
minimum	O
read	O
depth	O
)	O
parameter	O
set	O
to	O
3	O
.	O

As	O
with	O
Smalt	O
,	O
variants	O
for	O
all	O
samples	O
of	O
each	O
set	O
were	O
called	O
concomitantly	O
by	O
providing	O
samtools	O
mpileup	O
with	O
all	O
BAM	O
files	O
.	O

FastTree	O
v2	O
[	O
88	O
]	O
was	O
used	O
to	O
reconstruct	O
phylogenies	O
using	O
default	O
parameters	O
.	O

E	B-OG
.	I-OG
coli	I-OG
K	I-OG
-	I-OG
12	I-OG
W3110	I-OG
simulated	O
dataset	O

The	O
complete	O
genome	O
of	O
E	B-OG
.	I-OG
coli	I-OG
K	I-OG
-	I-OG
12	I-OG
W3110	I-OG
[	O
112	O
],	O
was	O
downloaded	O
from	O
RefSeq	O
(	O
AC_000091	O
).	O

This	O
genome	O
was	O
used	O
as	O
the	O
ancestral	O
genome	O
and	O
evolution	O
was	O
simulated	O
along	O
a	O
balanced	O
tree	O
for	O
three	O
evolutionary	O
rates	O
using	O
the	O
Seq	O
-	O
Gen	O
package	O
[	O
113	O
]	O
with	O
parameters	O
mHKY	O
-	O
t4	O
.	O
0	O
-	O
l4646332	O
-	O
n1	O
-	O
k1	O
and	O
providing	O
the	O
corresponding	O
binary	O
tree	O
evolved	O
at	O
three	O
evolutionary	O
rates	O
:	O
0	O
.	O
00001	O
,	O
0	O
.	O
0001	O
,	O
and	O
0	O
.	O
001	O
SNPs	O
per	O
site	O
,	O
per	O
branch	O
.	O

This	O
corresponds	O
to	O
a	O
minimum	O
percent	O
identity	O
of	O
approximately	O
99	O
%,	O
99	O
.	O
9	O
%,	O
and	O
99	O
.	O
99	O
%	O
between	O
the	O
two	O
most	O
divergent	O
genomes	O
,	O
respectively	O
,	O
reflecting	O
the	O
variation	O
seen	O
in	O
typical	O
outbreak	O
analyses	O
.	O

No	O
small	O
(<	O
5	O
bp	O
)	O
or	O
large	O
Indels	O
were	O
introduced	O
,	O
but	O
an	O
average	O
of	O
10	O
1	O
Kbp	O
rearrangements	O
(	O
inversions	O
and	O
translocations	O
)	O
were	O
added	O
,	O
per	O
genome	O
,	O
using	O
a	O
custom	O
script	O
[	O
114	O
].	O

Paired	O
reads	O
were	O
simulated	O
to	O
model	O
current	O
MiSeq	O
lengths	O
(	O
2	O
×	O
150	O
bp	O
)	O
and	O
error	O
rates	O
(	O
1	O
%).	O

Moderate	O
coverage	O
,	O
two	O
million	O
PE	O
reads	O
(	O
64X	O
coverage	O
),	O
was	O
simulated	O
for	O
each	O
of	O
the	O
32	O
samples	O
using	O
wgsim	O
(	O
default	O
parameters	O
,	O
no	O
Indels	O
),	O
from	O
samtools	O
package	O
version	O
0	O
.	O
1	O
.	O
17	O
[	O
55	O
].	O

Two	O
of	O
the	O
simulated	O
read	O
sets	O
were	O
independently	O
run	O
through	O
iMetAMOS	O
[	O
93	O
]	O
to	O
automatically	O
determine	O
the	O
best	O
assembler	O
.	O

The	O
consensus	O
pick	O
across	O
both	O
datasets	O
was	O
SPAdes	O
version	O
3	O
.	O
0	O
[	O
81	O
],	O
which	O
was	O
subsequently	O
run	O
on	O
the	O
remaining	O
30	O
simulated	O
read	O
sets	O
using	O
default	O
parameters	O
.	O

The	O
final	O
contigs	O
and	O
scaffolds	O
files	O
were	O
used	O
as	O
input	O
to	O
the	O
genome	O
alignment	O
methods	O
.	O

For	O
mapping	O
methods	O
,	O
the	O
raw	O
simulated	O
reads	O
were	O
used	O
.	O

For	O
accuracy	O
comparisons	O
,	O
Indels	O
were	O
ignored	O
and	O
called	O
SNPs	O
were	O
required	O
to	O
be	O
unambiguously	O
aligned	O
across	O
all	O
32	O
genomes	O
(	O
that	O
is	O
,	O
not	O
part	O
of	O
a	O
subset	O
relationship	O
;	O
SNPs	O
present	O
but	O
part	O
of	O
a	O
subset	O
relationship	O
were	O
ignored	O
).	O

S	B-OG
.	I-OG
pneumoniae	I-OG
dataset	O

A	O
full	O
listing	O
of	O
accession	O
numbers	O
for	O
the	O
31	O
-	O
genome	O
S	B-OG
.	I-OG
pneumoniae	I-OG
dataset	O
is	O
described	O
in	O
[	O
36	O
].	O

For	O
scalability	O
testing	O
,	O
Streptococcus	B-OG
pneumoniae	I-OG
TIGR4	I-OG
(	O
NC_003028	O
.	O
3	O
)	O
was	O
used	O
to	O
create	O
a	O
pseudo	O
-	O
outbreak	O
clade	O
involving	O
10	O
,	O
000	O
genomes	O
evolved	O
along	O
a	O
star	O
phylogeny	O
with	O
on	O
average	O
10	O
SNPs	O
per	O
genome	O
.	O

M	B-OG
.	I-OG
tuberculosis	I-OG
dataset	O

We	O
downloaded	O
and	O
assembled	O
sequencing	O
data	O
from	O
a	O
recently	O
published	O
study	O
of	O
M	B-OG
.	I-OG
tuberculosis	I-OG
[	O
98	O
].	O

A	O
total	O
of	O
225	O
runs	O
corresponding	O
to	O
project	O
ERP001731	O
were	O
downloaded	O
from	O
NCBI	O
SRA	O
and	O
assembled	O
using	O
the	O
iMetAMOS	O
ensemble	O
of	O
SPAdes	O
,	O
MaSuRCA	O
,	O
and	O
Velvet	O
.	O

The	O
iMetAMOS	O
assembly	O
for	O
each	O
sample	O
can	O
be	O
replicated	O
with	O
the	O
following	O
commands	O
,	O
which	O
will	O
automatically	O
download	O
the	O
data	O
for	O
RUN_ID	O
directly	O
from	O
SRA	O
:>	O
initPipeline	O
-	O
d	O
asmTB	O
-	O
W	O
iMetAMOS	O
-	O
m	O
RUN_ID	O
-	O
i	O
200	O
:	O
800	O
>	O
runPipeline	O
-	O
d	O
asmTB	O
-	O
a	O
spades	O
,	O
masurca	O
,	O
velvet	O
-	O
p	O
16	O

The	O
M	B-OG
.	I-OG
tuberculosis	I-OG
dataset	O
included	O
a	O
mix	O
of	O
single	O
and	O
paired	O
-	O
end	O
runs	O
with	O
a	O
sequence	O
length	O
in	O
the	O
range	O
of	O
51	O
to	O
108	O
bp	O
.	O

The	O
average	O
k	O
-	O
mer	O
size	O
selected	O
for	O
unpaired	O
data	O
was	O
26	O
,	O
resulting	O
in	O
an	O
average	O
of	O
660	O
contigs	O
and	O
an	O
N50	O
size	O
of	O
17	O
Kbp	O
.	O

For	O
paired	O
-	O
end	O
data	O
,	O
the	O
average	O
selected	O
k	O
-	O
mer	O
was	O
35	O
,	O
resulting	O
in	O
an	O
average	O
of	O
333	O
contigs	O
and	O
an	O
N50	O
size	O
of	O
43	O
Kbp	O
.	O

Assemblies	O
containing	O
more	O
than	O
2	O
,	O
000	O
contigs	O
,	O
or	O
1	O
.	O
5X	O
larger	O
/	O
smaller	O
than	O
the	O
reference	O
genome	O
,	O
were	O
removed	O
.	O

The	O
final	O
dataset	O
was	O
reduced	O
to	O
171	O
genomes	O
,	O
limited	O
to	O
labeled	O
strains	O
that	O
could	O
be	O
confidently	O
matched	O
to	O
the	O
strains	O
used	O
in	O
the	O
Comas	O
et	O
al	O
.	O
study	O
for	O
SNP	O
and	O
phylogenetic	O
comparison	O
.	O

P	B-OG
.	I-OG
difficile	I-OG
dataset	O

Note	O
,	O
Clostridium	B-OG
difficile	I-OG
was	O
recently	O
renamed	O
to	O
Peptoclostridium	B-OG
difficile	I-OG
[	O
115	O
].	O

We	O
downloaded	O
and	O
assembled	O
sequencing	O
data	O
from	O
a	O
recently	O
published	O
study	O
of	O
P	B-OG
.	I-OG
difficile	I-OG
[	O
92	O
].	O

A	O
total	O
of	O
825	O
runs	O
corresponding	O
to	O
project	O
ERP003850	O
were	O
downloaded	O
from	O
NCBI	O
SRA	O
[	O
86	O
]	O
and	O
assembled	O
within	O
iMetAMOS	O
this	O
time	O
only	O
using	O
SPAdes	O
,	O
which	O
was	O
identified	O
as	O
the	O
best	O
performer	O
on	O
the	O
M	B-OG
.	I-OG
tuberculosis	I-OG
dataset	O
.	O

The	O
iMetAMOS	O
assembly	O
for	O
each	O
sample	O
can	O
be	O
replicated	O
with	O
the	O
following	O
commands	O
,	O
which	O
will	O
download	O
the	O
data	O
for	O
RUN_ID	O
directly	O
from	O
SRA	O
:>	O
initPipeline	O
-	O
d	O
asmPD	O
-	O
W	O
iMetAMOS	O
-	O
m	O
RUN_ID	O
-	O
i	O
200	O
:	O
800	O
>	O
runPipeline	O
-	O
d	O
asmPD	O
-	O
a	O
spades	O
-	O
p	O
16	O

The	O
P	B-OG
.	I-OG
difficile	I-OG
dataset	O
included	O
paired	O
-	O
end	O
runs	O
with	O
a	O
sequence	O
length	O
in	O
the	O
range	O
of	O
51	O
to	O
100	O
bp	O
.	O

SPAdes	O
was	O
selected	O
as	O
the	O
assembler	O
and	O
run	O
with	O
k	O
-	O
mer	O
sizes	O
of	O
21	O
,	O
33	O
,	O
55	O
,	O
and	O
77	O
.	O

The	O
assemblies	O
had	O
an	O
average	O
of	O
660	O
contigs	O
and	O
an	O
N50	O
size	O
of	O
138	O
Kbp	O
.	O

Assemblies	O
containing	O
more	O
than	O
2	O
,	O
000	O
contigs	O
,	O
or	O
1	O
.	O
5X	O
larger	O
/	O
smaller	O
than	O
the	O
reference	O
genome	O
,	O
were	O
removed	O
.	O

Data	O
and	O
software	O
availability	O

All	O
data	O
,	O
supplementary	O
files	O
,	O
assemblies	O
,	O
packaged	O
software	O
binaries	O
and	O
scripts	O
described	O
in	O
the	O
manuscript	O
are	O
available	O
from	O
:	O
https	O
://	O
www	O
.	O
cbcb	O
.	O
umd	O
.	O
edu	O
/	O
software	O
/	O
harvest	O
.	O

The	O
python	O
script	O
used	O
to	O
introduce	O
rearrangements	O
into	O
the	O
simulated	O
genomes	O
is	O
also	O
available	O
for	O
download	O
at	O
:	O
https	O
://	O
github	O
.	O
com	O
/	O
marbl	O
/	O
parsnp	O
/	O
tree	O
/	O
master	O
/	O
script	O
.	O

Source	O
code	O
of	O
the	O
described	O
software	O
,	O
including	O
Parsnp	O
and	O
Gingr	O
,	O
is	O
available	O
for	O
download	O
from	O
:	O
http	O
://	O
github	O
.	O
com	O
/	O
marbl	O
/	O
harvest	O
.	O

SNPs	O
unique	O
to	O
each	O
method	O
characterized	O
by	O
the	O
five	O
most	O
common	O
splits	O
found	O
.	O
Figure	O
S1	O
.	O
Runtime	O
comparison	O
for	O
the	O
whole	O
-	O
genome	O
alignment	O
methods	O
on	O
the	O
simulated	O
32	O
-	O
genome	O
E	B-OG
.	I-OG
coli	I-OG
W3110	O
dataset	O
.	O
Figure	O
S2	O
.	O
Timing	O
performance	O
from	O
32	O
to	O
10	O
,	O
000	O
S	B-OG
.	I-OG
pneumoniae	I-OG
genomes	O
.	O

Todd	O
J	O
Treangen	O
and	O
Brian	O
D	O
Ondov	O
contributed	O
equally	O
.	O

Competing	O
interests	O

The	O
authors	O
declare	O
that	O
they	O
have	O
no	O
competing	O
interests	O
.	O

Authors	O
’	O
contributions	O

TJT	O
,	O
BDO	O
,	O
and	O
AMP	O
conceived	O
the	O
method	O
,	O
designed	O
the	O
experiments	O
,	O
and	O
drafted	O
the	O
manuscript	O
.	O

TJT	O
implemented	O
Parsnp	O
and	O
BDO	O
implemented	O
Gingr	O
.	O

TJT	O
,	O
BDO	O
,	O
and	O
SK	O
performed	O
the	O
experiments	O
.	O

All	O
authors	O
read	O
and	O
approved	O
the	O
final	O
manuscript	O
.	O

